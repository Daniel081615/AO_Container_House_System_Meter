; generated by Component: ARM Compiler 5.05 update 1 (build 106) Tool: ArmCC [4d0efa]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o.\obj\main.o --asm_dir=.\lst\ --list_dir=.\lst\ --depend=.\obj\main.d --cpu=Cortex-M0 --apcs=interwork -O0 --diag_suppress=9931 -I..\..\..\Library\CMSIS\Include -I..\..\..\Library\Device\Nuvoton\NUC126\Include -I..\..\..\Library\StdDriver\inc -I..\..\..\NUC126_Series_BSP_CMSIS_V3.00.005\Library\StdDriver\inc -I..\..\..\NUC126_Series_BSP_CMSIS_V3.00.005\Library\Device\Nuvoton\NUC126\Include -I..\..\..\NUC126_Series_BSP_CMSIS_V3.00.005\Library\CMSIS\Include -IC:\Keil_v5\ARM\RV31\INC -IC:\Keil_v5\ARM\CMSIS\Include -D__MICROLIB -D__UVISION_VERSION=514 --omf_browse=.\obj\main.crf ..\main.c]
                          THUMB

                          AREA ||i.CLK_GetPLLClockFreq||, CODE, READONLY, ALIGN=2

                  CLK_GetPLLClockFreq PROC
;;;388      */
;;;389    __STATIC_INLINE uint32_t CLK_GetPLLClockFreq(void)
000000  b5fe              PUSH     {r1-r7,lr}
;;;390    {
;;;391        uint32_t u32PllFreq = 0, u32PllReg;
000002  2000              MOVS     r0,#0
000004  9002              STR      r0,[sp,#8]
;;;392        uint32_t u32FIN, u32NF, u32NR, u32NO;
;;;393        uint8_t au8NoTbl[4] = {1, 2, 2, 4};
000006  a01a              ADR      r0,|L1.112|
000008  6800              LDR      r0,[r0,#0]
00000a  9000              STR      r0,[sp,#0]
;;;394    
;;;395        u32PllReg = CLK->PLLCTL;
00000c  4819              LDR      r0,|L1.116|
00000e  6a04              LDR      r4,[r0,#0x20]
;;;396    
;;;397        if(u32PllReg & (CLK_PLLCTL_PD_Msk | CLK_PLLCTL_OE_Msk))
000010  1300              ASRS     r0,r0,#12
000012  4020              ANDS     r0,r0,r4
000014  2800              CMP      r0,#0
000016  d001              BEQ      |L1.28|
;;;398            return 0;           /* PLL is in power down mode or fix low */
000018  2000              MOVS     r0,#0
                  |L1.26|
;;;399    
;;;400        if(u32PllReg & CLK_PLLCTL_PLLSRC_HIRC)
;;;401            u32FIN = __HIRC;    /* PLL source clock from HIRC */
;;;402        else
;;;403            u32FIN = __HXT;     /* PLL source clock from HXT */
;;;404    
;;;405        if(u32PllReg & CLK_PLLCTL_BP_Msk)
;;;406            return u32FIN;      /* PLL is in bypass mode */
;;;407    
;;;408        /* PLL is output enabled in normal work mode */
;;;409        u32NO = au8NoTbl[((u32PllReg & CLK_PLLCTL_OUTDIV_Msk) >> CLK_PLLCTL_OUTDIV_Pos)];
;;;410        u32NF = ((u32PllReg & CLK_PLLCTL_FBDIV_Msk) >> CLK_PLLCTL_FBDIV_Pos) + 2;
;;;411        u32NR = ((u32PllReg & CLK_PLLCTL_INDIV_Msk) >> CLK_PLLCTL_INDIV_Pos) + 2;
;;;412    
;;;413        /* u32FIN is shifted 2 bits to avoid overflow */
;;;414        u32PllFreq = (((u32FIN >> 2) * u32NF) / (u32NR * u32NO) << 2);
;;;415    
;;;416        return u32PllFreq;
;;;417    }
00001a  bdfe              POP      {r1-r7,pc}
                  |L1.28|
00001c  2001              MOVS     r0,#1                 ;400
00001e  04c0              LSLS     r0,r0,#19             ;400
000020  4020              ANDS     r0,r0,r4              ;400
000022  2800              CMP      r0,#0                 ;400
000024  d001              BEQ      |L1.42|
000026  4d14              LDR      r5,|L1.120|
000028  e000              B        |L1.44|
                  |L1.42|
00002a  4d14              LDR      r5,|L1.124|
                  |L1.44|
00002c  2001              MOVS     r0,#1                 ;405
00002e  0440              LSLS     r0,r0,#17             ;405
000030  4020              ANDS     r0,r0,r4              ;405
000032  2800              CMP      r0,#0                 ;405
000034  d001              BEQ      |L1.58|
000036  4628              MOV      r0,r5                 ;406
000038  e7ef              B        |L1.26|
                  |L1.58|
00003a  2003              MOVS     r0,#3                 ;409
00003c  0380              LSLS     r0,r0,#14             ;409
00003e  4020              ANDS     r0,r0,r4              ;409
000040  0b80              LSRS     r0,r0,#14             ;409
000042  4669              MOV      r1,sp                 ;409
000044  5c0a              LDRB     r2,[r1,r0]            ;409
000046  9201              STR      r2,[sp,#4]            ;409
000048  05e0              LSLS     r0,r4,#23             ;410
00004a  0dc0              LSRS     r0,r0,#23             ;410
00004c  1c86              ADDS     r6,r0,#2              ;410
00004e  201f              MOVS     r0,#0x1f              ;411
000050  0240              LSLS     r0,r0,#9              ;411
000052  4020              ANDS     r0,r0,r4              ;411
000054  0a40              LSRS     r0,r0,#9              ;411
000056  1c87              ADDS     r7,r0,#2              ;411
000058  9a01              LDR      r2,[sp,#4]            ;414
00005a  437a              MULS     r2,r7,r2              ;414
00005c  4611              MOV      r1,r2                 ;414
00005e  08aa              LSRS     r2,r5,#2              ;414
000060  4372              MULS     r2,r6,r2              ;414
000062  4610              MOV      r0,r2                 ;414
000064  f7fffffe          BL       __aeabi_uidivmod
000068  0080              LSLS     r0,r0,#2              ;414
00006a  9002              STR      r0,[sp,#8]            ;414
00006c  9802              LDR      r0,[sp,#8]            ;416
00006e  e7d4              B        |L1.26|
;;;418    
                          ENDP

                  |L1.112|
000070  01020204          DCB      1,2,2,4
                  |L1.116|
                          DCD      0x50000200
                  |L1.120|
                          DCD      0x01518000
                  |L1.124|
                          DCD      0x00a8c000

                          AREA ||i.CalErrorRate||, CODE, READONLY, ALIGN=2

                  CalErrorRate PROC
;;;1351   float fErrorRate,tmpTx,tmpRx;
;;;1352   void CalErrorRate(void)
000000  b570              PUSH     {r4-r6,lr}
;;;1353   {
;;;1354       uint8_t i,j;
;;;1355           
;;;1356       MeterErrorRate_Tx[0] = 0 ;
000002  2000              MOVS     r0,#0
000004  4941              LDR      r1,|L2.268|
000006  8008              STRH     r0,[r1,#0]
;;;1357       MeterErrorRate_Rx[0] = 0 ;
000008  4941              LDR      r1,|L2.272|
00000a  8008              STRH     r0,[r1,#0]
;;;1358       for ( j=0;j<12;j++)
00000c  2500              MOVS     r5,#0
00000e  e011              B        |L2.52|
                  |L2.16|
;;;1359       {
;;;1360           MeterErrorRate_Tx[0] += MeterErrorRate5Min_Tx[0][j];
000010  483e              LDR      r0,|L2.268|
000012  8800              LDRH     r0,[r0,#0]  ; MeterErrorRate_Tx
000014  0069              LSLS     r1,r5,#1
000016  4a3f              LDR      r2,|L2.276|
000018  5a51              LDRH     r1,[r2,r1]
00001a  1840              ADDS     r0,r0,r1
00001c  493b              LDR      r1,|L2.268|
00001e  8008              STRH     r0,[r1,#0]
;;;1361           MeterErrorRate_Rx[0] += MeterErrorRate5Min_Rx[0][j];
000020  483b              LDR      r0,|L2.272|
000022  8800              LDRH     r0,[r0,#0]  ; MeterErrorRate_Rx
000024  0069              LSLS     r1,r5,#1
000026  4a3c              LDR      r2,|L2.280|
000028  5a51              LDRH     r1,[r2,r1]
00002a  1840              ADDS     r0,r0,r1
00002c  4938              LDR      r1,|L2.272|
00002e  8008              STRH     r0,[r1,#0]
000030  1c68              ADDS     r0,r5,#1              ;1358
000032  b2c5              UXTB     r5,r0                 ;1358
                  |L2.52|
000034  2d0c              CMP      r5,#0xc               ;1358
000036  dbeb              BLT      |L2.16|
;;;1362       }
;;;1363       tmpTx = (float) MeterErrorRate_Tx[0];
000038  4934              LDR      r1,|L2.268|
00003a  8808              LDRH     r0,[r1,#0]  ; MeterErrorRate_Tx
00003c  f7fffffe          BL       __aeabi_ui2f
000040  4936              LDR      r1,|L2.284|
000042  6008              STR      r0,[r1,#0]  ; tmpTx
;;;1364       tmpRx = (float) MeterErrorRate_Rx[0];
000044  4932              LDR      r1,|L2.272|
000046  8808              LDRH     r0,[r1,#0]  ; MeterErrorRate_Rx
000048  f7fffffe          BL       __aeabi_ui2f
00004c  4934              LDR      r1,|L2.288|
00004e  6008              STR      r0,[r1,#0]  ; tmpRx
;;;1365       fErrorRate = tmpRx/tmpTx;
000050  4832              LDR      r0,|L2.284|
000052  6801              LDR      r1,[r0,#0]  ; tmpTx
000054  4832              LDR      r0,|L2.288|
000056  6800              LDR      r0,[r0,#0]  ; tmpRx
000058  f7fffffe          BL       __aeabi_fdiv
00005c  4931              LDR      r1,|L2.292|
00005e  6008              STR      r0,[r1,#0]  ; fErrorRate
;;;1366       MeterErrorRate[0] = (uint8_t) (fErrorRate*100);
000060  4931              LDR      r1,|L2.296|
000062  4830              LDR      r0,|L2.292|
000064  6800              LDR      r0,[r0,#0]  ; fErrorRate
000066  f7fffffe          BL       __aeabi_fmul
00006a  4606              MOV      r6,r0
00006c  f7fffffe          BL       __aeabi_f2uiz
000070  492e              LDR      r1,|L2.300|
000072  7008              STRB     r0,[r1,#0]
;;;1367           
;;;1368       for (i=0;i<MAX_POWER_METER;i++)
000074  2400              MOVS     r4,#0
000076  e046              B        |L2.262|
                  |L2.120|
;;;1369       {
;;;1370           MeterErrorRate_Tx[i] = 0 ;
000078  2000              MOVS     r0,#0
00007a  0061              LSLS     r1,r4,#1
00007c  4a23              LDR      r2,|L2.268|
00007e  5250              STRH     r0,[r2,r1]
;;;1371           MeterErrorRate_Rx[i] = 0 ;
000080  0061              LSLS     r1,r4,#1
000082  4a23              LDR      r2,|L2.272|
000084  5250              STRH     r0,[r2,r1]
;;;1372           for ( j=0;j<12;j++)
000086  2500              MOVS     r5,#0
000088  e019              B        |L2.190|
                  |L2.138|
;;;1373           {
;;;1374               MeterErrorRate_Tx[i] += MeterErrorRate5Min_Tx[i][j];
00008a  2018              MOVS     r0,#0x18
00008c  4360              MULS     r0,r4,r0
00008e  4921              LDR      r1,|L2.276|
000090  1840              ADDS     r0,r0,r1
000092  0069              LSLS     r1,r5,#1
000094  5a40              LDRH     r0,[r0,r1]
000096  0061              LSLS     r1,r4,#1
000098  4a1c              LDR      r2,|L2.268|
00009a  5a51              LDRH     r1,[r2,r1]
00009c  1840              ADDS     r0,r0,r1
00009e  0061              LSLS     r1,r4,#1
0000a0  5250              STRH     r0,[r2,r1]
;;;1375               MeterErrorRate_Rx[i] += MeterErrorRate5Min_Rx[i][j];
0000a2  2018              MOVS     r0,#0x18
0000a4  4360              MULS     r0,r4,r0
0000a6  491c              LDR      r1,|L2.280|
0000a8  1840              ADDS     r0,r0,r1
0000aa  0069              LSLS     r1,r5,#1
0000ac  5a40              LDRH     r0,[r0,r1]
0000ae  0061              LSLS     r1,r4,#1
0000b0  4a17              LDR      r2,|L2.272|
0000b2  5a51              LDRH     r1,[r2,r1]
0000b4  1840              ADDS     r0,r0,r1
0000b6  0061              LSLS     r1,r4,#1
0000b8  5250              STRH     r0,[r2,r1]
0000ba  1c68              ADDS     r0,r5,#1              ;1372
0000bc  b2c5              UXTB     r5,r0                 ;1372
                  |L2.190|
0000be  2d0c              CMP      r5,#0xc               ;1372
0000c0  dbe3              BLT      |L2.138|
;;;1376           }
;;;1377           tmpTx = (float) MeterErrorRate_Tx[i];
0000c2  0061              LSLS     r1,r4,#1
0000c4  4a11              LDR      r2,|L2.268|
0000c6  5a50              LDRH     r0,[r2,r1]
0000c8  f7fffffe          BL       __aeabi_ui2f
0000cc  4913              LDR      r1,|L2.284|
0000ce  6008              STR      r0,[r1,#0]  ; tmpTx
;;;1378           tmpRx = (float) MeterErrorRate_Rx[i];
0000d0  0061              LSLS     r1,r4,#1
0000d2  4a0f              LDR      r2,|L2.272|
0000d4  5a50              LDRH     r0,[r2,r1]
0000d6  f7fffffe          BL       __aeabi_ui2f
0000da  4911              LDR      r1,|L2.288|
0000dc  6008              STR      r0,[r1,#0]  ; tmpRx
;;;1379           fErrorRate = tmpRx/tmpTx;
0000de  480f              LDR      r0,|L2.284|
0000e0  6801              LDR      r1,[r0,#0]  ; tmpTx
0000e2  480f              LDR      r0,|L2.288|
0000e4  6800              LDR      r0,[r0,#0]  ; tmpRx
0000e6  f7fffffe          BL       __aeabi_fdiv
0000ea  490e              LDR      r1,|L2.292|
0000ec  6008              STR      r0,[r1,#0]  ; fErrorRate
;;;1380           MeterErrorRate[i] = (uint8_t) (fErrorRate*100);
0000ee  490e              LDR      r1,|L2.296|
0000f0  480c              LDR      r0,|L2.292|
0000f2  6800              LDR      r0,[r0,#0]  ; fErrorRate
0000f4  f7fffffe          BL       __aeabi_fmul
0000f8  4606              MOV      r6,r0
0000fa  f7fffffe          BL       __aeabi_f2uiz
0000fe  490b              LDR      r1,|L2.300|
000100  5508              STRB     r0,[r1,r4]
000102  1c60              ADDS     r0,r4,#1              ;1368
000104  b2c4              UXTB     r4,r0                 ;1368
                  |L2.262|
000106  2c1f              CMP      r4,#0x1f              ;1368
000108  dbb6              BLT      |L2.120|
;;;1381       }
;;;1382   }
00010a  bd70              POP      {r4-r6,pc}
;;;1383   
                          ENDP

                  |L2.268|
                          DCD      MeterErrorRate_Tx
                  |L2.272|
                          DCD      MeterErrorRate_Rx
                  |L2.276|
                          DCD      MeterErrorRate5Min_Tx
                  |L2.280|
                          DCD      MeterErrorRate5Min_Rx
                  |L2.284|
                          DCD      tmpTx
                  |L2.288|
                          DCD      tmpRx
                  |L2.292|
                          DCD      fErrorRate
                  |L2.296|
                          DCD      0x42c80000
                  |L2.300|
                          DCD      MeterErrorRate

                          AREA ||i.ChangeRS485Direct||, CODE, READONLY, ALIGN=2

                  ChangeRS485Direct PROC
;;;1404   
;;;1405   void ChangeRS485Direct(void)
000000  b500              PUSH     {lr}
;;;1406   {
;;;1407   
;;;1408   	if ( (fgDisableRS485Tx > 0) && (HOSTTxQ_cnt == 0) )
000002  480c              LDR      r0,|L3.52|
000004  7800              LDRB     r0,[r0,#0]  ; fgDisableRS485Tx
000006  2800              CMP      r0,#0
000008  dd13              BLE      |L3.50|
00000a  480b              LDR      r0,|L3.56|
00000c  7800              LDRB     r0,[r0,#0]  ; HOSTTxQ_cnt
00000e  2800              CMP      r0,#0
000010  d10f              BNE      |L3.50|
;;;1409   	{		
;;;1410   		TickDisableRS485TxDelay++;
000012  480a              LDR      r0,|L3.60|
000014  8800              LDRH     r0,[r0,#0]  ; TickDisableRS485TxDelay
000016  1c40              ADDS     r0,r0,#1
000018  4908              LDR      r1,|L3.60|
00001a  8008              STRH     r0,[r1,#0]
;;;1411   		if ( TickDisableRS485TxDelay > RS485_DIR_DELAY_TIME )
00001c  4608              MOV      r0,r1
00001e  8800              LDRH     r0,[r0,#0]  ; TickDisableRS485TxDelay
000020  2864              CMP      r0,#0x64
000022  dd06              BLE      |L3.50|
;;;1412   		{ 				
;;;1413   			fgDisableRS485Tx = 0 ;
000024  2000              MOVS     r0,#0
000026  4903              LDR      r1,|L3.52|
000028  7008              STRB     r0,[r1,#0]
;;;1414   			TickDisableRS485TxDelay = 0 ;
00002a  4904              LDR      r1,|L3.60|
00002c  8008              STRH     r0,[r1,#0]
;;;1415   			DisableHostUartTx();
00002e  f7fffffe          BL       DisableHostUartTx
                  |L3.50|
;;;1416   		}
;;;1417   	}	
;;;1418   	
;;;1419   }
000032  bd00              POP      {pc}
;;;1420   
                          ENDP

                  |L3.52|
                          DCD      fgDisableRS485Tx
                  |L3.56|
                          DCD      HOSTTxQ_cnt
                  |L3.60|
                          DCD      TickDisableRS485TxDelay

                          AREA ||i.CheckRoomMode||, CODE, READONLY, ALIGN=2

                  CheckRoomMode PROC
;;;1272   }
;;;1273   void CheckRoomMode(void)
000000  4946              LDR      r1,|L4.284|
;;;1274   {
;;;1275       uint8_t i;
;;;1276   
;;;1277       if ( Tick5mS_CheckRoomMode < 50 ) return ;
000002  8809              LDRH     r1,[r1,#0]  ; Tick5mS_CheckRoomMode
000004  2932              CMP      r1,#0x32
000006  da00              BGE      |L4.10|
                  |L4.8|
;;;1278       Tick5mS_CheckRoomMode = 0 ;
;;;1279       
;;;1280       for (i=0;i<MaxPowerMeter;i++)
;;;1281       {
;;;1282           if ( LastRoomMode[i] == RoomMode[i] )
;;;1283           {            
;;;1284   					RoomModeCheckCounter[i] = 0 ;
;;;1285           } else {
;;;1286   					RoomModeCheckCounter[i]++;
;;;1287               if ( RoomModeCheckCounter[i] > 5  )
;;;1288               {
;;;1289                   RoomModeCheckCounter[i] = 0 ;
;;;1290                   if ( RoomMode[i] == RM_FREE_MODE_READY )
;;;1291                   {
;;;1292                       // Change Power Meter Relay
;;;1293                       ModBusCommandList[i] = MBCMD_SET_POWER_ON ;  
;;;1294                       Tick1S_DoubleCheckRoomMode = 0 ;
;;;1295                   } else if ( RoomMode[i] == RM_STOP_MODE_READY ) {
;;;1296                       // Change Power Meter Relay
;;;1297                       ModBusCommandList[i] = MBCMD_SET_POWER_OFF ;
;;;1298                       Tick1S_DoubleCheckRoomMode = 0 ;
;;;1299                   } else {
;;;1300                       // Change Power Meter Relay
;;;1301                       ModBusCommandList[i] = MBCMD_SET_POWER_READER ;
;;;1302                       Tick1S_DoubleCheckRoomMode = 0 ;
;;;1303                   }
;;;1304                   LastRoomMode[i] = RoomMode[i];
;;;1305               }
;;;1306               
;;;1307           }
;;;1308       }
;;;1309       
;;;1310       if (Tick1S_DoubleCheckRoomMode < 20 ) return;
;;;1311       Tick1S_DoubleCheckRoomMode = 0 ;
;;;1312       
;;;1313       for (i=0;i<MaxPowerMeter;i++)
;;;1314       {
;;;1315           if ( RoomMode[i] == RM_FREE_MODE_READY )
;;;1316           {   
;;;1317               if ( (MeterData[i].RelayStatus == 0x02) || (MeterData[i].RelayStatus == 0x00))
;;;1318               {
;;;1319                   ModBusCommandList[i] = MBCMD_SET_POWER_ON ;  
;;;1320               }
;;;1321           }
;;;1322           if ( RoomMode[i] == RM_STOP_MODE_READY )
;;;1323           {   
;;;1324               if ( (MeterData[i].RelayStatus == 0x01) || (MeterData[i].RelayStatus == 0x00))
;;;1325               {
;;;1326                   ModBusCommandList[i] = MBCMD_SET_POWER_OFF ;
;;;1327   							
;;;1328               }
;;;1329           }
;;;1330           if ( (RoomMode[i] == RM_POWER_OFF_READY) || (RoomMode[i] == RM_POWER_ON_READY)  )
;;;1331           {   
;;;1332               if ( MeterData[i].PayMode == 0x00 )
;;;1333               {
;;;1334                   ModBusCommandList[i] = MBCMD_SET_POWER_READER ;
;;;1335               }
;;;1336           }
;;;1337       }
;;;1338       
;;;1339   }
000008  4770              BX       lr
                  |L4.10|
00000a  2100              MOVS     r1,#0                 ;1278
00000c  4a43              LDR      r2,|L4.284|
00000e  8011              STRH     r1,[r2,#0]            ;1278
000010  2000              MOVS     r0,#0                 ;1280
000012  e036              B        |L4.130|
                  |L4.20|
000014  4942              LDR      r1,|L4.288|
000016  5c09              LDRB     r1,[r1,r0]            ;1282
000018  4a42              LDR      r2,|L4.292|
00001a  5c12              LDRB     r2,[r2,r0]            ;1282
00001c  4291              CMP      r1,r2                 ;1282
00001e  d103              BNE      |L4.40|
000020  2100              MOVS     r1,#0                 ;1284
000022  4a41              LDR      r2,|L4.296|
000024  5411              STRB     r1,[r2,r0]            ;1284
000026  e02a              B        |L4.126|
                  |L4.40|
000028  493f              LDR      r1,|L4.296|
00002a  5c09              LDRB     r1,[r1,r0]            ;1286
00002c  1c49              ADDS     r1,r1,#1              ;1286
00002e  4a3e              LDR      r2,|L4.296|
000030  5411              STRB     r1,[r2,r0]            ;1286
000032  4611              MOV      r1,r2                 ;1287
000034  5c09              LDRB     r1,[r1,r0]            ;1287
000036  2905              CMP      r1,#5                 ;1287
000038  dd21              BLE      |L4.126|
00003a  2100              MOVS     r1,#0                 ;1289
00003c  5411              STRB     r1,[r2,r0]            ;1289
00003e  4939              LDR      r1,|L4.292|
000040  5c09              LDRB     r1,[r1,r0]            ;1290
000042  2903              CMP      r1,#3                 ;1290
000044  d106              BNE      |L4.84|
000046  2109              MOVS     r1,#9                 ;1293
000048  4a38              LDR      r2,|L4.300|
00004a  5411              STRB     r1,[r2,r0]            ;1293
00004c  2100              MOVS     r1,#0                 ;1294
00004e  4a38              LDR      r2,|L4.304|
000050  7011              STRB     r1,[r2,#0]            ;1294
000052  e010              B        |L4.118|
                  |L4.84|
000054  4933              LDR      r1,|L4.292|
000056  5c09              LDRB     r1,[r1,r0]            ;1295
000058  2904              CMP      r1,#4                 ;1295
00005a  d106              BNE      |L4.106|
00005c  210a              MOVS     r1,#0xa               ;1297
00005e  4a33              LDR      r2,|L4.300|
000060  5411              STRB     r1,[r2,r0]            ;1297
000062  2100              MOVS     r1,#0                 ;1298
000064  4a32              LDR      r2,|L4.304|
000066  7011              STRB     r1,[r2,#0]            ;1298
000068  e005              B        |L4.118|
                  |L4.106|
00006a  210b              MOVS     r1,#0xb               ;1301
00006c  4a2f              LDR      r2,|L4.300|
00006e  5411              STRB     r1,[r2,r0]            ;1301
000070  2100              MOVS     r1,#0                 ;1302
000072  4a2f              LDR      r2,|L4.304|
000074  7011              STRB     r1,[r2,#0]            ;1302
                  |L4.118|
000076  492b              LDR      r1,|L4.292|
000078  5c09              LDRB     r1,[r1,r0]            ;1304
00007a  4a29              LDR      r2,|L4.288|
00007c  5411              STRB     r1,[r2,r0]            ;1304
                  |L4.126|
00007e  1c41              ADDS     r1,r0,#1              ;1280
000080  b2c8              UXTB     r0,r1                 ;1280
                  |L4.130|
000082  492c              LDR      r1,|L4.308|
000084  7809              LDRB     r1,[r1,#0]            ;1280  ; MaxPowerMeter
000086  4288              CMP      r0,r1                 ;1280
000088  dbc4              BLT      |L4.20|
00008a  4929              LDR      r1,|L4.304|
00008c  7809              LDRB     r1,[r1,#0]            ;1310  ; Tick1S_DoubleCheckRoomMode
00008e  2914              CMP      r1,#0x14              ;1310
000090  da00              BGE      |L4.148|
000092  e7b9              B        |L4.8|
                  |L4.148|
000094  2100              MOVS     r1,#0                 ;1311
000096  4a26              LDR      r2,|L4.304|
000098  7011              STRB     r1,[r2,#0]            ;1311
00009a  2000              MOVS     r0,#0                 ;1313
00009c  e037              B        |L4.270|
                  |L4.158|
00009e  4921              LDR      r1,|L4.292|
0000a0  5c09              LDRB     r1,[r1,r0]            ;1315
0000a2  2903              CMP      r1,#3                 ;1315
0000a4  d10d              BNE      |L4.194|
0000a6  2124              MOVS     r1,#0x24              ;1317
0000a8  4341              MULS     r1,r0,r1              ;1317
0000aa  4a23              LDR      r2,|L4.312|
0000ac  5c51              LDRB     r1,[r2,r1]            ;1317
0000ae  2902              CMP      r1,#2                 ;1317
0000b0  d004              BEQ      |L4.188|
0000b2  2124              MOVS     r1,#0x24              ;1317
0000b4  4341              MULS     r1,r0,r1              ;1317
0000b6  5c51              LDRB     r1,[r2,r1]            ;1317
0000b8  2900              CMP      r1,#0                 ;1317
0000ba  d102              BNE      |L4.194|
                  |L4.188|
0000bc  2109              MOVS     r1,#9                 ;1319
0000be  4a1b              LDR      r2,|L4.300|
0000c0  5411              STRB     r1,[r2,r0]            ;1319
                  |L4.194|
0000c2  4918              LDR      r1,|L4.292|
0000c4  5c09              LDRB     r1,[r1,r0]            ;1322
0000c6  2904              CMP      r1,#4                 ;1322
0000c8  d10d              BNE      |L4.230|
0000ca  2124              MOVS     r1,#0x24              ;1324
0000cc  4341              MULS     r1,r0,r1              ;1324
0000ce  4a1a              LDR      r2,|L4.312|
0000d0  5c51              LDRB     r1,[r2,r1]            ;1324
0000d2  2901              CMP      r1,#1                 ;1324
0000d4  d004              BEQ      |L4.224|
0000d6  2124              MOVS     r1,#0x24              ;1324
0000d8  4341              MULS     r1,r0,r1              ;1324
0000da  5c51              LDRB     r1,[r2,r1]            ;1324
0000dc  2900              CMP      r1,#0                 ;1324
0000de  d102              BNE      |L4.230|
                  |L4.224|
0000e0  210a              MOVS     r1,#0xa               ;1326
0000e2  4a12              LDR      r2,|L4.300|
0000e4  5411              STRB     r1,[r2,r0]            ;1326
                  |L4.230|
0000e6  490f              LDR      r1,|L4.292|
0000e8  5c09              LDRB     r1,[r1,r0]            ;1330
0000ea  2901              CMP      r1,#1                 ;1330
0000ec  d003              BEQ      |L4.246|
0000ee  490d              LDR      r1,|L4.292|
0000f0  5c09              LDRB     r1,[r1,r0]            ;1330
0000f2  2902              CMP      r1,#2                 ;1330
0000f4  d109              BNE      |L4.266|
                  |L4.246|
0000f6  2124              MOVS     r1,#0x24              ;1332
0000f8  4341              MULS     r1,r0,r1              ;1332
0000fa  4a0f              LDR      r2,|L4.312|
0000fc  1889              ADDS     r1,r1,r2              ;1332
0000fe  7849              LDRB     r1,[r1,#1]            ;1332
000100  2900              CMP      r1,#0                 ;1332
000102  d102              BNE      |L4.266|
000104  210b              MOVS     r1,#0xb               ;1334
000106  4a09              LDR      r2,|L4.300|
000108  5411              STRB     r1,[r2,r0]            ;1334
                  |L4.266|
00010a  1c41              ADDS     r1,r0,#1              ;1313
00010c  b2c8              UXTB     r0,r1                 ;1313
                  |L4.270|
00010e  4909              LDR      r1,|L4.308|
000110  7809              LDRB     r1,[r1,#0]            ;1313  ; MaxPowerMeter
000112  4288              CMP      r0,r1                 ;1313
000114  dbc3              BLT      |L4.158|
000116  bf00              NOP      
000118  e776              B        |L4.8|
;;;1340   void EnableHostUartTx(void)
                          ENDP

00011a  0000              DCW      0x0000
                  |L4.284|
                          DCD      Tick5mS_CheckRoomMode
                  |L4.288|
                          DCD      LastRoomMode
                  |L4.292|
                          DCD      RoomMode
                  |L4.296|
                          DCD      RoomModeCheckCounter
                  |L4.300|
                          DCD      ModBusCommandList
                  |L4.304|
                          DCD      Tick1S_DoubleCheckRoomMode
                  |L4.308|
                          DCD      MaxPowerMeter
                  |L4.312|
                          DCD      MeterData

                          AREA ||i.DisableHostUartTx||, CODE, READONLY, ALIGN=2

                  DisableHostUartTx PROC
;;;1344   }
;;;1345   void DisableHostUartTx(void)
000000  4806              LDR      r0,|L5.28|
;;;1346   {
;;;1347   	SYS->GPD_MFPL &= ~(SYS_GPD_MFPL_PD1MFP_Msk );
000002  6880              LDR      r0,[r0,#8]
000004  21f0              MOVS     r1,#0xf0
000006  4388              BICS     r0,r0,r1
000008  4904              LDR      r1,|L5.28|
00000a  6088              STR      r0,[r1,#8]
;;;1348   	PD->MODE = (PD->MODE & (~GPIO_MODE_MODE1_Msk)) | (GPIO_MODE_QUASI << GPIO_MODE_MODE1_Pos);
00000c  4804              LDR      r0,|L5.32|
00000e  6800              LDR      r0,[r0,#0]
000010  210c              MOVS     r1,#0xc
000012  4388              BICS     r0,r0,r1
000014  300c              ADDS     r0,r0,#0xc
000016  4902              LDR      r1,|L5.32|
000018  6008              STR      r0,[r1,#0]
;;;1349   }
00001a  4770              BX       lr
;;;1350   
                          ENDP

                  |L5.28|
                          DCD      0x50000040
                  |L5.32|
                          DCD      0x500040c0

                          AREA ||i.EnableHostUartTx||, CODE, READONLY, ALIGN=2

                  EnableHostUartTx PROC
;;;1339   }
;;;1340   void EnableHostUartTx(void)
000000  4806              LDR      r0,|L6.28|
;;;1341   {
;;;1342   	SYS->GPD_MFPL &= ~(SYS_GPD_MFPL_PD1MFP_Msk | SYS_GPD_MFPL_PD0MFP_Msk);
000002  6880              LDR      r0,[r0,#8]
000004  0a00              LSRS     r0,r0,#8
000006  0200              LSLS     r0,r0,#8
000008  4904              LDR      r1,|L6.28|
00000a  6088              STR      r0,[r1,#8]
;;;1343   	SYS->GPD_MFPL |= (SYS_GPD_MFPL_PD1MFP_UART0_TXD | SYS_GPD_MFPL_PD0MFP_UART0_RXD);
00000c  4608              MOV      r0,r1
00000e  6880              LDR      r0,[r0,#8]
000010  2133              MOVS     r1,#0x33
000012  4308              ORRS     r0,r0,r1
000014  4901              LDR      r1,|L6.28|
000016  6088              STR      r0,[r1,#8]
;;;1344   }
000018  4770              BX       lr
;;;1345   void DisableHostUartTx(void)
                          ENDP

00001a  0000              DCW      0x0000
                  |L6.28|
                          DCD      0x50000040

                          AREA ||i.GPIO_Mode_Init||, CODE, READONLY, ALIGN=2

                  GPIO_Mode_Init PROC
;;;947    
;;;948    void GPIO_Mode_Init(void)
000000  2001              MOVS     r0,#1
;;;949    {
;;;950    
;;;951    	
;;;952    	PA3 = 1 ;
000002  4966              LDR      r1,|L7.412|
000004  60c8              STR      r0,[r1,#0xc]
;;;953    	PF7 = 1 ;
000006  4966              LDR      r1,|L7.416|
000008  61c8              STR      r0,[r1,#0x1c]
;;;954    	
;;;955    	// PA
;;;956    	/* Configure PB.2 as Output mode and PE.1 as Input mode then close it */
;;;957    	PA->MODE = (PA->MODE & (~GPIO_MODE_MODE0_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE0_Pos);
00000a  4866              LDR      r0,|L7.420|
00000c  6800              LDR      r0,[r0,#0]
00000e  0880              LSRS     r0,r0,#2
000010  0080              LSLS     r0,r0,#2
000012  1c40              ADDS     r0,r0,#1
000014  4963              LDR      r1,|L7.420|
000016  6008              STR      r0,[r1,#0]
;;;958    	PA->MODE = (PA->MODE & (~GPIO_MODE_MODE1_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE1_Pos);
000018  4608              MOV      r0,r1
00001a  6800              LDR      r0,[r0,#0]
00001c  210c              MOVS     r1,#0xc
00001e  4388              BICS     r0,r0,r1
000020  1d00              ADDS     r0,r0,#4
000022  4960              LDR      r1,|L7.420|
000024  6008              STR      r0,[r1,#0]
;;;959    	PA->MODE = (PA->MODE & (~GPIO_MODE_MODE2_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE2_Pos);
000026  4608              MOV      r0,r1
000028  6800              LDR      r0,[r0,#0]
00002a  2130              MOVS     r1,#0x30
00002c  4388              BICS     r0,r0,r1
00002e  3010              ADDS     r0,r0,#0x10
000030  495c              LDR      r1,|L7.420|
000032  6008              STR      r0,[r1,#0]
;;;960    	PA->MODE = (PA->MODE & (~GPIO_MODE_MODE3_Msk)) | (GPIO_MODE_OPEN_DRAIN << GPIO_MODE_MODE3_Pos);
000034  4608              MOV      r0,r1
000036  6800              LDR      r0,[r0,#0]
000038  21c0              MOVS     r1,#0xc0
00003a  4388              BICS     r0,r0,r1
00003c  3080              ADDS     r0,r0,#0x80
00003e  4959              LDR      r1,|L7.420|
000040  6008              STR      r0,[r1,#0]
;;;961    	// PB	
;;;962    	PB->MODE = (PB->MODE & (~GPIO_MODE_MODE0_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE0_Pos);	
000042  4858              LDR      r0,|L7.420|
000044  3040              ADDS     r0,r0,#0x40
000046  6800              LDR      r0,[r0,#0]
000048  0880              LSRS     r0,r0,#2
00004a  0080              LSLS     r0,r0,#2
00004c  1c40              ADDS     r0,r0,#1
00004e  4955              LDR      r1,|L7.420|
000050  3140              ADDS     r1,r1,#0x40
000052  6008              STR      r0,[r1,#0]
;;;963    	PB->MODE = (PB->MODE & (~GPIO_MODE_MODE1_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE1_Pos);	
000054  4608              MOV      r0,r1
000056  6800              LDR      r0,[r0,#0]
000058  210c              MOVS     r1,#0xc
00005a  4388              BICS     r0,r0,r1
00005c  1d00              ADDS     r0,r0,#4
00005e  4951              LDR      r1,|L7.420|
000060  3140              ADDS     r1,r1,#0x40
000062  6008              STR      r0,[r1,#0]
;;;964    	PB->MODE = (PB->MODE & (~GPIO_MODE_MODE2_Msk)) | (GPIO_MODE_QUASI << GPIO_MODE_MODE2_Pos);
000064  4608              MOV      r0,r1
000066  6800              LDR      r0,[r0,#0]
000068  2130              MOVS     r1,#0x30
00006a  4388              BICS     r0,r0,r1
00006c  3030              ADDS     r0,r0,#0x30
00006e  494d              LDR      r1,|L7.420|
000070  3140              ADDS     r1,r1,#0x40
000072  6008              STR      r0,[r1,#0]
;;;965    	PB->MODE = (PB->MODE & (~GPIO_MODE_MODE3_Msk)) | (GPIO_MODE_QUASI << GPIO_MODE_MODE3_Pos);
000074  4608              MOV      r0,r1
000076  6800              LDR      r0,[r0,#0]
000078  21c0              MOVS     r1,#0xc0
00007a  4388              BICS     r0,r0,r1
00007c  30c0              ADDS     r0,r0,#0xc0
00007e  4949              LDR      r1,|L7.420|
000080  3140              ADDS     r1,r1,#0x40
000082  6008              STR      r0,[r1,#0]
;;;966    	PB->MODE = (PB->MODE & (~GPIO_MODE_MODE4_Msk)) | (GPIO_MODE_QUASI << GPIO_MODE_MODE4_Pos);
000084  4608              MOV      r0,r1
000086  6800              LDR      r0,[r0,#0]
000088  2103              MOVS     r1,#3
00008a  0209              LSLS     r1,r1,#8
00008c  4388              BICS     r0,r0,r1
00008e  1840              ADDS     r0,r0,r1
000090  4944              LDR      r1,|L7.420|
000092  3140              ADDS     r1,r1,#0x40
000094  6008              STR      r0,[r1,#0]
;;;967    	PB->MODE = (PB->MODE & (~GPIO_MODE_MODE5_Msk)) | (GPIO_MODE_QUASI << GPIO_MODE_MODE5_Pos);
000096  4608              MOV      r0,r1
000098  6800              LDR      r0,[r0,#0]
00009a  2103              MOVS     r1,#3
00009c  0289              LSLS     r1,r1,#10
00009e  4388              BICS     r0,r0,r1
0000a0  1840              ADDS     r0,r0,r1
0000a2  4940              LDR      r1,|L7.420|
0000a4  3140              ADDS     r1,r1,#0x40
0000a6  6008              STR      r0,[r1,#0]
;;;968    	PB->MODE = (PB->MODE & (~GPIO_MODE_MODE6_Msk)) | (GPIO_MODE_QUASI << GPIO_MODE_MODE6_Pos);
0000a8  4608              MOV      r0,r1
0000aa  6800              LDR      r0,[r0,#0]
0000ac  2103              MOVS     r1,#3
0000ae  0309              LSLS     r1,r1,#12
0000b0  4388              BICS     r0,r0,r1
0000b2  1840              ADDS     r0,r0,r1
0000b4  493b              LDR      r1,|L7.420|
0000b6  3140              ADDS     r1,r1,#0x40
0000b8  6008              STR      r0,[r1,#0]
;;;969    	PB->MODE = (PB->MODE & (~GPIO_MODE_MODE7_Msk)) | (GPIO_MODE_QUASI << GPIO_MODE_MODE7_Pos);
0000ba  4608              MOV      r0,r1
0000bc  6800              LDR      r0,[r0,#0]
0000be  2103              MOVS     r1,#3
0000c0  0389              LSLS     r1,r1,#14
0000c2  4388              BICS     r0,r0,r1
0000c4  1840              ADDS     r0,r0,r1
0000c6  4937              LDR      r1,|L7.420|
0000c8  3140              ADDS     r1,r1,#0x40
0000ca  6008              STR      r0,[r1,#0]
;;;970    	//PC
;;;971    	PC->MODE = (PC->MODE & (~GPIO_MODE_MODE0_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE0_Pos);
0000cc  4835              LDR      r0,|L7.420|
0000ce  3080              ADDS     r0,r0,#0x80
0000d0  6800              LDR      r0,[r0,#0]
0000d2  0880              LSRS     r0,r0,#2
0000d4  0080              LSLS     r0,r0,#2
0000d6  1c40              ADDS     r0,r0,#1
0000d8  4932              LDR      r1,|L7.420|
0000da  3180              ADDS     r1,r1,#0x80
0000dc  6008              STR      r0,[r1,#0]
;;;972    	//PC->MODE = (PC->MODE & (~GPIO_MODE_MODE1_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE1_Pos);
;;;973    	PC->MODE = (PC->MODE & (~GPIO_MODE_MODE4_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE4_Pos);
0000de  4608              MOV      r0,r1
0000e0  6800              LDR      r0,[r0,#0]
0000e2  2103              MOVS     r1,#3
0000e4  0209              LSLS     r1,r1,#8
0000e6  4388              BICS     r0,r0,r1
0000e8  30ff              ADDS     r0,r0,#0xff
0000ea  3001              ADDS     r0,#1
0000ec  492d              LDR      r1,|L7.420|
0000ee  3180              ADDS     r1,r1,#0x80
0000f0  6008              STR      r0,[r1,#0]
;;;974    	// PD
;;;975    	PD->MODE = (PD->MODE & (~GPIO_MODE_MODE2_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE2_Pos);
0000f2  482c              LDR      r0,|L7.420|
0000f4  30c0              ADDS     r0,r0,#0xc0
0000f6  6800              LDR      r0,[r0,#0]
0000f8  2130              MOVS     r1,#0x30
0000fa  4388              BICS     r0,r0,r1
0000fc  3010              ADDS     r0,r0,#0x10
0000fe  4929              LDR      r1,|L7.420|
000100  31c0              ADDS     r1,r1,#0xc0
000102  6008              STR      r0,[r1,#0]
;;;976    	PD->MODE = (PD->MODE & (~GPIO_MODE_MODE3_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE3_Pos);
000104  4608              MOV      r0,r1
000106  6800              LDR      r0,[r0,#0]
000108  21c0              MOVS     r1,#0xc0
00010a  4388              BICS     r0,r0,r1
00010c  3040              ADDS     r0,r0,#0x40
00010e  4925              LDR      r1,|L7.420|
000110  31c0              ADDS     r1,r1,#0xc0
000112  6008              STR      r0,[r1,#0]
;;;977    	PD->MODE = (PD->MODE & (~GPIO_MODE_MODE7_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE7_Pos);
000114  4608              MOV      r0,r1
000116  6800              LDR      r0,[r0,#0]
000118  2103              MOVS     r1,#3
00011a  0389              LSLS     r1,r1,#14
00011c  4388              BICS     r0,r0,r1
00011e  2101              MOVS     r1,#1
000120  0389              LSLS     r1,r1,#14
000122  1840              ADDS     r0,r0,r1
000124  491f              LDR      r1,|L7.420|
000126  31c0              ADDS     r1,r1,#0xc0
000128  6008              STR      r0,[r1,#0]
;;;978    	// PE
;;;979    	PE->MODE = (PE->MODE & (~GPIO_MODE_MODE0_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE0_Pos);
00012a  481f              LDR      r0,|L7.424|
00012c  6800              LDR      r0,[r0,#0]
00012e  0880              LSRS     r0,r0,#2
000130  0080              LSLS     r0,r0,#2
000132  1c40              ADDS     r0,r0,#1
000134  491c              LDR      r1,|L7.424|
000136  6008              STR      r0,[r1,#0]
;;;980    	PE->MODE = (PE->MODE & (~GPIO_MODE_MODE10_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE10_Pos);
000138  4608              MOV      r0,r1
00013a  6800              LDR      r0,[r0,#0]
00013c  2103              MOVS     r1,#3
00013e  0509              LSLS     r1,r1,#20
000140  4388              BICS     r0,r0,r1
000142  2101              MOVS     r1,#1
000144  0509              LSLS     r1,r1,#20
000146  1840              ADDS     r0,r0,r1
000148  4917              LDR      r1,|L7.424|
00014a  6008              STR      r0,[r1,#0]
;;;981    	//PE->MODE = (PE->MODE & (~GPIO_MODE_MODE11_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE11_Pos);
;;;982    	// PF
;;;983    	//PF->MODE = (PF->MODE & (~GPIO_MODE_MODE0_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE0_Pos);
;;;984    	//PF->MODE = (PF->MODE & (~GPIO_MODE_MODE1_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE1_Pos);
;;;985    	PF->MODE = (PF->MODE & (~GPIO_MODE_MODE2_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE2_Pos);
00014c  4816              LDR      r0,|L7.424|
00014e  3040              ADDS     r0,r0,#0x40
000150  6800              LDR      r0,[r0,#0]
000152  2130              MOVS     r1,#0x30
000154  4388              BICS     r0,r0,r1
000156  3010              ADDS     r0,r0,#0x10
000158  4913              LDR      r1,|L7.424|
00015a  3140              ADDS     r1,r1,#0x40
00015c  6008              STR      r0,[r1,#0]
;;;986    	PF->MODE = (PF->MODE & (~GPIO_MODE_MODE3_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE3_Pos);
00015e  4608              MOV      r0,r1
000160  6800              LDR      r0,[r0,#0]
000162  21c0              MOVS     r1,#0xc0
000164  4388              BICS     r0,r0,r1
000166  3040              ADDS     r0,r0,#0x40
000168  490f              LDR      r1,|L7.424|
00016a  3140              ADDS     r1,r1,#0x40
00016c  6008              STR      r0,[r1,#0]
;;;987    	PF->MODE = (PF->MODE & (~GPIO_MODE_MODE4_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE4_Pos);
00016e  4608              MOV      r0,r1
000170  6800              LDR      r0,[r0,#0]
000172  2103              MOVS     r1,#3
000174  0209              LSLS     r1,r1,#8
000176  4388              BICS     r0,r0,r1
000178  30ff              ADDS     r0,r0,#0xff
00017a  3001              ADDS     r0,#1
00017c  490a              LDR      r1,|L7.424|
00017e  3140              ADDS     r1,r1,#0x40
000180  6008              STR      r0,[r1,#0]
;;;988    	PF->MODE = (PF->MODE & (~GPIO_MODE_MODE7_Msk)) | (GPIO_MODE_OUTPUT << GPIO_MODE_MODE7_Pos);
000182  4608              MOV      r0,r1
000184  6800              LDR      r0,[r0,#0]
000186  2103              MOVS     r1,#3
000188  0389              LSLS     r1,r1,#14
00018a  4388              BICS     r0,r0,r1
00018c  2101              MOVS     r1,#1
00018e  0389              LSLS     r1,r1,#14
000190  1840              ADDS     r0,r0,r1
000192  4905              LDR      r1,|L7.424|
000194  3140              ADDS     r1,r1,#0x40
000196  6008              STR      r0,[r1,#0]
;;;989    	
;;;990    	
;;;991    }
000198  4770              BX       lr
;;;992    
                          ENDP

00019a  0000              DCW      0x0000
                  |L7.412|
                          DCD      0x50004200
                  |L7.416|
                          DCD      0x50004340
                  |L7.420|
                          DCD      0x50004000
                  |L7.424|
                          DCD      0x50004100

                          AREA ||i.NVIC_EnableIRQ||, CODE, READONLY, ALIGN=2

                  NVIC_EnableIRQ PROC
;;;628     */
;;;629    __STATIC_INLINE void NVIC_EnableIRQ(IRQn_Type IRQn)
000000  06c2              LSLS     r2,r0,#27
;;;630    {
;;;631      NVIC->ISER[0U] = (uint32_t)(1UL << (((uint32_t)(int32_t)IRQn) & 0x1FUL));
000002  0ed2              LSRS     r2,r2,#27
000004  2101              MOVS     r1,#1
000006  4091              LSLS     r1,r1,r2
000008  4a01              LDR      r2,|L8.16|
00000a  6011              STR      r1,[r2,#0]
;;;632    }
00000c  4770              BX       lr
;;;633    
                          ENDP

00000e  0000              DCW      0x0000
                  |L8.16|
                          DCD      0xe000e100

                          AREA ||i.NVIC_SetPriority||, CODE, READONLY, ALIGN=2

                  NVIC_SetPriority PROC
;;;687     */
;;;688    __STATIC_INLINE void NVIC_SetPriority(IRQn_Type IRQn, uint32_t priority)
000000  b510              PUSH     {r4,lr}
;;;689    {
;;;690      if ((int32_t)(IRQn) < 0)
000002  2800              CMP      r0,#0
000004  da19              BGE      |L9.58|
;;;691      {
;;;692        SCB->SHP[_SHP_IDX(IRQn)] = ((uint32_t)(SCB->SHP[_SHP_IDX(IRQn)] & ~(0xFFUL << _BIT_SHIFT(IRQn))) |
000006  4a1a              LDR      r2,|L9.112|
000008  0703              LSLS     r3,r0,#28
00000a  0f1b              LSRS     r3,r3,#28
00000c  3b08              SUBS     r3,r3,#8
00000e  089b              LSRS     r3,r3,#2
000010  009b              LSLS     r3,r3,#2
000012  58d2              LDR      r2,[r2,r3]
000014  0783              LSLS     r3,r0,#30
000016  0edc              LSRS     r4,r3,#27
000018  23ff              MOVS     r3,#0xff
00001a  40a3              LSLS     r3,r3,r4
00001c  439a              BICS     r2,r2,r3
00001e  078b              LSLS     r3,r1,#30
000020  0e1b              LSRS     r3,r3,#24
000022  0784              LSLS     r4,r0,#30
000024  0ee4              LSRS     r4,r4,#27
000026  40a3              LSLS     r3,r3,r4
000028  431a              ORRS     r2,r2,r3
00002a  4b11              LDR      r3,|L9.112|
00002c  0704              LSLS     r4,r0,#28
00002e  0f24              LSRS     r4,r4,#28
000030  3c08              SUBS     r4,r4,#8
000032  08a4              LSRS     r4,r4,#2
000034  00a4              LSLS     r4,r4,#2
000036  511a              STR      r2,[r3,r4]
000038  e018              B        |L9.108|
                  |L9.58|
;;;693           (((priority << (8U - __NVIC_PRIO_BITS)) & (uint32_t)0xFFUL) << _BIT_SHIFT(IRQn)));
;;;694      }
;;;695      else
;;;696      {
;;;697        NVIC->IP[_IP_IDX(IRQn)]  = ((uint32_t)(NVIC->IP[_IP_IDX(IRQn)]  & ~(0xFFUL << _BIT_SHIFT(IRQn))) |
00003a  4a0e              LDR      r2,|L9.116|
00003c  2303              MOVS     r3,#3
00003e  021b              LSLS     r3,r3,#8
000040  18d2              ADDS     r2,r2,r3
000042  0883              LSRS     r3,r0,#2
000044  009b              LSLS     r3,r3,#2
000046  58d2              LDR      r2,[r2,r3]
000048  0783              LSLS     r3,r0,#30
00004a  0edc              LSRS     r4,r3,#27
00004c  23ff              MOVS     r3,#0xff
00004e  40a3              LSLS     r3,r3,r4
000050  439a              BICS     r2,r2,r3
000052  078b              LSLS     r3,r1,#30
000054  0e1b              LSRS     r3,r3,#24
000056  0784              LSLS     r4,r0,#30
000058  0ee4              LSRS     r4,r4,#27
00005a  40a3              LSLS     r3,r3,r4
00005c  431a              ORRS     r2,r2,r3
00005e  4b05              LDR      r3,|L9.116|
000060  2403              MOVS     r4,#3
000062  0224              LSLS     r4,r4,#8
000064  191b              ADDS     r3,r3,r4
000066  0884              LSRS     r4,r0,#2
000068  00a4              LSLS     r4,r4,#2
00006a  511a              STR      r2,[r3,r4]
                  |L9.108|
;;;698           (((priority << (8U - __NVIC_PRIO_BITS)) & (uint32_t)0xFFUL) << _BIT_SHIFT(IRQn)));
;;;699      }
;;;700    }
00006c  bd10              POP      {r4,pc}
;;;701    
                          ENDP

00006e  0000              DCW      0x0000
                  |L9.112|
                          DCD      0xe000ed1c
                  |L9.116|
                          DCD      0xe000e100

                          AREA ||i.ROOM_POWER_Off||, CODE, READONLY, ALIGN=1

                  ROOM_POWER_Off PROC
;;;1618   
;;;1619   void ROOM_POWER_Off(void)
000000  4770              BX       lr
;;;1620   {
;;;1621   /*	
;;;1622   	uint8_t i;
;;;1623       
;;;1624       if ( fgGotRoomMode )
;;;1625       {
;;;1626       
;;;1627   	MeterRelayStatus = RELAY_OFF;
;;;1628   	PF7 = 1;
;;;1629   	for ( i=0;i<50;i++)
;;;1630   		__NOP();
;;;1631   	PA3 = 0;
;;;1632   	for ( i=0;i<50;i++)
;;;1633   		__NOP();
;;;1634       
;;;1635       }
;;;1636   */		
;;;1637   }
;;;1638   
                          ENDP


                          AREA ||i.ROOM_POWER_On||, CODE, READONLY, ALIGN=2

                  ROOM_POWER_On PROC
;;;1603   #endif 
;;;1604   void ROOM_POWER_On(void)
000000  2101              MOVS     r1,#1
;;;1605   {
;;;1606   	uint8_t i;
;;;1607   
;;;1608   	
;;;1609   	MeterRelayStatus = RELAY_ON ;
000002  4a0b              LDR      r2,|L11.48|
000004  7011              STRB     r1,[r2,#0]
;;;1610   	PF7 = 1;
000006  4a0b              LDR      r2,|L11.52|
000008  61d1              STR      r1,[r2,#0x1c]
;;;1611   	for ( i=0;i<50;i++)
00000a  2000              MOVS     r0,#0
00000c  e002              B        |L11.20|
                  |L11.14|
;;;1612   		__NOP();
00000e  bf00              NOP      
000010  1c41              ADDS     r1,r0,#1              ;1611
000012  b2c8              UXTB     r0,r1                 ;1611
                  |L11.20|
000014  2832              CMP      r0,#0x32              ;1611
000016  dbfa              BLT      |L11.14|
;;;1613   	PA3 = 1;
000018  2101              MOVS     r1,#1
00001a  4a07              LDR      r2,|L11.56|
00001c  60d1              STR      r1,[r2,#0xc]
;;;1614   	for ( i=0;i<50;i++)
00001e  2000              MOVS     r0,#0
000020  e002              B        |L11.40|
                  |L11.34|
;;;1615   		__NOP();
000022  bf00              NOP      
000024  1c41              ADDS     r1,r0,#1              ;1614
000026  b2c8              UXTB     r0,r1                 ;1614
                  |L11.40|
000028  2832              CMP      r0,#0x32              ;1614
00002a  dbfa              BLT      |L11.34|
;;;1616   		
;;;1617   }
00002c  4770              BX       lr
;;;1618   
                          ENDP

00002e  0000              DCW      0x0000
                  |L11.48|
                          DCD      MeterRelayStatus
                  |L11.52|
                          DCD      0x50004340
                  |L11.56|
                          DCD      0x50004200

                          AREA ||i.ReadMyMeterID||, CODE, READONLY, ALIGN=2

                  ReadMyMeterID PROC
;;;1472   
;;;1473   void ReadMyMeterID(void)
000000  481e              LDR      r0,|L12.124|
;;;1474   {	
;;;1475   	if ( PB2 )
000002  6880              LDR      r0,[r0,#8]
000004  2800              CMP      r0,#0
000006  d005              BEQ      |L12.20|
;;;1476   	{
;;;1477   		MyMeterID |= (0x01 << 0);
000008  481d              LDR      r0,|L12.128|
00000a  7800              LDRB     r0,[r0,#0]  ; MyMeterID
00000c  2101              MOVS     r1,#1
00000e  4308              ORRS     r0,r0,r1
000010  491b              LDR      r1,|L12.128|
000012  7008              STRB     r0,[r1,#0]
                  |L12.20|
;;;1478   	}
;;;1479   	if ( PB3 )
000014  4819              LDR      r0,|L12.124|
000016  68c0              LDR      r0,[r0,#0xc]
000018  2800              CMP      r0,#0
00001a  d005              BEQ      |L12.40|
;;;1480   	{
;;;1481   		MyMeterID |= (0x01 << 1);
00001c  4818              LDR      r0,|L12.128|
00001e  7800              LDRB     r0,[r0,#0]  ; MyMeterID
000020  2102              MOVS     r1,#2
000022  4308              ORRS     r0,r0,r1
000024  4916              LDR      r1,|L12.128|
000026  7008              STRB     r0,[r1,#0]
                  |L12.40|
;;;1482   	}
;;;1483   	if ( PB4 )
000028  4814              LDR      r0,|L12.124|
00002a  6900              LDR      r0,[r0,#0x10]
00002c  2800              CMP      r0,#0
00002e  d005              BEQ      |L12.60|
;;;1484   	{
;;;1485   		MyMeterID |= (0x01 << 2);
000030  4813              LDR      r0,|L12.128|
000032  7800              LDRB     r0,[r0,#0]  ; MyMeterID
000034  2104              MOVS     r1,#4
000036  4308              ORRS     r0,r0,r1
000038  4911              LDR      r1,|L12.128|
00003a  7008              STRB     r0,[r1,#0]
                  |L12.60|
;;;1486   	}
;;;1487   	if ( PB5 )
00003c  480f              LDR      r0,|L12.124|
00003e  6940              LDR      r0,[r0,#0x14]
000040  2800              CMP      r0,#0
000042  d005              BEQ      |L12.80|
;;;1488   	{
;;;1489   		MyMeterID |= (0x01 << 3);
000044  480e              LDR      r0,|L12.128|
000046  7800              LDRB     r0,[r0,#0]  ; MyMeterID
000048  2108              MOVS     r1,#8
00004a  4308              ORRS     r0,r0,r1
00004c  490c              LDR      r1,|L12.128|
00004e  7008              STRB     r0,[r1,#0]
                  |L12.80|
;;;1490   	}
;;;1491   	if ( PB6 )
000050  480a              LDR      r0,|L12.124|
000052  6980              LDR      r0,[r0,#0x18]
000054  2800              CMP      r0,#0
000056  d005              BEQ      |L12.100|
;;;1492   	{
;;;1493   		MyMeterID |= (0x01 << 4);
000058  4809              LDR      r0,|L12.128|
00005a  7800              LDRB     r0,[r0,#0]  ; MyMeterID
00005c  2110              MOVS     r1,#0x10
00005e  4308              ORRS     r0,r0,r1
000060  4907              LDR      r1,|L12.128|
000062  7008              STRB     r0,[r1,#0]
                  |L12.100|
;;;1494   	}
;;;1495   	if ( PB7 )
000064  4805              LDR      r0,|L12.124|
000066  69c0              LDR      r0,[r0,#0x1c]
000068  2800              CMP      r0,#0
00006a  d005              BEQ      |L12.120|
;;;1496   	{
;;;1497   		MyMeterID |= (0x01 << 5);
00006c  4804              LDR      r0,|L12.128|
00006e  7800              LDRB     r0,[r0,#0]  ; MyMeterID
000070  2120              MOVS     r1,#0x20
000072  4308              ORRS     r0,r0,r1
000074  4902              LDR      r1,|L12.128|
000076  7008              STRB     r0,[r1,#0]
                  |L12.120|
;;;1498   	}
;;;1499   #if 0
;;;1500   	MyMeterID = 0x0A;
;;;1501   #endif 
;;;1502   }
000078  4770              BX       lr
;;;1503   
                          ENDP

00007a  0000              DCW      0x0000
                  |L12.124|
                          DCD      0x50004240
                  |L12.128|
                          DCD      MyMeterID

                          AREA ||i.ReadUserInfoFromEE||, CODE, READONLY, ALIGN=1

                  ReadUserInfoFromEE PROC
;;;1422   
;;;1423   void ReadUserInfoFromEE(void)
000000  2200              MOVS     r2,#0
;;;1424   {
;;;1425   	uint8_t i,j,addrC;
;;;1426   	// d
;;;1427   	addrC=0;
;;;1428   	for(i=0;i<MEMBER_MAX_NO;i++)
000002  2000              MOVS     r0,#0
000004  e009              B        |L13.26|
                  |L13.6|
;;;1429   	{
;;;1430   		for(j=0;j<4;j++)
000006  2100              MOVS     r1,#0
000008  e003              B        |L13.18|
                  |L13.10|
;;;1431   		{
;;;1432   			//Members[i].UID[j] = soft_i2c_eeprom_read_byte(EEPROM_ADDR, EE_ADDR_USER_UID+addrC);
;;;1433   			addrC++;
00000a  1c53              ADDS     r3,r2,#1
00000c  b2da              UXTB     r2,r3
00000e  1c4b              ADDS     r3,r1,#1              ;1430
000010  b2d9              UXTB     r1,r3                 ;1430
                  |L13.18|
000012  2904              CMP      r1,#4                 ;1430
000014  dbf9              BLT      |L13.10|
000016  1c43              ADDS     r3,r0,#1              ;1428
000018  b2d8              UXTB     r0,r3                 ;1428
                  |L13.26|
00001a  2802              CMP      r0,#2                 ;1428
00001c  dbf3              BLT      |L13.6|
;;;1434   		}
;;;1435   	}
;;;1436   	// 
;;;1437   	addrC=0;
00001e  2200              MOVS     r2,#0
;;;1438   	for(i=0;i<MEMBER_MAX_NO;i++)
000020  2000              MOVS     r0,#0
000022  e009              B        |L13.56|
                  |L13.36|
;;;1439   	{
;;;1440   		for(j=0;j<5;j++)
000024  2100              MOVS     r1,#0
000026  e003              B        |L13.48|
                  |L13.40|
;;;1441   		{
;;;1442   			//Members[i].SID[j]=soft_i2c_eeprom_read_byte(EEPROM_ADDR, EE_ADDR_STUDENT_ID+addrC);
;;;1443   			addrC++;
000028  1c53              ADDS     r3,r2,#1
00002a  b2da              UXTB     r2,r3
00002c  1c4b              ADDS     r3,r1,#1              ;1440
00002e  b2d9              UXTB     r1,r3                 ;1440
                  |L13.48|
000030  2905              CMP      r1,#5                 ;1440
000032  dbf9              BLT      |L13.40|
000034  1c43              ADDS     r3,r0,#1              ;1438
000036  b2d8              UXTB     r0,r3                 ;1438
                  |L13.56|
000038  2802              CMP      r0,#2                 ;1438
00003a  dbf3              BLT      |L13.36|
;;;1444   		}
;;;1445   	}
;;;1446   }
00003c  4770              BX       lr
;;;1447   
                          ENDP


                          AREA ||i.RecoverSystemMoniter||, CODE, READONLY, ALIGN=2

                  RecoverSystemMoniter PROC
;;;1389   
;;;1390   void RecoverSystemMoniter(void)
000000  b500              PUSH     {lr}
;;;1391   {
;;;1392   	if ( bRecoverSystem )
000002  4808              LDR      r0,|L14.36|
000004  7800              LDRB     r0,[r0,#0]  ; bRecoverSystem
000006  2800              CMP      r0,#0
000008  d00b              BEQ      |L14.34|
;;;1393   	{
;;;1394   		bRecoverSystem = 0 ;
00000a  2000              MOVS     r0,#0
00000c  4905              LDR      r1,|L14.36|
00000e  7008              STRB     r0,[r1,#0]
;;;1395   		LED_G_On();
000010  4905              LDR      r1,|L14.40|
000012  61c8              STR      r0,[r1,#0x1c]
;;;1396   		ResetHostUART();
000014  f7fffffe          BL       ResetHostUART
;;;1397   		ResetReaderUART();		
000018  f7fffffe          BL       ResetReaderUART
;;;1398   		LED_G_Off();
00001c  2001              MOVS     r0,#1
00001e  4902              LDR      r1,|L14.40|
000020  61c8              STR      r0,[r1,#0x1c]
                  |L14.34|
;;;1399   	}
;;;1400   }
000022  bd00              POP      {pc}
;;;1401   
                          ENDP

                  |L14.36|
                          DCD      bRecoverSystem
                  |L14.40|
                          DCD      0x500042c0

                          AREA ||i.ResetHostUART||, CODE, READONLY, ALIGN=2

                  ResetHostUART PROC
;;;1503   
;;;1504   void ResetHostUART(void)
000000  2000              MOVS     r0,#0
;;;1505   {
;;;1506   	HOSTRxQ_cnt = 0 ; 
000002  4906              LDR      r1,|L15.28|
000004  7008              STRB     r0,[r1,#0]
;;;1507   	HOSTRxQ_wp = 0 ;
000006  4906              LDR      r1,|L15.32|
000008  7008              STRB     r0,[r1,#0]
;;;1508   	HOSTRxQ_rp = 0 ;	
00000a  4906              LDR      r1,|L15.36|
00000c  7008              STRB     r0,[r1,#0]
;;;1509   	HOSTTxQ_cnt = 0 ; 
00000e  4906              LDR      r1,|L15.40|
000010  7008              STRB     r0,[r1,#0]
;;;1510   	HOSTTxQ_wp = 0 ;
000012  4906              LDR      r1,|L15.44|
000014  7008              STRB     r0,[r1,#0]
;;;1511   	HOSTTxQ_rp = 0 ;	
000016  4906              LDR      r1,|L15.48|
000018  7008              STRB     r0,[r1,#0]
;;;1512   }
00001a  4770              BX       lr
;;;1513   void ResetReaderUART(void)
                          ENDP

                  |L15.28|
                          DCD      HOSTRxQ_cnt
                  |L15.32|
                          DCD      HOSTRxQ_wp
                  |L15.36|
                          DCD      HOSTRxQ_rp
                  |L15.40|
                          DCD      HOSTTxQ_cnt
                  |L15.44|
                          DCD      HOSTTxQ_wp
                  |L15.48|
                          DCD      HOSTTxQ_rp

                          AREA ||i.ResetMeterUART||, CODE, READONLY, ALIGN=2

                  ResetMeterUART PROC
;;;1521   }
;;;1522   void ResetMeterUART(void)
000000  2000              MOVS     r0,#0
;;;1523   {
;;;1524   	METERRxQ_wp = 0 ; 
000002  4906              LDR      r1,|L16.28|
000004  7008              STRB     r0,[r1,#0]
;;;1525   	METERRxQ_rp = 0 ;
000006  4906              LDR      r1,|L16.32|
000008  7008              STRB     r0,[r1,#0]
;;;1526   	METERRxQ_cnt = 0 ;
00000a  4906              LDR      r1,|L16.36|
00000c  7008              STRB     r0,[r1,#0]
;;;1527   	METERTxQ_wp = 0 ; 
00000e  4906              LDR      r1,|L16.40|
000010  7008              STRB     r0,[r1,#0]
;;;1528   	METERTxQ_rp = 0 ;
000012  4906              LDR      r1,|L16.44|
000014  7008              STRB     r0,[r1,#0]
;;;1529   	METERTxQ_cnt = 0 ;
000016  4906              LDR      r1,|L16.48|
000018  7008              STRB     r0,[r1,#0]
;;;1530   }
00001a  4770              BX       lr
;;;1531   
                          ENDP

                  |L16.28|
                          DCD      METERRxQ_wp
                  |L16.32|
                          DCD      METERRxQ_rp
                  |L16.36|
                          DCD      METERRxQ_cnt
                  |L16.40|
                          DCD      METERTxQ_wp
                  |L16.44|
                          DCD      METERTxQ_rp
                  |L16.48|
                          DCD      METERTxQ_cnt

                          AREA ||i.ResetReaderUART||, CODE, READONLY, ALIGN=2

                  ResetReaderUART PROC
;;;1512   }
;;;1513   void ResetReaderUART(void)
000000  2000              MOVS     r0,#0
;;;1514   {
;;;1515   	READERRxQ_wp = 0 ; 
000002  4906              LDR      r1,|L17.28|
000004  7008              STRB     r0,[r1,#0]
;;;1516   	READERRxQ_rp = 0 ;
000006  4906              LDR      r1,|L17.32|
000008  7008              STRB     r0,[r1,#0]
;;;1517   	READERRxQ_cnt = 0 ;
00000a  4906              LDR      r1,|L17.36|
00000c  7008              STRB     r0,[r1,#0]
;;;1518   	READERTxQ_wp = 0 ; 
00000e  4906              LDR      r1,|L17.40|
000010  7008              STRB     r0,[r1,#0]
;;;1519   	READERTxQ_rp = 0 ;
000012  4906              LDR      r1,|L17.44|
000014  7008              STRB     r0,[r1,#0]
;;;1520   	READERTxQ_cnt = 0 ;
000016  4906              LDR      r1,|L17.48|
000018  7008              STRB     r0,[r1,#0]
;;;1521   }
00001a  4770              BX       lr
;;;1522   void ResetMeterUART(void)
                          ENDP

                  |L17.28|
                          DCD      READERRxQ_wp
                  |L17.32|
                          DCD      READERRxQ_rp
                  |L17.36|
                          DCD      READERRxQ_cnt
                  |L17.40|
                          DCD      READERTxQ_wp
                  |L17.44|
                          DCD      READERTxQ_rp
                  |L17.48|
                          DCD      READERTxQ_cnt

                          AREA ||i.SYS_Init||, CODE, READONLY, ALIGN=2

                  SYS_Init PROC
;;;869    
;;;870    void SYS_Init(void)
000000  b510              PUSH     {r4,lr}
;;;871    {
;;;872    
;;;873    	/* Set PF multi-function pins for X32_OUT(PF.0) and X32_IN(PF.1) */
;;;874    	SYS->GPF_MFPL = (SYS->GPF_MFPL & (~SYS_GPF_MFPL_PF0MFP_Msk)) | SYS_GPF_MFPL_PF0MFP_X32_OUT;
000002  4855              LDR      r0,|L18.344|
000004  6980              LDR      r0,[r0,#0x18]
000006  0900              LSRS     r0,r0,#4
000008  0100              LSLS     r0,r0,#4
00000a  1c40              ADDS     r0,r0,#1
00000c  4952              LDR      r1,|L18.344|
00000e  6188              STR      r0,[r1,#0x18]
;;;875    	SYS->GPF_MFPL = (SYS->GPF_MFPL & (~SYS_GPF_MFPL_PF1MFP_Msk)) | SYS_GPF_MFPL_PF1MFP_X32_IN;
000010  4608              MOV      r0,r1
000012  6980              LDR      r0,[r0,#0x18]
000014  21f0              MOVS     r1,#0xf0
000016  4388              BICS     r0,r0,r1
000018  3010              ADDS     r0,r0,#0x10
00001a  494f              LDR      r1,|L18.344|
00001c  6188              STR      r0,[r1,#0x18]
;;;876    
;;;877    	/* Set PF multi-function pins for XT1_OUT(PF.3) and XT1_IN(PF.4) */
;;;878    	//SYS->GPF_MFPL = (SYS->GPF_MFPL & (~SYS_GPF_MFPL_PF3MFP_Msk)) | SYS_GPF_MFPL_PF3MFP_XT1_OUT;
;;;879    	//SYS->GPF_MFPL = (SYS->GPF_MFPL & (~SYS_GPF_MFPL_PF4MFP_Msk)) | SYS_GPF_MFPL_PF4MFP_XT1_IN;
;;;880    
;;;881    	
;;;882    	/*---------------------------------------------------------------------------------------------------------*/
;;;883    	/* Init System Clock                                                                                       */
;;;884    	/*---------------------------------------------------------------------------------------------------------*/
;;;885    
;;;886    	/* Enable HIRC, HXT and LXT clock */
;;;887    	/* Enable Internal RC 22.1184MHz clock */
;;;888    	CLK_EnableXtalRC(CLK_PWRCTL_HIRCEN_Msk | CLK_PWRCTL_LXTEN_Msk);
00001e  2006              MOVS     r0,#6
000020  f7fffffe          BL       CLK_EnableXtalRC
;;;889    
;;;890    	/* Wait for HIRC, HXT and LXT clock ready */
;;;891    	CLK_WaitClockReady(CLK_STATUS_HIRCSTB_Msk | CLK_STATUS_LXTSTB_Msk);
000024  2012              MOVS     r0,#0x12
000026  f7fffffe          BL       CLK_WaitClockReady
;;;892    
;;;893    	/* Select HCLK clock source as HIRC and HCLK clock divider as 1 */
;;;894    	CLK_SetHCLK(CLK_CLKSEL0_HCLKSEL_HIRC, CLK_CLKDIV0_HCLK(1));
00002a  2100              MOVS     r1,#0
00002c  2007              MOVS     r0,#7
00002e  f7fffffe          BL       CLK_SetHCLK
;;;895    
;;;896    	/* Set core clock as PLL_CLOCK from PLL */
;;;897    	CLK_SetCoreClock(PLL_CLOCK);
000032  484a              LDR      r0,|L18.348|
000034  f7fffffe          BL       CLK_SetCoreClock
;;;898    
;;;899    	CLK_SetSysTickClockSrc(CLK_CLKSEL0_STCLKSEL_HCLK_DIV2);
000038  2018              MOVS     r0,#0x18
00003a  f7fffffe          BL       CLK_SetSysTickClockSrc
;;;900    
;;;901    	/* Enable UART module clock */
;;;902    	CLK_EnableModuleClock(UART0_MODULE);     
00003e  4848              LDR      r0,|L18.352|
000040  f7fffffe          BL       CLK_EnableModuleClock
;;;903    	CLK_EnableModuleClock(UART1_MODULE);
000044  4846              LDR      r0,|L18.352|
000046  1c40              ADDS     r0,r0,#1
000048  f7fffffe          BL       CLK_EnableModuleClock
;;;904    	CLK_EnableModuleClock(UART2_MODULE);
00004c  4844              LDR      r0,|L18.352|
00004e  1c80              ADDS     r0,r0,#2
000050  f7fffffe          BL       CLK_EnableModuleClock
;;;905    	//CLK_EnableModuleClock(WDT_MODULE);
;;;906    
;;;907    	/* Select UART module clock source as HXT and UART module clock divider as 1 */
;;;908    	CLK_SetModuleClock(UART0_MODULE, CLK_CLKSEL1_UARTSEL_HIRC, CLK_CLKDIV0_UART(1));
000054  2200              MOVS     r2,#0
000056  2103              MOVS     r1,#3
000058  0609              LSLS     r1,r1,#24
00005a  4841              LDR      r0,|L18.352|
00005c  f7fffffe          BL       CLK_SetModuleClock
;;;909    	CLK_SetModuleClock(UART1_MODULE, CLK_CLKSEL1_UARTSEL_HIRC, CLK_CLKDIV0_UART(1));
000060  2200              MOVS     r2,#0
000062  2103              MOVS     r1,#3
000064  0609              LSLS     r1,r1,#24
000066  483e              LDR      r0,|L18.352|
000068  1c40              ADDS     r0,r0,#1
00006a  f7fffffe          BL       CLK_SetModuleClock
;;;910    	CLK_SetModuleClock(UART2_MODULE, CLK_CLKSEL1_UARTSEL_HIRC, CLK_CLKDIV0_UART(1));
00006e  2200              MOVS     r2,#0
000070  2103              MOVS     r1,#3
000072  0609              LSLS     r1,r1,#24
000074  483a              LDR      r0,|L18.352|
000076  1c80              ADDS     r0,r0,#2
000078  f7fffffe          BL       CLK_SetModuleClock
;;;911    	//CLK_SetModuleClock(WDT_MODULE, CLK_CLKSEL1_WDTSEL_HCLK_DIV2048, 0);
;;;912    
;;;913    #define SYS_IRCTCTL0_AUTO_TRIM_HIRC_ENABLE 0x01
;;;914    	// Auto Trim HIRC to 22.1184 MHz
;;;915    	SYS->IRCTCTL0 = (SYS->IRCTCTL0 & (~SYS_IRCTCTL0_FREQSEL_Msk)) | (SYS_IRCTCTL0_AUTO_TRIM_HIRC_ENABLE << SYS_IRCTCTL0_FREQSEL_Pos);
00007c  4836              LDR      r0,|L18.344|
00007e  3040              ADDS     r0,r0,#0x40
000080  6800              LDR      r0,[r0,#0]
000082  0880              LSRS     r0,r0,#2
000084  0080              LSLS     r0,r0,#2
000086  1c40              ADDS     r0,r0,#1
000088  4933              LDR      r1,|L18.344|
00008a  3140              ADDS     r1,r1,#0x40
00008c  6008              STR      r0,[r1,#0]
;;;916    	SYS->IRCTCTL0 = (SYS->IRCTCTL0 & (~SYS_IRCTCTL0_REFCKSEL_Msk)) | (0x00 << SYS_IRCTCTL0_REFCKSEL_Pos) ;
00008e  4608              MOV      r0,r1
000090  6800              LDR      r0,[r0,#0]
000092  2101              MOVS     r1,#1
000094  0289              LSLS     r1,r1,#10
000096  4388              BICS     r0,r0,r1
000098  492f              LDR      r1,|L18.344|
00009a  3140              ADDS     r1,r1,#0x40
00009c  6008              STR      r0,[r1,#0]
;;;917    	SYS->IRCTCTL0 = (SYS->IRCTCTL0 & (~SYS_IRCTCTL0_LOOPSEL_Msk)) | (0x11<<SYS_IRCTCTL0_LOOPSEL_Pos) ;
00009e  4608              MOV      r0,r1
0000a0  6800              LDR      r0,[r0,#0]
0000a2  2130              MOVS     r1,#0x30
0000a4  4388              BICS     r0,r0,r1
0000a6  21ff              MOVS     r1,#0xff
0000a8  3111              ADDS     r1,r1,#0x11
0000aa  4308              ORRS     r0,r0,r1
0000ac  492a              LDR      r1,|L18.344|
0000ae  3140              ADDS     r1,r1,#0x40
0000b0  6008              STR      r0,[r1,#0]
;;;918    	SYS->IRCTCTL0 = (SYS->IRCTCTL0 & (~SYS_IRCTCTL0_RETRYCNT_Msk)) | (0x11<<SYS_IRCTCTL0_RETRYCNT_Pos) ;
0000b2  4608              MOV      r0,r1
0000b4  6800              LDR      r0,[r0,#0]
0000b6  21c0              MOVS     r1,#0xc0
0000b8  4388              BICS     r0,r0,r1
0000ba  2111              MOVS     r1,#0x11
0000bc  0189              LSLS     r1,r1,#6
0000be  4308              ORRS     r0,r0,r1
0000c0  4925              LDR      r1,|L18.344|
0000c2  3140              ADDS     r1,r1,#0x40
0000c4  6008              STR      r0,[r1,#0]
;;;919    
;;;920    	/*---------------------------------------------------------------------------------------------------------*/
;;;921    	/* Init I/O Multi-function                                                                                 */
;;;922    	/*---------------------------------------------------------------------------------------------------------*/
;;;923    
;;;924    	/* Set PD multi-function pins for UART0 RXD(PD.0) and TXD(PD.1) */
;;;925    	SYS->GPD_MFPL = (SYS->GPD_MFPL & (~SYS_GPD_MFPL_PD0MFP_Msk)) | SYS_GPD_MFPL_PD0MFP_UART0_RXD;
0000c6  4824              LDR      r0,|L18.344|
0000c8  6880              LDR      r0,[r0,#8]
0000ca  0900              LSRS     r0,r0,#4
0000cc  0100              LSLS     r0,r0,#4
0000ce  1cc0              ADDS     r0,r0,#3
0000d0  4921              LDR      r1,|L18.344|
0000d2  6088              STR      r0,[r1,#8]
;;;926    	SYS->GPD_MFPL = (SYS->GPD_MFPL & (~SYS_GPD_MFPL_PD1MFP_Msk)) | SYS_GPD_MFPL_PD1MFP_UART0_TXD;
0000d4  4608              MOV      r0,r1
0000d6  6880              LDR      r0,[r0,#8]
0000d8  21f0              MOVS     r1,#0xf0
0000da  4388              BICS     r0,r0,r1
0000dc  3030              ADDS     r0,r0,#0x30
0000de  491e              LDR      r1,|L18.344|
0000e0  6088              STR      r0,[r1,#8]
;;;927    	/* Set PE multi-function pins for UART1 RXD(PE.13) and TXD(PE.12) */
;;;928    	SYS->GPE_MFPH = (SYS->GPE_MFPH & (~SYS_GPE_MFPH_PE13MFP_Msk)) | SYS_GPE_MFPH_PE13MFP_UART1_RXD;
0000e2  4608              MOV      r0,r1
0000e4  6940              LDR      r0,[r0,#0x14]
0000e6  210f              MOVS     r1,#0xf
0000e8  0509              LSLS     r1,r1,#20
0000ea  4388              BICS     r0,r0,r1
0000ec  2103              MOVS     r1,#3
0000ee  0509              LSLS     r1,r1,#20
0000f0  1840              ADDS     r0,r0,r1
0000f2  4919              LDR      r1,|L18.344|
0000f4  6148              STR      r0,[r1,#0x14]
;;;929    	SYS->GPE_MFPH = (SYS->GPE_MFPH & (~SYS_GPE_MFPH_PE12MFP_Msk)) | SYS_GPE_MFPH_PE12MFP_UART1_TXD;
0000f6  4608              MOV      r0,r1
0000f8  6940              LDR      r0,[r0,#0x14]
0000fa  210f              MOVS     r1,#0xf
0000fc  0409              LSLS     r1,r1,#16
0000fe  4388              BICS     r0,r0,r1
000100  2103              MOVS     r1,#3
000102  0409              LSLS     r1,r1,#16
000104  1840              ADDS     r0,r0,r1
000106  4914              LDR      r1,|L18.344|
000108  6148              STR      r0,[r1,#0x14]
;;;930    	SYS->GPE_MFPH = (SYS->GPE_MFPH & (~SYS_GPE_MFPH_PE11MFP_Msk)) | SYS_GPE_MFPH_PE11MFP_UART1_nRTS;
00010a  4608              MOV      r0,r1
00010c  6940              LDR      r0,[r0,#0x14]
00010e  210f              MOVS     r1,#0xf
000110  0309              LSLS     r1,r1,#12
000112  4388              BICS     r0,r0,r1
000114  2103              MOVS     r1,#3
000116  0309              LSLS     r1,r1,#12
000118  1840              ADDS     r0,r0,r1
00011a  490f              LDR      r1,|L18.344|
00011c  6148              STR      r0,[r1,#0x14]
;;;931    	/* Set PC multi-function pins for UART2 RXD(PC.3) and TXD(PC.2) */
;;;932    	SYS->GPC_MFPL = (SYS->GPC_MFPL & (~SYS_GPC_MFPL_PC3MFP_Msk)) | SYS_GPC_MFPL_PC3MFP_UART2_RXD;
00011e  4608              MOV      r0,r1
000120  6800              LDR      r0,[r0,#0]
000122  210f              MOVS     r1,#0xf
000124  0309              LSLS     r1,r1,#12
000126  4388              BICS     r0,r0,r1
000128  2103              MOVS     r1,#3
00012a  0309              LSLS     r1,r1,#12
00012c  1840              ADDS     r0,r0,r1
00012e  490a              LDR      r1,|L18.344|
000130  6008              STR      r0,[r1,#0]
;;;933    	SYS->GPC_MFPL = (SYS->GPC_MFPL & (~SYS_GPC_MFPL_PC2MFP_Msk)) | SYS_GPC_MFPL_PC2MFP_UART2_TXD;		
000132  4608              MOV      r0,r1
000134  6800              LDR      r0,[r0,#0]
000136  210f              MOVS     r1,#0xf
000138  0209              LSLS     r1,r1,#8
00013a  4388              BICS     r0,r0,r1
00013c  2103              MOVS     r1,#3
00013e  0209              LSLS     r1,r1,#8
000140  1840              ADDS     r0,r0,r1
000142  4905              LDR      r1,|L18.344|
000144  6008              STR      r0,[r1,#0]
;;;934    	SYS->GPC_MFPL = (SYS->GPC_MFPL & (~SYS_GPC_MFPL_PC1MFP_Msk)) | SYS_GPC_MFPL_PC1MFP_UART2_nRTS;	
000146  4608              MOV      r0,r1
000148  6800              LDR      r0,[r0,#0]
00014a  21f0              MOVS     r1,#0xf0
00014c  4388              BICS     r0,r0,r1
00014e  3030              ADDS     r0,r0,#0x30
000150  4901              LDR      r1,|L18.344|
000152  6008              STR      r0,[r1,#0]
;;;935    	
;;;936    	/* Set PF multi-function pins for X32_OUT(PF.0) and X32_IN(PF.1) */
;;;937    	//SYS->GPF_MFPL = (SYS->GPF_MFPL & (~SYS_GPF_MFPL_PF0MFP_Msk)) | SYS_GPF_MFPL_PF0MFP_X32_OUT;
;;;938    	//SYS->GPF_MFPL = (SYS->GPF_MFPL & (~SYS_GPF_MFPL_PF1MFP_Msk)) | SYS_GPF_MFPL_PF1MFP_X32_IN;	
;;;939    	
;;;940    	/* Set PF multi-function pins for X32_OUT(PF.0) and X32_IN(PF.1) */
;;;941    	//SYS->GPF_MFPL = (SYS->GPF_MFPL & (~SYS_GPF_MFPL_PF3MFP_Msk)) | SYS_GPF_MFPL_PF3MFP_XT1_OUT;
;;;942    	//SYS->GPF_MFPL = (SYS->GPF_MFPL & (~SYS_GPF_MFPL_PF4MFP_Msk)) | SYS_GPF_MFPL_PF4MFP_XT1_IN;	
;;;943    	
;;;944    		
;;;945    	
;;;946    }
000154  bd10              POP      {r4,pc}
;;;947    
                          ENDP

000156  0000              DCW      0x0000
                  |L18.344|
                          DCD      0x50000040
                  |L18.348|
                          DCD      0x044aa200
                  |L18.352|
                          DCD      0x57803d10

                          AREA ||i.SYS_UnlockReg||, CODE, READONLY, ALIGN=2

                  SYS_UnlockReg PROC
;;;1788     */
;;;1789   __STATIC_INLINE void SYS_UnlockReg(void)
000000  bf00              NOP      
                  |L19.2|
;;;1790   {
;;;1791       do
;;;1792       {
;;;1793           SYS->REGLCTL = 0x59;
000002  2059              MOVS     r0,#0x59
000004  4905              LDR      r1,|L19.28|
000006  6008              STR      r0,[r1,#0]
;;;1794           SYS->REGLCTL = 0x16;
000008  2016              MOVS     r0,#0x16
00000a  6008              STR      r0,[r1,#0]
;;;1795           SYS->REGLCTL = 0x88;
00000c  2088              MOVS     r0,#0x88
00000e  6008              STR      r0,[r1,#0]
;;;1796       }
;;;1797       while(SYS->REGLCTL == 0);
000010  4608              MOV      r0,r1
000012  6800              LDR      r0,[r0,#0]
000014  2800              CMP      r0,#0
000016  d0f4              BEQ      |L19.2|
;;;1798   }
000018  4770              BX       lr
;;;1799   
                          ENDP

00001a  0000              DCW      0x0000
                  |L19.28|
                          DCD      0x50000100

                          AREA ||i.SysTick_Handler||, CODE, READONLY, ALIGN=2

                  SysTick_Handler PROC
;;;358    /*---------------------------------------------------------------------------------------------------------*/
;;;359    void SysTick_Handler(void)
000000  b500              PUSH     {lr}
;;;360    {  
;;;361        uint8_t i;
;;;362        
;;;363        DelayTick++;
000002  4853              LDR      r0,|L20.336|
000004  8800              LDRH     r0,[r0,#0]  ; DelayTick
000006  1c40              ADDS     r0,r0,#1
000008  4951              LDR      r1,|L20.336|
00000a  8008              STRH     r0,[r1,#0]
;;;364        Tick_10mSec++;
00000c  4851              LDR      r0,|L20.340|
00000e  7800              LDRB     r0,[r0,#0]  ; Tick_10mSec
000010  1c40              ADDS     r0,r0,#1
000012  4950              LDR      r1,|L20.340|
000014  7008              STRB     r0,[r1,#0]
;;;365        iTickDelaySendHostCMD++;
000016  4850              LDR      r0,|L20.344|
000018  7800              LDRB     r0,[r0,#0]  ; iTickDelaySendHostCMD
00001a  1c40              ADDS     r0,r0,#1
00001c  494e              LDR      r1,|L20.344|
00001e  7008              STRB     r0,[r1,#0]
;;;366        Tick5mS_CheckRoomMode++;
000020  484e              LDR      r0,|L20.348|
000022  8800              LDRH     r0,[r0,#0]  ; Tick5mS_CheckRoomMode
000024  1c40              ADDS     r0,r0,#1
000026  494d              LDR      r1,|L20.348|
000028  8008              STRH     r0,[r1,#0]
;;;367        
;;;368        ReaderWaitTick++;
00002a  484d              LDR      r0,|L20.352|
00002c  7800              LDRB     r0,[r0,#0]  ; ReaderWaitTick
00002e  1c40              ADDS     r0,r0,#1
000030  494b              LDR      r1,|L20.352|
000032  7008              STRB     r0,[r1,#0]
;;;369        DelayTime4NextCmd++;
000034  484b              LDR      r0,|L20.356|
000036  7800              LDRB     r0,[r0,#0]  ; DelayTime4NextCmd
000038  1c40              ADDS     r0,r0,#1
00003a  494a              LDR      r1,|L20.356|
00003c  7008              STRB     r0,[r1,#0]
;;;370        u32TimeTick2++;
00003e  484a              LDR      r0,|L20.360|
000040  6800              LDR      r0,[r0,#0]  ; u32TimeTick2
000042  1c40              ADDS     r0,r0,#1
000044  4948              LDR      r1,|L20.360|
000046  6008              STR      r0,[r1,#0]  ; u32TimeTick2
;;;371        TickReadPowerTime++;
000048  4848              LDR      r0,|L20.364|
00004a  8800              LDRH     r0,[r0,#0]  ; TickReadPowerTime
00004c  1c40              ADDS     r0,r0,#1
00004e  4947              LDR      r1,|L20.364|
000050  8008              STRH     r0,[r1,#0]
;;;372        TickPollingMeterInterval++;
000052  4847              LDR      r0,|L20.368|
000054  7800              LDRB     r0,[r0,#0]  ; TickPollingMeterInterval
000056  1c40              ADDS     r0,r0,#1
000058  4945              LDR      r1,|L20.368|
00005a  7008              STRB     r0,[r1,#0]
;;;373        TickPollingInterval++;
00005c  4845              LDR      r0,|L20.372|
00005e  7800              LDRB     r0,[r0,#0]  ; TickPollingInterval
000060  1c40              ADDS     r0,r0,#1
000062  4944              LDR      r1,|L20.372|
000064  7008              STRB     r0,[r1,#0]
;;;374        
;;;375        // 1 Sec 
;;;376        if(Tick_10mSec >= 100)
000066  483b              LDR      r0,|L20.340|
000068  7800              LDRB     r0,[r0,#0]  ; Tick_10mSec
00006a  2864              CMP      r0,#0x64
00006c  db3c              BLT      |L20.232|
;;;377        {
;;;378            Tick_10mSec = 0 ;	
00006e  2000              MOVS     r0,#0
000070  4938              LDR      r1,|L20.340|
000072  7008              STRB     r0,[r1,#0]
;;;379            Time_Sec++;
000074  4840              LDR      r0,|L20.376|
000076  7800              LDRB     r0,[r0,#0]  ; Time_Sec
000078  1c40              ADDS     r0,r0,#1
00007a  493f              LDR      r1,|L20.376|
00007c  7008              STRB     r0,[r1,#0]
;;;380            Tick1S_DoubleCheckRoomMode++;
00007e  483f              LDR      r0,|L20.380|
000080  7800              LDRB     r0,[r0,#0]  ; Tick1S_DoubleCheckRoomMode
000082  1c40              ADDS     r0,r0,#1
000084  493d              LDR      r1,|L20.380|
000086  7008              STRB     r0,[r1,#0]
;;;381            Tick1S_ErrorRateGap++;  
000088  483d              LDR      r0,|L20.384|
00008a  8800              LDRH     r0,[r0,#0]  ; Tick1S_ErrorRateGap
00008c  1c40              ADDS     r0,r0,#1
00008e  493c              LDR      r1,|L20.384|
000090  8008              STRH     r0,[r1,#0]
;;;382            if ( Tick1S_ErrorRateGap >= 300 )
000092  4608              MOV      r0,r1
000094  8800              LDRH     r0,[r0,#0]  ; Tick1S_ErrorRateGap
000096  21ff              MOVS     r1,#0xff
000098  312d              ADDS     r1,r1,#0x2d
00009a  4288              CMP      r0,r1
00009c  db24              BLT      |L20.232|
;;;383            {
;;;384                Tick1S_ErrorRateGap = 0 ;
00009e  2000              MOVS     r0,#0
0000a0  4937              LDR      r1,|L20.384|
0000a2  8008              STRH     r0,[r1,#0]
;;;385                MeterErrorRate5Min_Wp++;
0000a4  4837              LDR      r0,|L20.388|
0000a6  7800              LDRB     r0,[r0,#0]  ; MeterErrorRate5Min_Wp
0000a8  1c40              ADDS     r0,r0,#1
0000aa  4936              LDR      r1,|L20.388|
0000ac  7008              STRB     r0,[r1,#0]
;;;386                if ( MeterErrorRate5Min_Wp >= 12 )
0000ae  4608              MOV      r0,r1
0000b0  7800              LDRB     r0,[r0,#0]  ; MeterErrorRate5Min_Wp
0000b2  280c              CMP      r0,#0xc
0000b4  db01              BLT      |L20.186|
;;;387                {
;;;388                    MeterErrorRate5Min_Wp = 0 ;
0000b6  2000              MOVS     r0,#0
0000b8  7008              STRB     r0,[r1,#0]
                  |L20.186|
;;;389                }
;;;390                for(i=0;i<MAX_POWER_METER;i++)
0000ba  2200              MOVS     r2,#0
0000bc  e012              B        |L20.228|
                  |L20.190|
;;;391                {
;;;392                    MeterErrorRate5Min_Tx[i][MeterErrorRate5Min_Wp]=1;
0000be  2101              MOVS     r1,#1
0000c0  2018              MOVS     r0,#0x18
0000c2  4350              MULS     r0,r2,r0
0000c4  4b30              LDR      r3,|L20.392|
0000c6  18c0              ADDS     r0,r0,r3
0000c8  4b2e              LDR      r3,|L20.388|
0000ca  781b              LDRB     r3,[r3,#0]  ; MeterErrorRate5Min_Wp
0000cc  005b              LSLS     r3,r3,#1
0000ce  52c1              STRH     r1,[r0,r3]
;;;393                    MeterErrorRate5Min_Rx[i][MeterErrorRate5Min_Wp]=1;
0000d0  2018              MOVS     r0,#0x18
0000d2  4350              MULS     r0,r2,r0
0000d4  4b2d              LDR      r3,|L20.396|
0000d6  18c0              ADDS     r0,r0,r3
0000d8  4b2a              LDR      r3,|L20.388|
0000da  781b              LDRB     r3,[r3,#0]  ; MeterErrorRate5Min_Wp
0000dc  005b              LSLS     r3,r3,#1
0000de  52c1              STRH     r1,[r0,r3]
0000e0  1c50              ADDS     r0,r2,#1              ;390
0000e2  b2c2              UXTB     r2,r0                 ;390
                  |L20.228|
0000e4  2a1f              CMP      r2,#0x1f              ;390
0000e6  dbea              BLT      |L20.190|
                  |L20.232|
;;;394                }
;;;395            }
;;;396        }
;;;397        
;;;398        SystemTick++;
0000e8  4829              LDR      r0,|L20.400|
0000ea  8800              LDRH     r0,[r0,#0]  ; SystemTick
0000ec  1c40              ADDS     r0,r0,#1
0000ee  4928              LDR      r1,|L20.400|
0000f0  8008              STRH     r0,[r1,#0]
;;;399        if ( SystemTick > SYSTEM_ERROR_TIMEOUT ) 
0000f2  4608              MOV      r0,r1
0000f4  8800              LDRH     r0,[r0,#0]  ; SystemTick
0000f6  21ff              MOVS     r1,#0xff
0000f8  31f5              ADDS     r1,r1,#0xf5
0000fa  4288              CMP      r0,r1
0000fc  dd04              BLE      |L20.264|
;;;400        {
;;;401            //NVIC_SystemReset(); 
;;;402            bRecoverSystem = 1 ;
0000fe  2001              MOVS     r0,#1
000100  4924              LDR      r1,|L20.404|
000102  7008              STRB     r0,[r1,#0]
;;;403            RecoverSystemMoniter();
000104  f7fffffe          BL       RecoverSystemMoniter
                  |L20.264|
;;;404        }
;;;405    		
;;;406        if ( HOSTRxQ_cnt > 0 )
000108  4823              LDR      r0,|L20.408|
00010a  7800              LDRB     r0,[r0,#0]  ; HOSTRxQ_cnt
00010c  2800              CMP      r0,#0
00010e  dd0c              BLE      |L20.298|
;;;407        {
;;;408            TickHostUart++;
000110  4822              LDR      r0,|L20.412|
000112  7800              LDRB     r0,[r0,#0]  ; TickHostUart
000114  1c40              ADDS     r0,r0,#1
000116  4921              LDR      r1,|L20.412|
000118  7008              STRB     r0,[r1,#0]
;;;409            if ( TickHostUart > 100 )
00011a  4608              MOV      r0,r1
00011c  7800              LDRB     r0,[r0,#0]  ; TickHostUart
00011e  2864              CMP      r0,#0x64
000120  dd03              BLE      |L20.298|
;;;410            {	
;;;411                TickHostUart = 0 ;
000122  2000              MOVS     r0,#0
000124  7008              STRB     r0,[r1,#0]
;;;412                ResetHostUART() ;
000126  f7fffffe          BL       ResetHostUART
                  |L20.298|
;;;413            }
;;;414        }
;;;415        if ( READERRxQ_cnt > 0 )
00012a  481d              LDR      r0,|L20.416|
00012c  7800              LDRB     r0,[r0,#0]  ; READERRxQ_cnt
00012e  2800              CMP      r0,#0
000130  dd0c              BLE      |L20.332|
;;;416        {
;;;417            TickMeterUart++;
000132  481c              LDR      r0,|L20.420|
000134  7800              LDRB     r0,[r0,#0]  ; TickMeterUart
000136  1c40              ADDS     r0,r0,#1
000138  491a              LDR      r1,|L20.420|
00013a  7008              STRB     r0,[r1,#0]
;;;418            if ( TickMeterUart > 100 )
00013c  4608              MOV      r0,r1
00013e  7800              LDRB     r0,[r0,#0]  ; TickMeterUart
000140  2864              CMP      r0,#0x64
000142  dd03              BLE      |L20.332|
;;;419            {	
;;;420                TickMeterUart = 0 ;
000144  2000              MOVS     r0,#0
000146  7008              STRB     r0,[r1,#0]
;;;421                ResetReaderUART();
000148  f7fffffe          BL       ResetReaderUART
                  |L20.332|
;;;422            }
;;;423        }
;;;424    	
;;;425    }
00014c  bd00              POP      {pc}
;;;426    
                          ENDP

00014e  0000              DCW      0x0000
                  |L20.336|
                          DCD      DelayTick
                  |L20.340|
                          DCD      Tick_10mSec
                  |L20.344|
                          DCD      iTickDelaySendHostCMD
                  |L20.348|
                          DCD      Tick5mS_CheckRoomMode
                  |L20.352|
                          DCD      ReaderWaitTick
                  |L20.356|
                          DCD      DelayTime4NextCmd
                  |L20.360|
                          DCD      u32TimeTick2
                  |L20.364|
                          DCD      TickReadPowerTime
                  |L20.368|
                          DCD      TickPollingMeterInterval
                  |L20.372|
                          DCD      TickPollingInterval
                  |L20.376|
                          DCD      Time_Sec
                  |L20.380|
                          DCD      Tick1S_DoubleCheckRoomMode
                  |L20.384|
                          DCD      Tick1S_ErrorRateGap
                  |L20.388|
                          DCD      MeterErrorRate5Min_Wp
                  |L20.392|
                          DCD      MeterErrorRate5Min_Tx
                  |L20.396|
                          DCD      MeterErrorRate5Min_Rx
                  |L20.400|
                          DCD      SystemTick
                  |L20.404|
                          DCD      bRecoverSystem
                  |L20.408|
                          DCD      HOSTRxQ_cnt
                  |L20.412|
                          DCD      TickHostUart
                  |L20.416|
                          DCD      READERRxQ_cnt
                  |L20.420|
                          DCD      TickMeterUart

                          AREA ||i.TestI2C_RWEEPROM||, CODE, READONLY, ALIGN=2

                  TestI2C_RWEEPROM PROC
;;;993    
;;;994    void TestI2C_RWEEPROM(void)
000000  b510              PUSH     {r4,lr}
;;;995    {
000002  b09a              SUB      sp,sp,#0x68
;;;996    	uint8_t TestDataBuf[100];
;;;997    	uint8_t i;
;;;998    	
;;;999    	for(i = 0; i < 100; i++)
000004  2400              MOVS     r4,#0
000006  e008              B        |L21.26|
                  |L21.8|
;;;1000   	{
;;;1001   		soft_i2c_eeprom_write_byte(EEPROM_ADDR,i,i+10);
000008  4620              MOV      r0,r4
00000a  300a              ADDS     r0,r0,#0xa
00000c  b2c2              UXTB     r2,r0
00000e  4621              MOV      r1,r4
000010  2050              MOVS     r0,#0x50
000012  f7fffffe          BL       soft_i2c_eeprom_write_byte
000016  1c60              ADDS     r0,r4,#1              ;999
000018  b2c4              UXTB     r4,r0                 ;999
                  |L21.26|
00001a  2c64              CMP      r4,#0x64              ;999
00001c  dbf4              BLT      |L21.8|
;;;1002   	}
;;;1003   	for(i = 0; i < 100; i++)
00001e  2400              MOVS     r4,#0
000020  e007              B        |L21.50|
                  |L21.34|
;;;1004   	{
;;;1005   		TestDataBuf[i] = soft_i2c_eeprom_read_byte(EEPROM_ADDR,i);
000022  4621              MOV      r1,r4
000024  2050              MOVS     r0,#0x50
000026  f7fffffe          BL       soft_i2c_eeprom_read_byte
00002a  a901              ADD      r1,sp,#4
00002c  5508              STRB     r0,[r1,r4]
00002e  1c60              ADDS     r0,r4,#1              ;1003
000030  b2c4              UXTB     r4,r0                 ;1003
                  |L21.50|
000032  2c64              CMP      r4,#0x64              ;1003
000034  dbf5              BLT      |L21.34|
;;;1006   	}
;;;1007   	for(i = 0; i < 100; i++)
000036  2400              MOVS     r4,#0
000038  e008              B        |L21.76|
                  |L21.58|
;;;1008   	{		if ( TestDataBuf[i] != i )
00003a  a801              ADD      r0,sp,#4
00003c  5d00              LDRB     r0,[r0,r4]
00003e  42a0              CMP      r0,r4
000040  d002              BEQ      |L21.72|
;;;1009   		{
;;;1010   			ErrorCode = 0x01 ;
000042  2001              MOVS     r0,#1
000044  4903              LDR      r1,|L21.84|
000046  7008              STRB     r0,[r1,#0]
                  |L21.72|
000048  1c60              ADDS     r0,r4,#1              ;1007
00004a  b2c4              UXTB     r4,r0                 ;1007
                  |L21.76|
00004c  2c64              CMP      r4,#0x64              ;1007
00004e  dbf4              BLT      |L21.58|
;;;1011   		}
;;;1012   	}
;;;1013   }
000050  b01a              ADD      sp,sp,#0x68
000052  bd10              POP      {r4,pc}
;;;1014   
                          ENDP

                  |L21.84|
                          DCD      ErrorCode

                          AREA ||i.UART02_IRQHandler||, CODE, READONLY, ALIGN=2

                  UART02_IRQHandler PROC
;;;429    /*---------------------------------------------------------------------------------------------------------*/
;;;430    void UART02_IRQHandler(void)
000000  b570              PUSH     {r4-r6,lr}
;;;431    {
;;;432    
;;;433    	uint32_t u32IntSts;
;;;434    	uint8_t Rxbuf,i;
;;;435    
;;;436    	u32IntSts = UART2->INTSTS;
000002  48a9              LDR      r0,|L22.680|
000004  69c5              LDR      r5,[r0,#0x1c]
;;;437    	if(u32IntSts & UART_INTSTS_RDAINT_Msk)
000006  1580              ASRS     r0,r0,#22
000008  4028              ANDS     r0,r0,r5
00000a  2800              CMP      r0,#0
00000c  d06e              BEQ      |L22.236|
;;;438    	{
;;;439    
;;;440    		/* Get all the input characters */
;;;441    		while(UART_IS_RX_READY(UART2))
00000e  e067              B        |L22.224|
                  |L22.16|
;;;442    		{
;;;443    			/* Get the character from UART Buffer */
;;;444    			Rxbuf = UART_READ(UART2);
000010  48a5              LDR      r0,|L22.680|
000012  6800              LDR      r0,[r0,#0]
000014  b2c6              UXTB     r6,r0
;;;445    
;;;446    			/* Rx completed */		
;;;447    			TickMeterUart = 0 ;
000016  2000              MOVS     r0,#0
000018  49a4              LDR      r1,|L22.684|
00001a  7008              STRB     r0,[r1,#0]
;;;448    
;;;449    			METERRxQ[METERRxQ_wp] = Rxbuf;                        
00001c  48a4              LDR      r0,|L22.688|
00001e  49a5              LDR      r1,|L22.692|
000020  7809              LDRB     r1,[r1,#0]  ; METERRxQ_wp
000022  5446              STRB     r6,[r0,r1]
;;;450    			METERRxQ_wp++;                 			
000024  48a3              LDR      r0,|L22.692|
000026  7800              LDRB     r0,[r0,#0]  ; METERRxQ_wp
000028  1c40              ADDS     r0,r0,#1
00002a  49a2              LDR      r1,|L22.692|
00002c  7008              STRB     r0,[r1,#0]
;;;451    			METERRxQ_cnt++;
00002e  48a2              LDR      r0,|L22.696|
000030  7800              LDRB     r0,[r0,#0]  ; METERRxQ_cnt
000032  1c40              ADDS     r0,r0,#1
000034  49a0              LDR      r1,|L22.696|
000036  7008              STRB     r0,[r1,#0]
;;;452    			if ( METERRxQ_wp >= MAX_METER_RXQ_LENGTH ) METERRxQ_wp=0; 
000038  489e              LDR      r0,|L22.692|
00003a  7800              LDRB     r0,[r0,#0]  ; METERRxQ_wp
00003c  2810              CMP      r0,#0x10
00003e  db02              BLT      |L22.70|
000040  2000              MOVS     r0,#0
000042  499c              LDR      r1,|L22.692|
000044  7008              STRB     r0,[r1,#0]
                  |L22.70|
;;;453    
;;;454    			if ( METERRxQ[0] != PowerMeterID ) {
000046  489a              LDR      r0,|L22.688|
000048  7800              LDRB     r0,[r0,#0]  ; METERRxQ
00004a  499c              LDR      r1,|L22.700|
00004c  7809              LDRB     r1,[r1,#0]  ; PowerMeterID
00004e  4288              CMP      r0,r1
000050  d007              BEQ      |L22.98|
;;;455    				METERRxQ_wp=0;
000052  2000              MOVS     r0,#0
000054  4997              LDR      r1,|L22.692|
000056  7008              STRB     r0,[r1,#0]
;;;456    				METERRxQ_cnt=0; 
000058  4997              LDR      r1,|L22.696|
00005a  7008              STRB     r0,[r1,#0]
;;;457    				METERRxQ_rp=0;        
00005c  4998              LDR      r1,|L22.704|
00005e  7008              STRB     r0,[r1,#0]
                  |L22.96|
;;;458    				return;
;;;459    			}
;;;460    			if ( METERRxQ[1] == 0x03 ) {
;;;461                                    if ( METERRxQ_wp >= 2 )
;;;462    				METER_RXQLen = METERRxQ[2]+5 ;					
;;;463    			} else {
;;;464    				METER_RXQLen = 8 ;
;;;465    			}
;;;466    
;;;467    			if( METERRxQ_cnt >= METER_RXQLen )
;;;468    			{		
;;;469    				for(i=0;i<METER_RXQLen;i++)
;;;470    				{
;;;471    					TokenMeter[i]=METERRxQ[METERRxQ_rp];					
;;;472    					METERRxQ_cnt--;
;;;473    					METERRxQ_rp++;
;;;474    					if(METERRxQ_rp >= MAX_METER_RXQ_LENGTH) METERRxQ_rp = 0 ;
;;;475    				}
;;;476    				METERRxQ_wp=0;
;;;477    				METERRxQ_cnt=0; 
;;;478    				METERRxQ_rp=0;      
;;;479    				TokenMeterReady = 1 ;
;;;480    			}								
;;;481    
;;;482    		}
;;;483    
;;;484    	}
;;;485    	
;;;486    	//u32IntSts = UART2->INTSTS;
;;;487    	if(u32IntSts & UART_INTSTS_THREINT_Msk)
;;;488    	{
;;;489    		
;;;490    		if(METERTxQ_cnt > 0)
;;;491    		{      
;;;492    			//DIR_METER_RS485_Out();	
;;;493    			while(UART_IS_TX_FULL(UART2));  /* Wait Tx is not full to transmit data */
;;;494    			UART_WRITE(UART2, METERTxQ[METERTxQ_rp]);      
;;;495    			METERTxQ_cnt--;				                   
;;;496    			METERTxQ_rp++;
;;;497    			if(METERTxQ_rp >= MAX_METER_TXQ_LENGTH) METERTxQ_rp = 0 ;
;;;498    			
;;;499    		} else {		
;;;500    			/* Disable UART RDA and THRE interrupt */
;;;501    			//DIR_METER_RS485_In();	
;;;502        	UART_DisableInt(UART2, (UART_INTEN_THREIEN_Msk));
;;;503    			UART_EnableInt(UART2, (UART_INTEN_RDAIEN_Msk));
;;;504    			NVIC_EnableIRQ(UART02_IRQn);
;;;505    			fgDirMeterRS485Out2In = 1 ;     
;;;506    			TickDirMeterRS485Delay = 0 ;
;;;507    			
;;;508    		} 	
;;;509    		
;;;510    	}
;;;511    
;;;512    	u32IntSts = UART0->INTSTS;
;;;513    	if(u32IntSts & UART_INTSTS_RDAINT_Msk)
;;;514    	{
;;;515    
;;;516    
;;;517    		/* Get all the input characters */
;;;518    		while(UART_IS_RX_READY(UART0))
;;;519    		{
;;;520    			/* Get the character from UART Buffer */
;;;521    			Rxbuf = UART_READ(UART0);
;;;522    
;;;523    			/* Rx completed */		
;;;524    			HOSTRxQ[HOSTRxQ_wp] = Rxbuf;
;;;525    			HOSTRxQ_wp++;
;;;526    			HOSTRxQ_cnt++;
;;;527    			
;;;528    			if ( HOSTRxQ_wp >= MAX_HOST_RXQ_LENGTH ) HOSTRxQ_wp=0;
;;;529    			
;;;530    			if ( HOSTRxQ[0] != 0x55 ) 
;;;531    			{
;;;532    				HOSTRxQ_wp=0;
;;;533    				HOSTRxQ_cnt=0;
;;;534    				HOSTRxQ_rp=0;
;;;535    				return;
;;;536    			}	
;;;537    			if( HOSTRxQ_cnt >= HOST_TOKEN_LENGTH )
;;;538    			{
;;;539    				if ( HOSTRxQ[HOST_TOKEN_LENGTH-1] != 0x0A ) {
;;;540    					HOSTRxQ_wp=0;
;;;541    					HOSTRxQ_cnt=0;
;;;542    					HOSTRxQ_rp=0;
;;;543    					return;
;;;544    				}
;;;545    				for(i=0;i<HOST_TOKEN_LENGTH;i++)
;;;546    				{
;;;547    					TokenHost[i]=HOSTRxQ[HOSTRxQ_rp];
;;;548    					HOSTRxQ_cnt--;
;;;549    					HOSTRxQ_rp++;
;;;550    					if(HOSTRxQ_rp >= MAX_HOST_RXQ_LENGTH) HOSTRxQ_rp = 0 ;
;;;551    				}
;;;552    				HOSTRxQ_wp=0;
;;;553    				HOSTRxQ_cnt=0;
;;;554    				HOSTRxQ_rp=0;
;;;555    				HOSTTokenReady = 1 ;
;;;556    				
;;;557    			} 
;;;558    		}
;;;559    
;;;560    	}
;;;561    	
;;;562    	//u32IntSts = UART0->INTSTS;
;;;563    	if(u32IntSts & UART_INTSTS_THREINT_Msk)
;;;564    	{
;;;565    		if(HOSTTxQ_cnt > 0)
;;;566    		{      
;;;567    			while(UART_IS_TX_FULL(UART0));  /* Wait Tx is not full to transmit data */
;;;568    			
;;;569    			UART_WRITE(UART0, HOSTTxQ[HOSTTxQ_rp]);      
;;;570    			HOSTTxQ_cnt--;				                   
;;;571    			HOSTTxQ_rp++;
;;;572    			if(HOSTTxQ_rp >= MAX_HOST_TXQ_LENGTH) HOSTTxQ_rp = 0 ;
;;;573    			
;;;574    		} else {	
;;;575    			/* Disable UART RDA and THRE interrupt */
;;;576        			UART_DisableInt(UART0, (UART_INTEN_THREIEN_Msk));
;;;577    			UART_EnableInt(UART0, (UART_INTEN_RDAIEN_Msk));
;;;578    			NVIC_EnableIRQ(UART02_IRQn);
;;;579    			TickDisableRS485TxDelay = 0 ;
;;;580    			fgDisableRS485Tx = 1 ;	
;;;581    			//LED_G_TOGGLE();
;;;582    		}                	
;;;583    	}
;;;584    }
000060  bd70              POP      {r4-r6,pc}
                  |L22.98|
000062  4893              LDR      r0,|L22.688|
000064  7840              LDRB     r0,[r0,#1]            ;460  ; METERRxQ
000066  2803              CMP      r0,#3                 ;460
000068  d109              BNE      |L22.126|
00006a  4892              LDR      r0,|L22.692|
00006c  7800              LDRB     r0,[r0,#0]            ;461  ; METERRxQ_wp
00006e  2802              CMP      r0,#2                 ;461
000070  db08              BLT      |L22.132|
000072  488f              LDR      r0,|L22.688|
000074  7880              LDRB     r0,[r0,#2]            ;462  ; METERRxQ
000076  1d40              ADDS     r0,r0,#5              ;462
000078  4992              LDR      r1,|L22.708|
00007a  7008              STRB     r0,[r1,#0]            ;462
00007c  e002              B        |L22.132|
                  |L22.126|
00007e  2008              MOVS     r0,#8                 ;464
000080  4990              LDR      r1,|L22.708|
000082  7008              STRB     r0,[r1,#0]            ;464
                  |L22.132|
000084  488c              LDR      r0,|L22.696|
000086  7800              LDRB     r0,[r0,#0]            ;467  ; METERRxQ_cnt
000088  498e              LDR      r1,|L22.708|
00008a  7809              LDRB     r1,[r1,#0]            ;467  ; METER_RXQLen
00008c  4288              CMP      r0,r1                 ;467
00008e  db27              BLT      |L22.224|
000090  2400              MOVS     r4,#0                 ;469
000092  e017              B        |L22.196|
                  |L22.148|
000094  4886              LDR      r0,|L22.688|
000096  498a              LDR      r1,|L22.704|
000098  7809              LDRB     r1,[r1,#0]            ;471  ; METERRxQ_rp
00009a  5c40              LDRB     r0,[r0,r1]            ;471
00009c  498a              LDR      r1,|L22.712|
00009e  5508              STRB     r0,[r1,r4]            ;471
0000a0  4885              LDR      r0,|L22.696|
0000a2  7800              LDRB     r0,[r0,#0]            ;472  ; METERRxQ_cnt
0000a4  1e40              SUBS     r0,r0,#1              ;472
0000a6  4984              LDR      r1,|L22.696|
0000a8  7008              STRB     r0,[r1,#0]            ;472
0000aa  4885              LDR      r0,|L22.704|
0000ac  7800              LDRB     r0,[r0,#0]            ;473  ; METERRxQ_rp
0000ae  1c40              ADDS     r0,r0,#1              ;473
0000b0  4983              LDR      r1,|L22.704|
0000b2  7008              STRB     r0,[r1,#0]            ;473
0000b4  4608              MOV      r0,r1                 ;474
0000b6  7800              LDRB     r0,[r0,#0]            ;474  ; METERRxQ_rp
0000b8  2810              CMP      r0,#0x10              ;474
0000ba  db01              BLT      |L22.192|
0000bc  2000              MOVS     r0,#0                 ;474
0000be  7008              STRB     r0,[r1,#0]            ;474
                  |L22.192|
0000c0  1c60              ADDS     r0,r4,#1              ;469
0000c2  b2c4              UXTB     r4,r0                 ;469
                  |L22.196|
0000c4  487f              LDR      r0,|L22.708|
0000c6  7800              LDRB     r0,[r0,#0]            ;469  ; METER_RXQLen
0000c8  4284              CMP      r4,r0                 ;469
0000ca  dbe3              BLT      |L22.148|
0000cc  2000              MOVS     r0,#0                 ;476
0000ce  4979              LDR      r1,|L22.692|
0000d0  7008              STRB     r0,[r1,#0]            ;476
0000d2  4979              LDR      r1,|L22.696|
0000d4  7008              STRB     r0,[r1,#0]            ;477
0000d6  497a              LDR      r1,|L22.704|
0000d8  7008              STRB     r0,[r1,#0]            ;478
0000da  2001              MOVS     r0,#1                 ;479
0000dc  497b              LDR      r1,|L22.716|
0000de  7008              STRB     r0,[r1,#0]            ;479
                  |L22.224|
0000e0  4871              LDR      r0,|L22.680|
0000e2  69c0              LDR      r0,[r0,#0x1c]         ;441
0000e4  07c0              LSLS     r0,r0,#31             ;441
0000e6  0fc0              LSRS     r0,r0,#31             ;441
0000e8  2800              CMP      r0,#0                 ;441
0000ea  d191              BNE      |L22.16|
                  |L22.236|
0000ec  2001              MOVS     r0,#1                 ;487
0000ee  0240              LSLS     r0,r0,#9              ;487
0000f0  4028              ANDS     r0,r0,r5              ;487
0000f2  2800              CMP      r0,#0                 ;487
0000f4  d034              BEQ      |L22.352|
0000f6  4876              LDR      r0,|L22.720|
0000f8  7800              LDRB     r0,[r0,#0]            ;490  ; METERTxQ_cnt
0000fa  2800              CMP      r0,#0                 ;490
0000fc  dd1f              BLE      |L22.318|
0000fe  bf00              NOP                            ;493
                  |L22.256|
000100  4869              LDR      r0,|L22.680|
000102  6980              LDR      r0,[r0,#0x18]         ;493
000104  2101              MOVS     r1,#1                 ;493
000106  05c9              LSLS     r1,r1,#23             ;493
000108  4008              ANDS     r0,r0,r1              ;493
00010a  0dc0              LSRS     r0,r0,#23             ;493
00010c  2800              CMP      r0,#0                 ;493
00010e  d1f7              BNE      |L22.256|
000110  4870              LDR      r0,|L22.724|
000112  4971              LDR      r1,|L22.728|
000114  7809              LDRB     r1,[r1,#0]            ;494  ; METERTxQ_rp
000116  5c40              LDRB     r0,[r0,r1]            ;494
000118  4963              LDR      r1,|L22.680|
00011a  6008              STR      r0,[r1,#0]            ;494
00011c  486c              LDR      r0,|L22.720|
00011e  7800              LDRB     r0,[r0,#0]            ;495  ; METERTxQ_cnt
000120  1e40              SUBS     r0,r0,#1              ;495
000122  496b              LDR      r1,|L22.720|
000124  7008              STRB     r0,[r1,#0]            ;495
000126  486c              LDR      r0,|L22.728|
000128  7800              LDRB     r0,[r0,#0]            ;496  ; METERTxQ_rp
00012a  1c40              ADDS     r0,r0,#1              ;496
00012c  496a              LDR      r1,|L22.728|
00012e  7008              STRB     r0,[r1,#0]            ;496
000130  4608              MOV      r0,r1                 ;497
000132  7800              LDRB     r0,[r0,#0]            ;497  ; METERTxQ_rp
000134  2819              CMP      r0,#0x19              ;497
000136  db13              BLT      |L22.352|
000138  2000              MOVS     r0,#0                 ;497
00013a  7008              STRB     r0,[r1,#0]            ;497
00013c  e010              B        |L22.352|
                  |L22.318|
00013e  2102              MOVS     r1,#2                 ;502
000140  4859              LDR      r0,|L22.680|
000142  f7fffffe          BL       UART_DisableInt
000146  2101              MOVS     r1,#1                 ;503
000148  4857              LDR      r0,|L22.680|
00014a  f7fffffe          BL       UART_EnableInt
00014e  200c              MOVS     r0,#0xc               ;504
000150  f7fffffe          BL       NVIC_EnableIRQ
000154  2001              MOVS     r0,#1                 ;505
000156  4961              LDR      r1,|L22.732|
000158  7008              STRB     r0,[r1,#0]            ;505
00015a  2000              MOVS     r0,#0                 ;506
00015c  4960              LDR      r1,|L22.736|
00015e  8008              STRH     r0,[r1,#0]            ;506
                  |L22.352|
000160  4860              LDR      r0,|L22.740|
000162  69c5              LDR      r5,[r0,#0x1c]         ;512
000164  1580              ASRS     r0,r0,#22             ;513
000166  4028              ANDS     r0,r0,r5              ;513
000168  2800              CMP      r0,#0                 ;513
00016a  d061              BEQ      |L22.560|
00016c  e05a              B        |L22.548|
                  |L22.366|
00016e  485d              LDR      r0,|L22.740|
000170  6800              LDR      r0,[r0,#0]            ;521
000172  b2c6              UXTB     r6,r0                 ;521
000174  485c              LDR      r0,|L22.744|
000176  495d              LDR      r1,|L22.748|
000178  7809              LDRB     r1,[r1,#0]            ;524  ; HOSTRxQ_wp
00017a  5446              STRB     r6,[r0,r1]            ;524
00017c  485b              LDR      r0,|L22.748|
00017e  7800              LDRB     r0,[r0,#0]            ;525  ; HOSTRxQ_wp
000180  1c40              ADDS     r0,r0,#1              ;525
000182  495a              LDR      r1,|L22.748|
000184  7008              STRB     r0,[r1,#0]            ;525
000186  485a              LDR      r0,|L22.752|
000188  7800              LDRB     r0,[r0,#0]            ;526  ; HOSTRxQ_cnt
00018a  1c40              ADDS     r0,r0,#1              ;526
00018c  4958              LDR      r1,|L22.752|
00018e  7008              STRB     r0,[r1,#0]            ;526
000190  4856              LDR      r0,|L22.748|
000192  7800              LDRB     r0,[r0,#0]            ;528  ; HOSTRxQ_wp
000194  2864              CMP      r0,#0x64              ;528
000196  db02              BLT      |L22.414|
000198  2000              MOVS     r0,#0                 ;528
00019a  4954              LDR      r1,|L22.748|
00019c  7008              STRB     r0,[r1,#0]            ;528
                  |L22.414|
00019e  4852              LDR      r0,|L22.744|
0001a0  7800              LDRB     r0,[r0,#0]            ;530  ; HOSTRxQ
0001a2  2855              CMP      r0,#0x55              ;530
0001a4  d007              BEQ      |L22.438|
0001a6  2000              MOVS     r0,#0                 ;532
0001a8  4950              LDR      r1,|L22.748|
0001aa  7008              STRB     r0,[r1,#0]            ;532
0001ac  4950              LDR      r1,|L22.752|
0001ae  7008              STRB     r0,[r1,#0]            ;533
0001b0  4950              LDR      r1,|L22.756|
0001b2  7008              STRB     r0,[r1,#0]            ;534
0001b4  e754              B        |L22.96|
                  |L22.438|
0001b6  484e              LDR      r0,|L22.752|
0001b8  7800              LDRB     r0,[r0,#0]            ;537  ; HOSTRxQ_cnt
0001ba  2864              CMP      r0,#0x64              ;537
0001bc  db32              BLT      |L22.548|
0001be  484a              LDR      r0,|L22.744|
0001c0  3060              ADDS     r0,r0,#0x60           ;539
0001c2  78c0              LDRB     r0,[r0,#3]            ;539  ; HOSTRxQ
0001c4  280a              CMP      r0,#0xa               ;539
0001c6  d007              BEQ      |L22.472|
0001c8  2000              MOVS     r0,#0                 ;540
0001ca  4948              LDR      r1,|L22.748|
0001cc  7008              STRB     r0,[r1,#0]            ;540
0001ce  4948              LDR      r1,|L22.752|
0001d0  7008              STRB     r0,[r1,#0]            ;541
0001d2  4948              LDR      r1,|L22.756|
0001d4  7008              STRB     r0,[r1,#0]            ;542
0001d6  e743              B        |L22.96|
                  |L22.472|
0001d8  2400              MOVS     r4,#0                 ;545
0001da  e017              B        |L22.524|
                  |L22.476|
0001dc  4842              LDR      r0,|L22.744|
0001de  4945              LDR      r1,|L22.756|
0001e0  7809              LDRB     r1,[r1,#0]            ;547  ; HOSTRxQ_rp
0001e2  5c40              LDRB     r0,[r0,r1]            ;547
0001e4  4944              LDR      r1,|L22.760|
0001e6  5508              STRB     r0,[r1,r4]            ;547
0001e8  4841              LDR      r0,|L22.752|
0001ea  7800              LDRB     r0,[r0,#0]            ;548  ; HOSTRxQ_cnt
0001ec  1e40              SUBS     r0,r0,#1              ;548
0001ee  4940              LDR      r1,|L22.752|
0001f0  7008              STRB     r0,[r1,#0]            ;548
0001f2  4840              LDR      r0,|L22.756|
0001f4  7800              LDRB     r0,[r0,#0]            ;549  ; HOSTRxQ_rp
0001f6  1c40              ADDS     r0,r0,#1              ;549
0001f8  493e              LDR      r1,|L22.756|
0001fa  7008              STRB     r0,[r1,#0]            ;549
0001fc  4608              MOV      r0,r1                 ;550
0001fe  7800              LDRB     r0,[r0,#0]            ;550  ; HOSTRxQ_rp
000200  2864              CMP      r0,#0x64              ;550
000202  db01              BLT      |L22.520|
000204  2000              MOVS     r0,#0                 ;550
000206  7008              STRB     r0,[r1,#0]            ;550
                  |L22.520|
000208  1c60              ADDS     r0,r4,#1              ;545
00020a  b2c4              UXTB     r4,r0                 ;545
                  |L22.524|
00020c  2c64              CMP      r4,#0x64              ;545
00020e  dbe5              BLT      |L22.476|
000210  2000              MOVS     r0,#0                 ;552
000212  4936              LDR      r1,|L22.748|
000214  7008              STRB     r0,[r1,#0]            ;552
000216  4936              LDR      r1,|L22.752|
000218  7008              STRB     r0,[r1,#0]            ;553
00021a  4936              LDR      r1,|L22.756|
00021c  7008              STRB     r0,[r1,#0]            ;554
00021e  2001              MOVS     r0,#1                 ;555
000220  4936              LDR      r1,|L22.764|
000222  7008              STRB     r0,[r1,#0]            ;555
                  |L22.548|
000224  482f              LDR      r0,|L22.740|
000226  69c0              LDR      r0,[r0,#0x1c]         ;518
000228  07c0              LSLS     r0,r0,#31             ;518
00022a  0fc0              LSRS     r0,r0,#31             ;518
00022c  2800              CMP      r0,#0                 ;518
00022e  d19e              BNE      |L22.366|
                  |L22.560|
000230  2001              MOVS     r0,#1                 ;563
000232  0240              LSLS     r0,r0,#9              ;563
000234  4028              ANDS     r0,r0,r5              ;563
000236  2800              CMP      r0,#0                 ;563
000238  d034              BEQ      |L22.676|
00023a  4831              LDR      r0,|L22.768|
00023c  7800              LDRB     r0,[r0,#0]            ;565  ; HOSTTxQ_cnt
00023e  2800              CMP      r0,#0                 ;565
000240  dd1f              BLE      |L22.642|
000242  bf00              NOP                            ;567
                  |L22.580|
000244  4827              LDR      r0,|L22.740|
000246  6980              LDR      r0,[r0,#0x18]         ;567
000248  2101              MOVS     r1,#1                 ;567
00024a  05c9              LSLS     r1,r1,#23             ;567
00024c  4008              ANDS     r0,r0,r1              ;567
00024e  0dc0              LSRS     r0,r0,#23             ;567
000250  2800              CMP      r0,#0                 ;567
000252  d1f7              BNE      |L22.580|
000254  482b              LDR      r0,|L22.772|
000256  492c              LDR      r1,|L22.776|
000258  7809              LDRB     r1,[r1,#0]            ;569  ; HOSTTxQ_rp
00025a  5c40              LDRB     r0,[r0,r1]            ;569
00025c  4921              LDR      r1,|L22.740|
00025e  6008              STR      r0,[r1,#0]            ;569
000260  4827              LDR      r0,|L22.768|
000262  7800              LDRB     r0,[r0,#0]            ;570  ; HOSTTxQ_cnt
000264  1e40              SUBS     r0,r0,#1              ;570
000266  4926              LDR      r1,|L22.768|
000268  7008              STRB     r0,[r1,#0]            ;570
00026a  4827              LDR      r0,|L22.776|
00026c  7800              LDRB     r0,[r0,#0]            ;571  ; HOSTTxQ_rp
00026e  1c40              ADDS     r0,r0,#1              ;571
000270  4925              LDR      r1,|L22.776|
000272  7008              STRB     r0,[r1,#0]            ;571
000274  4608              MOV      r0,r1                 ;572
000276  7800              LDRB     r0,[r0,#0]            ;572  ; HOSTTxQ_rp
000278  2864              CMP      r0,#0x64              ;572
00027a  db13              BLT      |L22.676|
00027c  2000              MOVS     r0,#0                 ;572
00027e  7008              STRB     r0,[r1,#0]            ;572
000280  e010              B        |L22.676|
                  |L22.642|
000282  2102              MOVS     r1,#2                 ;576
000284  4817              LDR      r0,|L22.740|
000286  f7fffffe          BL       UART_DisableInt
00028a  2101              MOVS     r1,#1                 ;577
00028c  4815              LDR      r0,|L22.740|
00028e  f7fffffe          BL       UART_EnableInt
000292  200c              MOVS     r0,#0xc               ;578
000294  f7fffffe          BL       NVIC_EnableIRQ
000298  2000              MOVS     r0,#0                 ;579
00029a  491c              LDR      r1,|L22.780|
00029c  8008              STRH     r0,[r1,#0]            ;579
00029e  2001              MOVS     r0,#1                 ;580
0002a0  491b              LDR      r1,|L22.784|
0002a2  7008              STRB     r0,[r1,#0]            ;580
                  |L22.676|
0002a4  bf00              NOP      
0002a6  e6db              B        |L22.96|
;;;585    		
                          ENDP

                  |L22.680|
                          DCD      0x40154000
                  |L22.684|
                          DCD      TickMeterUart
                  |L22.688|
                          DCD      METERRxQ
                  |L22.692|
                          DCD      METERRxQ_wp
                  |L22.696|
                          DCD      METERRxQ_cnt
                  |L22.700|
                          DCD      PowerMeterID
                  |L22.704|
                          DCD      METERRxQ_rp
                  |L22.708|
                          DCD      METER_RXQLen
                  |L22.712|
                          DCD      TokenMeter
                  |L22.716|
                          DCD      TokenMeterReady
                  |L22.720|
                          DCD      METERTxQ_cnt
                  |L22.724|
                          DCD      METERTxQ
                  |L22.728|
                          DCD      METERTxQ_rp
                  |L22.732|
                          DCD      fgDirMeterRS485Out2In
                  |L22.736|
                          DCD      TickDirMeterRS485Delay
                  |L22.740|
                          DCD      0x40050000
                  |L22.744|
                          DCD      HOSTRxQ
                  |L22.748|
                          DCD      HOSTRxQ_wp
                  |L22.752|
                          DCD      HOSTRxQ_cnt
                  |L22.756|
                          DCD      HOSTRxQ_rp
                  |L22.760|
                          DCD      TokenHost
                  |L22.764|
                          DCD      HOSTTokenReady
                  |L22.768|
                          DCD      HOSTTxQ_cnt
                  |L22.772|
                          DCD      HOSTTxQ
                  |L22.776|
                          DCD      HOSTTxQ_rp
                  |L22.780|
                          DCD      TickDisableRS485TxDelay
                  |L22.784|
                          DCD      fgDisableRS485Tx

                          AREA ||i.UART0_Init||, CODE, READONLY, ALIGN=2

                  UART0_Init PROC
;;;668    // Center 
;;;669    void UART0_Init(void)
000000  b5f0              PUSH     {r4-r7,lr}
;;;670    {
000002  b085              SUB      sp,sp,#0x14
;;;671        /*---------------------------------------------------------------------------------------------------------*/
;;;672        /* Init UART                                                                                               */
;;;673        /*---------------------------------------------------------------------------------------------------------*/
;;;674        /* Reset UART0 */
;;;675        uint8_t u8UartClkSrcSel, u8UartClkDivNum;
;;;676    	uint32_t u32ClkTbl[4] = {__HXT, 0, __LXT, __HIRC};
000004  482e              LDR      r0,|L23.192|
000006  4601              MOV      r1,r0
000008  c90e              LDM      r1,{r1-r3}
00000a  68c0              LDR      r0,[r0,#0xc]  ; <Data1>
00000c  ac01              ADD      r4,sp,#4
00000e  c40e              STM      r4!,{r1-r3}
000010  9004              STR      r0,[sp,#0x10]
;;;677    	uint32_t u32Baud_Div = 0;
000012  2700              MOVS     r7,#0
;;;678    	uint32_t u32baudrate = 57600 ;
000014  25e1              MOVS     r5,#0xe1
000016  022d              LSLS     r5,r5,#8
;;;679    
;;;680    	/*---------------------------------------------------------------------------------------------------------*/
;;;681    	/* Init UART                                                                                               */
;;;682    	/*---------------------------------------------------------------------------------------------------------*/
;;;683    	/* Reset UART1 */
;;;684    	SYS_ResetModule(UART0_RST);
000018  482a              LDR      r0,|L23.196|
00001a  f7fffffe          BL       SYS_ResetModule
;;;685    
;;;686    	/* Configure UART1 and set UART1 Baudrate */
;;;687    	//UART_Open(UART1, 57600);
;;;688    
;;;689    	/* Get UART clock source selection */
;;;690    	u8UartClkSrcSel = (CLK->CLKSEL1 & CLK_CLKSEL1_UARTSEL_Msk) >> CLK_CLKSEL1_UARTSEL_Pos;
00001e  482a              LDR      r0,|L23.200|
000020  6940              LDR      r0,[r0,#0x14]
000022  2103              MOVS     r1,#3
000024  0609              LSLS     r1,r1,#24
000026  4008              ANDS     r0,r0,r1
000028  0e04              LSRS     r4,r0,#24
;;;691    
;;;692    	/* Get UART clock divider number */
;;;693    	u8UartClkDivNum = (CLK->CLKDIV0 & CLK_CLKDIV0_UARTDIV_Msk) >> CLK_CLKDIV0_UARTDIV_Pos;
00002a  4827              LDR      r0,|L23.200|
00002c  6980              LDR      r0,[r0,#0x18]
00002e  210f              MOVS     r1,#0xf
000030  0209              LSLS     r1,r1,#8
000032  4008              ANDS     r0,r0,r1
000034  0a06              LSRS     r6,r0,#8
;;;694    
;;;695    	/* Select UART function */	
;;;696            UART0->FUNCSEL = UART_FUNCSEL_UART;
000036  2000              MOVS     r0,#0
000038  4924              LDR      r1,|L23.204|
00003a  6308              STR      r0,[r1,#0x30]
;;;697            //UART0->ALTCTL = UART_ALTCTL_RS485AUD_Msk;
;;;698            
;;;699            /* Set RTS pin active level as high level active */
;;;700        	//UART1->MODEM = (UART1->MODEM & (~UART_MODEM_RTSACTLV_Msk)) | UART_RTS_IS_HIGH_LEV_ACTIVE;
;;;701    
;;;702            /* Set TX delay time */
;;;703        	//UART1->TOUT = 0;
;;;704    
;;;705    	/* Set UART line configuration */
;;;706    	UART0->LINE = UART_WORD_LEN_8 | UART_PARITY_NONE | UART_STOP_BIT_1;
00003c  2003              MOVS     r0,#3
00003e  60c8              STR      r0,[r1,#0xc]
;;;707    
;;;708    	/* Set UART Rx and RTS trigger level */
;;;709    	UART0->FIFO &= ~(UART_FIFO_RFITL_Msk | UART_FIFO_RTSTRGLV_Msk);    
000040  4608              MOV      r0,r1
000042  6880              LDR      r0,[r0,#8]
000044  4922              LDR      r1,|L23.208|
000046  4008              ANDS     r0,r0,r1
000048  4920              LDR      r1,|L23.204|
00004a  6088              STR      r0,[r1,#8]
;;;710    
;;;711    	/* Get PLL clock frequency if UART clock source selection is PLL */
;;;712    	if(u8UartClkSrcSel == 1)
00004c  2c01              CMP      r4,#1
00004e  d104              BNE      |L23.90|
;;;713    		u32ClkTbl[u8UartClkSrcSel] = CLK_GetPLLClockFreq();
000050  f7fffffe          BL       CLK_GetPLLClockFreq
000054  00a1              LSLS     r1,r4,#2
000056  aa01              ADD      r2,sp,#4
000058  5050              STR      r0,[r2,r1]
                  |L23.90|
;;;714    
;;;715    	/* Set UART baud rate */
;;;716    	if(u32baudrate != 0)
00005a  2d00              CMP      r5,#0
00005c  d025              BEQ      |L23.170|
;;;717    	{
;;;718    		u32Baud_Div = UART_BAUD_MODE2_DIVIDER((u32ClkTbl[u8UartClkSrcSel]) / (u8UartClkDivNum + 1), u32baudrate);
00005e  00a1              LSLS     r1,r4,#2
000060  aa01              ADD      r2,sp,#4
000062  5850              LDR      r0,[r2,r1]
000064  1c71              ADDS     r1,r6,#1
000066  f7fffffe          BL       __aeabi_uidivmod
00006a  0869              LSRS     r1,r5,#1
00006c  1840              ADDS     r0,r0,r1
00006e  4629              MOV      r1,r5
000070  9000              STR      r0,[sp,#0]
000072  f7fffffe          BL       __aeabi_uidivmod
000076  1e87              SUBS     r7,r0,#2
;;;719    
;;;720    		if(u32Baud_Div > 0xFFFF)
000078  4816              LDR      r0,|L23.212|
00007a  4287              CMP      r7,r0
00007c  d910              BLS      |L23.160|
;;;721    			UART0->BAUD = (UART_BAUD_MODE0 | UART_BAUD_MODE0_DIVIDER((u32ClkTbl[u8UartClkSrcSel]) / (u8UartClkDivNum + 1), u32baudrate));
00007e  00a1              LSLS     r1,r4,#2
000080  aa01              ADD      r2,sp,#4
000082  5850              LDR      r0,[r2,r1]
000084  1c71              ADDS     r1,r6,#1
000086  f7fffffe          BL       __aeabi_uidivmod
00008a  00e9              LSLS     r1,r5,#3
00008c  1840              ADDS     r0,r0,r1
00008e  4629              MOV      r1,r5
000090  9000              STR      r0,[sp,#0]
000092  f7fffffe          BL       __aeabi_uidivmod
000096  0900              LSRS     r0,r0,#4
000098  1e80              SUBS     r0,r0,#2
00009a  490c              LDR      r1,|L23.204|
00009c  6248              STR      r0,[r1,#0x24]
00009e  e004              B        |L23.170|
                  |L23.160|
;;;722    		else
;;;723    			UART0->BAUD = (UART_BAUD_MODE2 | u32Baud_Div);
0000a0  2003              MOVS     r0,#3
0000a2  0700              LSLS     r0,r0,#28
0000a4  4338              ORRS     r0,r0,r7
0000a6  4909              LDR      r1,|L23.204|
0000a8  6248              STR      r0,[r1,#0x24]
                  |L23.170|
;;;724        	}
;;;725    	
;;;726    	/* Enable UART RDA and THRE interrupt */	
;;;727    	//RT_EnableInt(UART0, (UART_INTEN_RDAIEN_Msk | UART_INTEN_THREIEN_Msk ));
;;;728    	UART_EnableInt(UART0, (UART_INTEN_RDAIEN_Msk  ));
0000aa  2101              MOVS     r1,#1
0000ac  4807              LDR      r0,|L23.204|
0000ae  f7fffffe          BL       UART_EnableInt
;;;729    	NVIC_EnableIRQ(UART02_IRQn);
0000b2  200c              MOVS     r0,#0xc
0000b4  f7fffffe          BL       NVIC_EnableIRQ
;;;730    	DisableHostUartTx();
0000b8  f7fffffe          BL       DisableHostUartTx
;;;731    	
;;;732    }
0000bc  b005              ADD      sp,sp,#0x14
0000be  bdf0              POP      {r4-r7,pc}
;;;733    
                          ENDP

                  |L23.192|
                          DCD      ||.constdata||
                  |L23.196|
                          DCD      0x04000010
                  |L23.200|
                          DCD      0x50000200
                  |L23.204|
                          DCD      0x40050000
                  |L23.208|
                          DCD      0xfff0ff0f
                  |L23.212|
                          DCD      0x0000ffff

                          AREA ||i.UART1_IRQHandler||, CODE, READONLY, ALIGN=2

                  UART1_IRQHandler PROC
;;;588    /*---------------------------------------------------------------------------------------------------------*/
;;;589    void UART1_IRQHandler(void)
000000  b570              PUSH     {r4-r6,lr}
;;;590    {
;;;591    	uint32_t u32IntSts;
;;;592    	uint8_t Rxbuf,i;
;;;593    
;;;594    #if 1
;;;595    	
;;;596    	u32IntSts = UART1->INTSTS;
000002  4852              LDR      r0,|L24.332|
000004  69c6              LDR      r6,[r0,#0x1c]
;;;597    	if(u32IntSts & UART_INTSTS_RDAINT_Msk)
000006  1580              ASRS     r0,r0,#22
000008  4030              ANDS     r0,r0,r6
00000a  2800              CMP      r0,#0
00000c  d060              BEQ      |L24.208|
;;;598    	{
;;;599    		/* Get all the input characters */
;;;600    		while(UART_IS_RX_READY(UART1))
00000e  e059              B        |L24.196|
                  |L24.16|
;;;601    		{
;;;602    			/* Get the character from UART Buffer */
;;;603    			Rxbuf = UART_READ(UART1);
000010  484e              LDR      r0,|L24.332|
000012  6800              LDR      r0,[r0,#0]
000014  b2c5              UXTB     r5,r0
;;;604    
;;;605    			/* Rx completed */		
;;;606    			READERRxQ[READERRxQ_wp] = Rxbuf;
000016  484e              LDR      r0,|L24.336|
000018  494e              LDR      r1,|L24.340|
00001a  7809              LDRB     r1,[r1,#0]  ; READERRxQ_wp
00001c  5445              STRB     r5,[r0,r1]
;;;607    			READERRxQ_wp++;
00001e  484d              LDR      r0,|L24.340|
000020  7800              LDRB     r0,[r0,#0]  ; READERRxQ_wp
000022  1c40              ADDS     r0,r0,#1
000024  494b              LDR      r1,|L24.340|
000026  7008              STRB     r0,[r1,#0]
;;;608    			READERRxQ_cnt++;
000028  484b              LDR      r0,|L24.344|
00002a  7800              LDRB     r0,[r0,#0]  ; READERRxQ_cnt
00002c  1c40              ADDS     r0,r0,#1
00002e  494a              LDR      r1,|L24.344|
000030  7008              STRB     r0,[r1,#0]
;;;609    			
;;;610    			if ( READERRxQ_wp >= MAX_READER_RXQ_LENGTH ) READERRxQ_wp=0;
000032  4848              LDR      r0,|L24.340|
000034  7800              LDRB     r0,[r0,#0]  ; READERRxQ_wp
000036  2864              CMP      r0,#0x64
000038  db02              BLT      |L24.64|
00003a  2000              MOVS     r0,#0
00003c  4945              LDR      r1,|L24.340|
00003e  7008              STRB     r0,[r1,#0]
                  |L24.64|
;;;611    			
;;;612    			if ( READERRxQ[0] != 0x55 ) 
000040  4843              LDR      r0,|L24.336|
000042  7800              LDRB     r0,[r0,#0]  ; READERRxQ
000044  2855              CMP      r0,#0x55
000046  d006              BEQ      |L24.86|
;;;613    			{
;;;614    				READERRxQ_wp=0;
000048  2000              MOVS     r0,#0
00004a  4942              LDR      r1,|L24.340|
00004c  7008              STRB     r0,[r1,#0]
;;;615    				READERRxQ_cnt=0;
00004e  4942              LDR      r1,|L24.344|
000050  7008              STRB     r0,[r1,#0]
;;;616    				READERRxQ_rp=0;
000052  4942              LDR      r1,|L24.348|
000054  7008              STRB     r0,[r1,#0]
                  |L24.86|
;;;617    			}	
;;;618    			if( READERRxQ_cnt >= READER_TOKEN_LENGTH )
000056  4840              LDR      r0,|L24.344|
000058  7800              LDRB     r0,[r0,#0]  ; READERRxQ_cnt
00005a  2864              CMP      r0,#0x64
00005c  db32              BLT      |L24.196|
;;;619    			{
;;;620    				if ( READERRxQ[READER_TOKEN_LENGTH-1] != 0x0A ) {
00005e  483c              LDR      r0,|L24.336|
000060  3060              ADDS     r0,r0,#0x60
000062  78c0              LDRB     r0,[r0,#3]  ; READERRxQ
000064  280a              CMP      r0,#0xa
000066  d007              BEQ      |L24.120|
;;;621    					READERRxQ_wp=0;
000068  2000              MOVS     r0,#0
00006a  493a              LDR      r1,|L24.340|
00006c  7008              STRB     r0,[r1,#0]
;;;622    					READERRxQ_cnt=0;
00006e  493a              LDR      r1,|L24.344|
000070  7008              STRB     r0,[r1,#0]
;;;623    					READERRxQ_rp=0;
000072  493a              LDR      r1,|L24.348|
000074  7008              STRB     r0,[r1,#0]
                  |L24.118|
;;;624    					return;
;;;625    				}
;;;626    				for(i=0;i<READER_TOKEN_LENGTH;i++)
;;;627    				{
;;;628    					TokenReader[i]=READERRxQ[READERRxQ_rp];
;;;629    					READERRxQ_cnt--;
;;;630    					READERRxQ_rp++;
;;;631    					if(READERRxQ_rp >= MAX_READER_RXQ_LENGTH) READERRxQ_rp = 0 ;
;;;632    				}
;;;633    				READERRxQ_wp=0;
;;;634    				READERRxQ_cnt=0;
;;;635    				READERRxQ_rp=0;
;;;636    				READERTokenReady = 1 ;
;;;637    			} 
;;;638    		}
;;;639    
;;;640    	}
;;;641    	
;;;642    	u32IntSts = UART1->INTSTS;
;;;643    	if(u32IntSts & UART_INTSTS_THREINT_Msk)
;;;644    	{
;;;645    		if(READERTxQ_cnt > 0)
;;;646    		{      
;;;647    			DIR_READER_RS485_Out();
;;;648    			while(UART_IS_TX_FULL(UART1));  /* Wait Tx is not full to transmit data */
;;;649    			UART_WRITE(UART1, READERTxQ[READERTxQ_rp]);      
;;;650    			READERTxQ_cnt--;				                   
;;;651    			READERTxQ_rp++;
;;;652    			if(READERTxQ_rp >= MAX_READER_TXQ_LENGTH) 
;;;653    				READERTxQ_rp = 0 ;		
;;;654    		} else {
;;;655    				
;;;656    			/* Disable UART RDA and THRE interrupt */
;;;657    			UART_DisableInt(UART1, (UART_INTEN_THREIEN_Msk));
;;;658    			UART_EnableInt(UART1, (UART_INTEN_RDAIEN_Msk));
;;;659    			NVIC_EnableIRQ(UART1_IRQn);
;;;660    			TickDirReaderRS485Delay = 0 ;
;;;661    			fgDirReaderRS485Out2In = 1 ;		
;;;662    		}                	
;;;663    	}
;;;664    #endif 
;;;665    
;;;666    }
000076  bd70              POP      {r4-r6,pc}
                  |L24.120|
000078  2400              MOVS     r4,#0                 ;626
00007a  e017              B        |L24.172|
                  |L24.124|
00007c  4834              LDR      r0,|L24.336|
00007e  4937              LDR      r1,|L24.348|
000080  7809              LDRB     r1,[r1,#0]            ;628  ; READERRxQ_rp
000082  5c40              LDRB     r0,[r0,r1]            ;628
000084  4936              LDR      r1,|L24.352|
000086  5508              STRB     r0,[r1,r4]            ;628
000088  4833              LDR      r0,|L24.344|
00008a  7800              LDRB     r0,[r0,#0]            ;629  ; READERRxQ_cnt
00008c  1e40              SUBS     r0,r0,#1              ;629
00008e  4932              LDR      r1,|L24.344|
000090  7008              STRB     r0,[r1,#0]            ;629
000092  4832              LDR      r0,|L24.348|
000094  7800              LDRB     r0,[r0,#0]            ;630  ; READERRxQ_rp
000096  1c40              ADDS     r0,r0,#1              ;630
000098  4930              LDR      r1,|L24.348|
00009a  7008              STRB     r0,[r1,#0]            ;630
00009c  4608              MOV      r0,r1                 ;631
00009e  7800              LDRB     r0,[r0,#0]            ;631  ; READERRxQ_rp
0000a0  2864              CMP      r0,#0x64              ;631
0000a2  db01              BLT      |L24.168|
0000a4  2000              MOVS     r0,#0                 ;631
0000a6  7008              STRB     r0,[r1,#0]            ;631
                  |L24.168|
0000a8  1c60              ADDS     r0,r4,#1              ;626
0000aa  b2c4              UXTB     r4,r0                 ;626
                  |L24.172|
0000ac  2c64              CMP      r4,#0x64              ;626
0000ae  dbe5              BLT      |L24.124|
0000b0  2000              MOVS     r0,#0                 ;633
0000b2  4928              LDR      r1,|L24.340|
0000b4  7008              STRB     r0,[r1,#0]            ;633
0000b6  4928              LDR      r1,|L24.344|
0000b8  7008              STRB     r0,[r1,#0]            ;634
0000ba  4928              LDR      r1,|L24.348|
0000bc  7008              STRB     r0,[r1,#0]            ;635
0000be  2001              MOVS     r0,#1                 ;636
0000c0  4928              LDR      r1,|L24.356|
0000c2  7008              STRB     r0,[r1,#0]            ;636
                  |L24.196|
0000c4  4821              LDR      r0,|L24.332|
0000c6  69c0              LDR      r0,[r0,#0x1c]         ;600
0000c8  07c0              LSLS     r0,r0,#31             ;600
0000ca  0fc0              LSRS     r0,r0,#31             ;600
0000cc  2800              CMP      r0,#0                 ;600
0000ce  d19f              BNE      |L24.16|
                  |L24.208|
0000d0  481e              LDR      r0,|L24.332|
0000d2  69c6              LDR      r6,[r0,#0x1c]         ;642
0000d4  1540              ASRS     r0,r0,#21             ;643
0000d6  4030              ANDS     r0,r0,r6              ;643
0000d8  2800              CMP      r0,#0                 ;643
0000da  d034              BEQ      |L24.326|
0000dc  4822              LDR      r0,|L24.360|
0000de  7800              LDRB     r0,[r0,#0]            ;645  ; READERTxQ_cnt
0000e0  2800              CMP      r0,#0                 ;645
0000e2  dd1f              BLE      |L24.292|
0000e4  bf00              NOP                            ;648
                  |L24.230|
0000e6  4819              LDR      r0,|L24.332|
0000e8  6980              LDR      r0,[r0,#0x18]         ;648
0000ea  2101              MOVS     r1,#1                 ;648
0000ec  05c9              LSLS     r1,r1,#23             ;648
0000ee  4008              ANDS     r0,r0,r1              ;648
0000f0  0dc0              LSRS     r0,r0,#23             ;648
0000f2  2800              CMP      r0,#0                 ;648
0000f4  d1f7              BNE      |L24.230|
0000f6  481d              LDR      r0,|L24.364|
0000f8  491d              LDR      r1,|L24.368|
0000fa  7809              LDRB     r1,[r1,#0]            ;649  ; READERTxQ_rp
0000fc  5c40              LDRB     r0,[r0,r1]            ;649
0000fe  4913              LDR      r1,|L24.332|
000100  6008              STR      r0,[r1,#0]            ;649
000102  4819              LDR      r0,|L24.360|
000104  7800              LDRB     r0,[r0,#0]            ;650  ; READERTxQ_cnt
000106  1e40              SUBS     r0,r0,#1              ;650
000108  4917              LDR      r1,|L24.360|
00010a  7008              STRB     r0,[r1,#0]            ;650
00010c  4818              LDR      r0,|L24.368|
00010e  7800              LDRB     r0,[r0,#0]            ;651  ; READERTxQ_rp
000110  1c40              ADDS     r0,r0,#1              ;651
000112  4917              LDR      r1,|L24.368|
000114  7008              STRB     r0,[r1,#0]            ;651
000116  4608              MOV      r0,r1                 ;652
000118  7800              LDRB     r0,[r0,#0]            ;652  ; READERTxQ_rp
00011a  2864              CMP      r0,#0x64              ;652
00011c  db13              BLT      |L24.326|
00011e  2000              MOVS     r0,#0                 ;653
000120  7008              STRB     r0,[r1,#0]            ;653
000122  e010              B        |L24.326|
                  |L24.292|
000124  2102              MOVS     r1,#2                 ;657
000126  4809              LDR      r0,|L24.332|
000128  f7fffffe          BL       UART_DisableInt
00012c  2101              MOVS     r1,#1                 ;658
00012e  4807              LDR      r0,|L24.332|
000130  f7fffffe          BL       UART_EnableInt
000134  200d              MOVS     r0,#0xd               ;659
000136  f7fffffe          BL       NVIC_EnableIRQ
00013a  2000              MOVS     r0,#0                 ;660
00013c  490d              LDR      r1,|L24.372|
00013e  8008              STRH     r0,[r1,#0]            ;660
000140  2001              MOVS     r0,#1                 ;661
000142  490d              LDR      r1,|L24.376|
000144  7008              STRB     r0,[r1,#0]            ;661
                  |L24.326|
000146  bf00              NOP      
000148  e795              B        |L24.118|
;;;667    
                          ENDP

00014a  0000              DCW      0x0000
                  |L24.332|
                          DCD      0x40150000
                  |L24.336|
                          DCD      READERRxQ
                  |L24.340|
                          DCD      READERRxQ_wp
                  |L24.344|
                          DCD      READERRxQ_cnt
                  |L24.348|
                          DCD      READERRxQ_rp
                  |L24.352|
                          DCD      TokenReader
                  |L24.356|
                          DCD      READERTokenReady
                  |L24.360|
                          DCD      READERTxQ_cnt
                  |L24.364|
                          DCD      READERTxQ
                  |L24.368|
                          DCD      READERTxQ_rp
                  |L24.372|
                          DCD      TickDirReaderRS485Delay
                  |L24.376|
                          DCD      fgDirReaderRS485Out2In

                          AREA ||i.UART1_Init||, CODE, READONLY, ALIGN=2

                  UART1_Init PROC
;;;734    // Reader 
;;;735    void UART1_Init(void)
000000  b5f0              PUSH     {r4-r7,lr}
;;;736    {
000002  b085              SUB      sp,sp,#0x14
;;;737         uint8_t u8UartClkSrcSel, u8UartClkDivNum;
;;;738    	uint32_t u32ClkTbl[4] = {__HXT, 0, __LXT, __HIRC};
000004  4833              LDR      r0,|L25.212|
000006  4601              MOV      r1,r0
000008  c90e              LDM      r1,{r1-r3}
00000a  68c0              LDR      r0,[r0,#0xc]  ; <Data2>
00000c  ac01              ADD      r4,sp,#4
00000e  c40e              STM      r4!,{r1-r3}
000010  9004              STR      r0,[sp,#0x10]
;;;739    	uint32_t u32Baud_Div = 0;
000012  2700              MOVS     r7,#0
;;;740    	uint32_t u32baudrate = 57600 ;
000014  25e1              MOVS     r5,#0xe1
000016  022d              LSLS     r5,r5,#8
;;;741    
;;;742    	/*---------------------------------------------------------------------------------------------------------*/
;;;743    	/* Init UART                                                                                               */
;;;744    	/*---------------------------------------------------------------------------------------------------------*/
;;;745    	/* Reset UART1 */
;;;746    	SYS_ResetModule(UART1_RST);
000018  482f              LDR      r0,|L25.216|
00001a  f7fffffe          BL       SYS_ResetModule
;;;747    
;;;748    	/* Configure UART1 and set UART1 Baudrate */
;;;749    	//UART_Open(UART1, 57600);
;;;750    
;;;751    	/* Get UART clock source selection */
;;;752    	u8UartClkSrcSel = (CLK->CLKSEL1 & CLK_CLKSEL1_UARTSEL_Msk) >> CLK_CLKSEL1_UARTSEL_Pos;
00001e  482f              LDR      r0,|L25.220|
000020  6940              LDR      r0,[r0,#0x14]
000022  2103              MOVS     r1,#3
000024  0609              LSLS     r1,r1,#24
000026  4008              ANDS     r0,r0,r1
000028  0e04              LSRS     r4,r0,#24
;;;753    
;;;754    	/* Get UART clock divider number */
;;;755    	u8UartClkDivNum = (CLK->CLKDIV0 & CLK_CLKDIV0_UARTDIV_Msk) >> CLK_CLKDIV0_UARTDIV_Pos;
00002a  482c              LDR      r0,|L25.220|
00002c  6980              LDR      r0,[r0,#0x18]
00002e  210f              MOVS     r1,#0xf
000030  0209              LSLS     r1,r1,#8
000032  4008              ANDS     r0,r0,r1
000034  0a06              LSRS     r6,r0,#8
;;;756    
;;;757    	/* Select UART function */
;;;758    	//UART1->FUNCSEL = UART_FUNCSEL_UART;
;;;759    
;;;760    	/* Select UART RS485 function mode */
;;;761        	UART1->FUNCSEL = UART_FUNCSEL_RS485;
000036  2003              MOVS     r0,#3
000038  4929              LDR      r1,|L25.224|
00003a  6308              STR      r0,[r1,#0x30]
;;;762    
;;;763        	/* Set RS485-Master as AUD mode */
;;;764        	/* Enable AUD mode to HW control RTS pin automatically */
;;;765        	/* It also can use GPIO to control RTS pin for replacing AUD mode */
;;;766        	UART1->ALTCTL = UART_ALTCTL_RS485AUD_Msk;
00003c  2001              MOVS     r0,#1
00003e  0280              LSLS     r0,r0,#10
000040  62c8              STR      r0,[r1,#0x2c]
;;;767    
;;;768        	/* Set RTS pin active level as high level active */
;;;769        	UART1->MODEM = (UART1->MODEM & (~UART_MODEM_RTSACTLV_Msk)) | UART_RTS_IS_HIGH_LEV_ACTIVE;
000042  4608              MOV      r0,r1
000044  6900              LDR      r0,[r0,#0x10]
000046  1549              ASRS     r1,r1,#21
000048  4388              BICS     r0,r0,r1
00004a  4925              LDR      r1,|L25.224|
00004c  6108              STR      r0,[r1,#0x10]
;;;770    
;;;771        	/* Set TX delay time */
;;;772        	UART1->TOUT = 0;
00004e  2000              MOVS     r0,#0
000050  6208              STR      r0,[r1,#0x20]
;;;773    
;;;774    	/* Set UART line configuration */
;;;775    	UART1->LINE = UART_WORD_LEN_8 | UART_PARITY_NONE | UART_STOP_BIT_1;
000052  2003              MOVS     r0,#3
000054  60c8              STR      r0,[r1,#0xc]
;;;776    
;;;777    	/* Set UART Rx and RTS trigger level */
;;;778    	UART1->FIFO &= ~(UART_FIFO_RFITL_Msk | UART_FIFO_RTSTRGLV_Msk);
000056  4608              MOV      r0,r1
000058  6880              LDR      r0,[r0,#8]
00005a  4922              LDR      r1,|L25.228|
00005c  4008              ANDS     r0,r0,r1
00005e  4920              LDR      r1,|L25.224|
000060  6088              STR      r0,[r1,#8]
;;;779    
;;;780    	/* Get PLL clock frequency if UART clock source selection is PLL */
;;;781    	if(u8UartClkSrcSel == 1)
000062  2c01              CMP      r4,#1
000064  d104              BNE      |L25.112|
;;;782    		u32ClkTbl[u8UartClkSrcSel] = CLK_GetPLLClockFreq();
000066  f7fffffe          BL       CLK_GetPLLClockFreq
00006a  00a1              LSLS     r1,r4,#2
00006c  aa01              ADD      r2,sp,#4
00006e  5050              STR      r0,[r2,r1]
                  |L25.112|
;;;783    
;;;784    	/* Set UART baud rate */
;;;785    	if(u32baudrate != 0)
000070  2d00              CMP      r5,#0
000072  d025              BEQ      |L25.192|
;;;786    	{
;;;787    		u32Baud_Div = UART_BAUD_MODE2_DIVIDER((u32ClkTbl[u8UartClkSrcSel]) / (u8UartClkDivNum + 1), u32baudrate);
000074  00a1              LSLS     r1,r4,#2
000076  aa01              ADD      r2,sp,#4
000078  5850              LDR      r0,[r2,r1]
00007a  1c71              ADDS     r1,r6,#1
00007c  f7fffffe          BL       __aeabi_uidivmod
000080  0869              LSRS     r1,r5,#1
000082  1840              ADDS     r0,r0,r1
000084  4629              MOV      r1,r5
000086  9000              STR      r0,[sp,#0]
000088  f7fffffe          BL       __aeabi_uidivmod
00008c  1e87              SUBS     r7,r0,#2
;;;788    
;;;789    		if(u32Baud_Div > 0xFFFF)
00008e  4816              LDR      r0,|L25.232|
000090  4287              CMP      r7,r0
000092  d910              BLS      |L25.182|
;;;790    			UART1->BAUD = (UART_BAUD_MODE0 | UART_BAUD_MODE0_DIVIDER((u32ClkTbl[u8UartClkSrcSel]) / (u8UartClkDivNum + 1), u32baudrate));
000094  00a1              LSLS     r1,r4,#2
000096  aa01              ADD      r2,sp,#4
000098  5850              LDR      r0,[r2,r1]
00009a  1c71              ADDS     r1,r6,#1
00009c  f7fffffe          BL       __aeabi_uidivmod
0000a0  00e9              LSLS     r1,r5,#3
0000a2  1840              ADDS     r0,r0,r1
0000a4  4629              MOV      r1,r5
0000a6  9000              STR      r0,[sp,#0]
0000a8  f7fffffe          BL       __aeabi_uidivmod
0000ac  0900              LSRS     r0,r0,#4
0000ae  1e80              SUBS     r0,r0,#2
0000b0  490b              LDR      r1,|L25.224|
0000b2  6248              STR      r0,[r1,#0x24]
0000b4  e004              B        |L25.192|
                  |L25.182|
;;;791    		else
;;;792    			UART1->BAUD = (UART_BAUD_MODE2 | u32Baud_Div);
0000b6  2003              MOVS     r0,#3
0000b8  0700              LSLS     r0,r0,#28
0000ba  4338              ORRS     r0,r0,r7
0000bc  4908              LDR      r1,|L25.224|
0000be  6248              STR      r0,[r1,#0x24]
                  |L25.192|
;;;793        	}
;;;794    	
;;;795    	/* Enable UART RDA and THRE interrupt */
;;;796    	//UART_EnableInt(UART1, (UART_INTEN_RDAIEN_Msk | UART_INTEN_THREIEN_Msk));
;;;797    	UART_EnableInt(UART1, (UART_INTEN_RDAIEN_Msk ));
0000c0  2101              MOVS     r1,#1
0000c2  4807              LDR      r0,|L25.224|
0000c4  f7fffffe          BL       UART_EnableInt
;;;798    	NVIC_EnableIRQ(UART1_IRQn);
0000c8  200d              MOVS     r0,#0xd
0000ca  f7fffffe          BL       NVIC_EnableIRQ
;;;799    }
0000ce  b005              ADD      sp,sp,#0x14
0000d0  bdf0              POP      {r4-r7,pc}
;;;800    
                          ENDP

0000d2  0000              DCW      0x0000
                  |L25.212|
                          DCD      ||.constdata||+0x10
                  |L25.216|
                          DCD      0x04000011
                  |L25.220|
                          DCD      0x50000200
                  |L25.224|
                          DCD      0x40150000
                  |L25.228|
                          DCD      0xfff0ff0f
                  |L25.232|
                          DCD      0x0000ffff

                          AREA ||i.UART2_Init||, CODE, READONLY, ALIGN=2

                  UART2_Init PROC
;;;801    // Power Meter
;;;802    void UART2_Init(uint32_t u32baudrate)
000000  b5f0              PUSH     {r4-r7,lr}
;;;803    {
000002  b085              SUB      sp,sp,#0x14
000004  4604              MOV      r4,r0
;;;804      	uint8_t u8UartClkSrcSel, u8UartClkDivNum;
;;;805    	uint32_t u32ClkTbl[4] = {__HXT, 0, __LXT, __HIRC};
000006  4832              LDR      r0,|L26.208|
000008  4601              MOV      r1,r0
00000a  c90e              LDM      r1,{r1-r3}
00000c  68c0              LDR      r0,[r0,#0xc]  ; <Data3>
00000e  ad01              ADD      r5,sp,#4
000010  c50e              STM      r5!,{r1-r3}
000012  9004              STR      r0,[sp,#0x10]
;;;806    	uint32_t u32Baud_Div = 0;
000014  2700              MOVS     r7,#0
;;;807    	
;;;808    
;;;809    	/*---------------------------------------------------------------------------------------------------------*/
;;;810    	/* Init UART                                                                                               */
;;;811    	/*---------------------------------------------------------------------------------------------------------*/
;;;812    	/* Reset UART2 */
;;;813    	SYS_ResetModule(UART2_RST);
000016  482f              LDR      r0,|L26.212|
000018  f7fffffe          BL       SYS_ResetModule
;;;814    
;;;815    	/* Configure UART1 and set UART1 Baudrate */
;;;816    	//UART_Open(UART2, u32baudrate);
;;;817    #if 1
;;;818    	/* Get UART clock source selection */
;;;819    	u8UartClkSrcSel = (CLK->CLKSEL1 & CLK_CLKSEL1_UARTSEL_Msk) >> CLK_CLKSEL1_UARTSEL_Pos;
00001c  482e              LDR      r0,|L26.216|
00001e  6940              LDR      r0,[r0,#0x14]
000020  2103              MOVS     r1,#3
000022  0609              LSLS     r1,r1,#24
000024  4008              ANDS     r0,r0,r1
000026  0e05              LSRS     r5,r0,#24
;;;820    
;;;821    	/* Get UART clock divider number */
;;;822    	u8UartClkDivNum = (CLK->CLKDIV0 & CLK_CLKDIV0_UARTDIV_Msk) >> CLK_CLKDIV0_UARTDIV_Pos;
000028  482b              LDR      r0,|L26.216|
00002a  6980              LDR      r0,[r0,#0x18]
00002c  210f              MOVS     r1,#0xf
00002e  0209              LSLS     r1,r1,#8
000030  4008              ANDS     r0,r0,r1
000032  0a06              LSRS     r6,r0,#8
;;;823    
;;;824    	/* Select UART function */
;;;825    	//UART2->FUNCSEL = UART_FUNCSEL_UART;
;;;826    	/* Select UART RS485 function mode */
;;;827        	UART2->FUNCSEL = UART_FUNCSEL_RS485;
000034  2003              MOVS     r0,#3
000036  4929              LDR      r1,|L26.220|
000038  6308              STR      r0,[r1,#0x30]
;;;828    
;;;829        	/* Set RS485-Master as AUD mode */
;;;830        	/* Enable AUD mode to HW control RTS pin automatically */
;;;831        	/* It also can use GPIO to control RTS pin for replacing AUD mode */
;;;832        	UART2->ALTCTL = UART_ALTCTL_RS485AUD_Msk;
00003a  2001              MOVS     r0,#1
00003c  0280              LSLS     r0,r0,#10
00003e  62c8              STR      r0,[r1,#0x2c]
;;;833    
;;;834        	/* Set RTS pin active level as high level active */
;;;835        	UART2->MODEM = (UART2->MODEM & (~UART_MODEM_RTSACTLV_Msk)) | UART_RTS_IS_HIGH_LEV_ACTIVE;
000040  4608              MOV      r0,r1
000042  6900              LDR      r0,[r0,#0x10]
000044  1549              ASRS     r1,r1,#21
000046  4388              BICS     r0,r0,r1
000048  4924              LDR      r1,|L26.220|
00004a  6108              STR      r0,[r1,#0x10]
;;;836    
;;;837        	/* Set TX delay time */
;;;838        	UART2->TOUT = 0;
00004c  2000              MOVS     r0,#0
00004e  6208              STR      r0,[r1,#0x20]
;;;839    		
;;;840    	//UART_SelectRS485Mode(UART2,UART_ALTCTL_RS485AUD_Msk,0);
;;;841    
;;;842    	/* Set UART line configuration */
;;;843    	UART2->LINE = UART_WORD_LEN_8 | UART_PARITY_NONE | UART_STOP_BIT_1;
000050  2003              MOVS     r0,#3
000052  60c8              STR      r0,[r1,#0xc]
;;;844    
;;;845    	/* Set UART Rx and RTS trigger level */
;;;846    	UART2->FIFO &= ~(UART_FIFO_RFITL_Msk | UART_FIFO_RTSTRGLV_Msk);
000054  4608              MOV      r0,r1
000056  6880              LDR      r0,[r0,#8]
000058  4921              LDR      r1,|L26.224|
00005a  4008              ANDS     r0,r0,r1
00005c  491f              LDR      r1,|L26.220|
00005e  6088              STR      r0,[r1,#8]
;;;847    
;;;848    	/* Get PLL clock frequency if UART clock source selection is PLL */
;;;849    	if(u8UartClkSrcSel == 1)
000060  2d01              CMP      r5,#1
000062  d104              BNE      |L26.110|
;;;850    		u32ClkTbl[u8UartClkSrcSel] = CLK_GetPLLClockFreq();
000064  f7fffffe          BL       CLK_GetPLLClockFreq
000068  00a9              LSLS     r1,r5,#2
00006a  aa01              ADD      r2,sp,#4
00006c  5050              STR      r0,[r2,r1]
                  |L26.110|
;;;851    
;;;852    	/* Set UART baud rate */
;;;853    	if(u32baudrate != 0)
00006e  2c00              CMP      r4,#0
000070  d025              BEQ      |L26.190|
;;;854    	{
;;;855    		u32Baud_Div = UART_BAUD_MODE2_DIVIDER((u32ClkTbl[u8UartClkSrcSel]) / (u8UartClkDivNum + 1), u32baudrate);
000072  00a9              LSLS     r1,r5,#2
000074  aa01              ADD      r2,sp,#4
000076  5850              LDR      r0,[r2,r1]
000078  1c71              ADDS     r1,r6,#1
00007a  f7fffffe          BL       __aeabi_uidivmod
00007e  0861              LSRS     r1,r4,#1
000080  1840              ADDS     r0,r0,r1
000082  4621              MOV      r1,r4
000084  9000              STR      r0,[sp,#0]
000086  f7fffffe          BL       __aeabi_uidivmod
00008a  1e87              SUBS     r7,r0,#2
;;;856    
;;;857    		if(u32Baud_Div > 0xFFFF)
00008c  4815              LDR      r0,|L26.228|
00008e  4287              CMP      r7,r0
000090  d910              BLS      |L26.180|
;;;858    			UART2->BAUD = (UART_BAUD_MODE0 | UART_BAUD_MODE0_DIVIDER((u32ClkTbl[u8UartClkSrcSel]) / (u8UartClkDivNum + 1), u32baudrate));
000092  00a9              LSLS     r1,r5,#2
000094  aa01              ADD      r2,sp,#4
000096  5850              LDR      r0,[r2,r1]
000098  1c71              ADDS     r1,r6,#1
00009a  f7fffffe          BL       __aeabi_uidivmod
00009e  00e1              LSLS     r1,r4,#3
0000a0  1840              ADDS     r0,r0,r1
0000a2  4621              MOV      r1,r4
0000a4  9000              STR      r0,[sp,#0]
0000a6  f7fffffe          BL       __aeabi_uidivmod
0000aa  0900              LSRS     r0,r0,#4
0000ac  1e80              SUBS     r0,r0,#2
0000ae  490b              LDR      r1,|L26.220|
0000b0  6248              STR      r0,[r1,#0x24]
0000b2  e004              B        |L26.190|
                  |L26.180|
;;;859    		else
;;;860    			UART2->BAUD = (UART_BAUD_MODE2 | (u32Baud_Div));
0000b4  2003              MOVS     r0,#3
0000b6  0700              LSLS     r0,r0,#28
0000b8  4338              ORRS     r0,r0,r7
0000ba  4908              LDR      r1,|L26.220|
0000bc  6248              STR      r0,[r1,#0x24]
                  |L26.190|
;;;861        	}
;;;862    #endif 
;;;863    
;;;864    	/* Enable UART RDA and THRE interrupt */
;;;865    	//UART_EnableInt(UART2, (UART_INTEN_RDAIEN_Msk | UART_INTEN_THREIEN_Msk));
;;;866    	UART_EnableInt(UART2, (UART_INTEN_RDAIEN_Msk  ));
0000be  2101              MOVS     r1,#1
0000c0  4806              LDR      r0,|L26.220|
0000c2  f7fffffe          BL       UART_EnableInt
;;;867    	NVIC_EnableIRQ(UART02_IRQn);
0000c6  200c              MOVS     r0,#0xc
0000c8  f7fffffe          BL       NVIC_EnableIRQ
;;;868    }
0000cc  b005              ADD      sp,sp,#0x14
0000ce  bdf0              POP      {r4-r7,pc}
;;;869    
                          ENDP

                  |L26.208|
                          DCD      ||.constdata||+0x20
                  |L26.212|
                          DCD      0x04000012
                  |L26.216|
                          DCD      0x50000200
                  |L26.220|
                          DCD      0x40154000
                  |L26.224|
                          DCD      0xfff0ff0f
                  |L26.228|
                          DCD      0x0000ffff

                          AREA ||i.UART2_ReInitial||, CODE, READONLY, ALIGN=2

                  UART2_ReInitial PROC
;;;1015   // Power Meter
;;;1016   void UART2_ReInitial(uint32_t u32baudrate,int FregMix)
000000  b5f0              PUSH     {r4-r7,lr}
;;;1017   {
000002  b087              SUB      sp,sp,#0x1c
000004  4604              MOV      r4,r0
000006  460e              MOV      r6,r1
;;;1018     	uint8_t u8UartClkSrcSel, u8UartClkDivNum;
;;;1019   	uint32_t u32ClkTbl[4] = {__HXT, 0, __LXT, __HIRC};
000008  4829              LDR      r0,|L27.176|
00000a  4601              MOV      r1,r0
00000c  c90e              LDM      r1,{r1-r3}
00000e  68c0              LDR      r0,[r0,#0xc]  ; <Data4>
000010  ad03              ADD      r5,sp,#0xc
000012  c50e              STM      r5!,{r1-r3}
000014  9006              STR      r0,[sp,#0x18]
;;;1020   	uint32_t u32Baud_Div = 0;
000016  2000              MOVS     r0,#0
000018  9002              STR      r0,[sp,#8]
;;;1021   	
;;;1022   
;;;1023   	/*---------------------------------------------------------------------------------------------------------*/
;;;1024   	/* Init UART                                                                                               */
;;;1025   	/*---------------------------------------------------------------------------------------------------------*/
;;;1026   	/* Reset UART2 */
;;;1027   	SYS_ResetModule(UART2_RST);
00001a  4826              LDR      r0,|L27.180|
00001c  f7fffffe          BL       SYS_ResetModule
;;;1028   
;;;1029   	/* Configure UART1 and set UART1 Baudrate */
;;;1030   	//UART_Open(UART2, u32baudrate);
;;;1031   #if 1
;;;1032   	/* Get UART clock source selection */
;;;1033   	u8UartClkSrcSel = (CLK->CLKSEL1 & CLK_CLKSEL1_UARTSEL_Msk) >> CLK_CLKSEL1_UARTSEL_Pos;
000020  4825              LDR      r0,|L27.184|
000022  6940              LDR      r0,[r0,#0x14]
000024  2103              MOVS     r1,#3
000026  0609              LSLS     r1,r1,#24
000028  4008              ANDS     r0,r0,r1
00002a  0e05              LSRS     r5,r0,#24
;;;1034   
;;;1035   	/* Get UART clock divider number */
;;;1036   	u8UartClkDivNum = (CLK->CLKDIV0 & CLK_CLKDIV0_UARTDIV_Msk) >> CLK_CLKDIV0_UARTDIV_Pos;
00002c  4822              LDR      r0,|L27.184|
00002e  6980              LDR      r0,[r0,#0x18]
000030  210f              MOVS     r1,#0xf
000032  0209              LSLS     r1,r1,#8
000034  4008              ANDS     r0,r0,r1
000036  0a07              LSRS     r7,r0,#8
;;;1037   
;;;1038   	/* Get PLL clock frequency if UART clock source selection is PLL */
;;;1039   	if(u8UartClkSrcSel == 1)
000038  2d01              CMP      r5,#1
00003a  d104              BNE      |L27.70|
;;;1040   		u32ClkTbl[u8UartClkSrcSel] = CLK_GetPLLClockFreq();
00003c  f7fffffe          BL       CLK_GetPLLClockFreq
000040  00a9              LSLS     r1,r5,#2
000042  aa03              ADD      r2,sp,#0xc
000044  5050              STR      r0,[r2,r1]
                  |L27.70|
;;;1041   
;;;1042   	/* Set UART baud rate */
;;;1043   	if(u32baudrate != 0)
000046  2c00              CMP      r4,#0
000048  d029              BEQ      |L27.158|
;;;1044   	{
;;;1045   		u32Baud_Div = UART_BAUD_MODE2_DIVIDER((u32ClkTbl[u8UartClkSrcSel]) / (u8UartClkDivNum + 1), u32baudrate);
00004a  00a9              LSLS     r1,r5,#2
00004c  aa03              ADD      r2,sp,#0xc
00004e  5850              LDR      r0,[r2,r1]
000050  1c79              ADDS     r1,r7,#1
000052  f7fffffe          BL       __aeabi_uidivmod
000056  0861              LSRS     r1,r4,#1
000058  1840              ADDS     r0,r0,r1
00005a  4621              MOV      r1,r4
00005c  9001              STR      r0,[sp,#4]
00005e  f7fffffe          BL       __aeabi_uidivmod
000062  1e80              SUBS     r0,r0,#2
000064  9002              STR      r0,[sp,#8]
;;;1046   
;;;1047   		if(u32Baud_Div > 0xFFFF)
000066  4915              LDR      r1,|L27.188|
000068  9802              LDR      r0,[sp,#8]
00006a  4288              CMP      r0,r1
00006c  d910              BLS      |L27.144|
;;;1048   			UART2->BAUD = (UART_BAUD_MODE0 | UART_BAUD_MODE0_DIVIDER((u32ClkTbl[u8UartClkSrcSel]) / (u8UartClkDivNum + 1), u32baudrate));
00006e  00a9              LSLS     r1,r5,#2
000070  aa03              ADD      r2,sp,#0xc
000072  5850              LDR      r0,[r2,r1]
000074  1c79              ADDS     r1,r7,#1
000076  f7fffffe          BL       __aeabi_uidivmod
00007a  00e1              LSLS     r1,r4,#3
00007c  1840              ADDS     r0,r0,r1
00007e  4621              MOV      r1,r4
000080  9001              STR      r0,[sp,#4]
000082  f7fffffe          BL       __aeabi_uidivmod
000086  0900              LSRS     r0,r0,#4
000088  1e80              SUBS     r0,r0,#2
00008a  490d              LDR      r1,|L27.192|
00008c  6248              STR      r0,[r1,#0x24]
00008e  e006              B        |L27.158|
                  |L27.144|
;;;1049   		else
;;;1050   			UART2->BAUD = (UART_BAUD_MODE2 | (u32Baud_Div-FregMix));
000090  9802              LDR      r0,[sp,#8]
000092  1b80              SUBS     r0,r0,r6
000094  2103              MOVS     r1,#3
000096  0709              LSLS     r1,r1,#28
000098  4308              ORRS     r0,r0,r1
00009a  4909              LDR      r1,|L27.192|
00009c  6248              STR      r0,[r1,#0x24]
                  |L27.158|
;;;1051       	}
;;;1052   #endif 
;;;1053   
;;;1054   	/* Enable UART RDA and THRE interrupt */
;;;1055   	//UART_EnableInt(UART2, (UART_INTEN_RDAIEN_Msk | UART_INTEN_THREIEN_Msk));
;;;1056   	UART_EnableInt(UART2, (UART_INTEN_RDAIEN_Msk  ));
00009e  2101              MOVS     r1,#1
0000a0  4807              LDR      r0,|L27.192|
0000a2  f7fffffe          BL       UART_EnableInt
;;;1057   	NVIC_EnableIRQ(UART02_IRQn);
0000a6  200c              MOVS     r0,#0xc
0000a8  f7fffffe          BL       NVIC_EnableIRQ
;;;1058   }
0000ac  b007              ADD      sp,sp,#0x1c
0000ae  bdf0              POP      {r4-r7,pc}
;;;1059   
                          ENDP

                  |L27.176|
                          DCD      ||.constdata||+0x30
                  |L27.180|
                          DCD      0x04000012
                  |L27.184|
                          DCD      0x50000200
                  |L27.188|
                          DCD      0x0000ffff
                  |L27.192|
                          DCD      0x40154000

                          AREA ||i.WDT_IRQHandler||, CODE, READONLY, ALIGN=2

                  WDT_IRQHandler PROC
;;;334     */
;;;335    void WDT_IRQHandler(void)
000000  4816              LDR      r0,|L28.92|
;;;336    {
;;;337        if(g_u32WDTINTCounts < 10)
000002  6800              LDR      r0,[r0,#0]  ; g_u32WDTINTCounts
000004  280a              CMP      r0,#0xa
000006  d202              BCS      |L28.14|
;;;338            WDT_RESET_COUNTER();
000008  4815              LDR      r0,|L28.96|
00000a  4916              LDR      r1,|L28.100|
00000c  6088              STR      r0,[r1,#8]
                  |L28.14|
;;;339    
;;;340        if(WDT_GET_TIMEOUT_INT_FLAG() == 1)
00000e  4815              LDR      r0,|L28.100|
000010  6800              LDR      r0,[r0,#0]
000012  2108              MOVS     r1,#8
000014  4008              ANDS     r0,r0,r1
000016  08c0              LSRS     r0,r0,#3
000018  2800              CMP      r0,#0
00001a  d00c              BEQ      |L28.54|
;;;341        {
;;;342            /* Clear WDT time-out interrupt flag */
;;;343            WDT_CLEAR_TIMEOUT_INT_FLAG();
00001c  4811              LDR      r0,|L28.100|
00001e  6800              LDR      r0,[r0,#0]
000020  2124              MOVS     r1,#0x24
000022  4388              BICS     r0,r0,r1
000024  2108              MOVS     r1,#8
000026  4308              ORRS     r0,r0,r1
000028  490e              LDR      r1,|L28.100|
00002a  6008              STR      r0,[r1,#0]
;;;344    
;;;345            g_u32WDTINTCounts++;
00002c  480b              LDR      r0,|L28.92|
00002e  6800              LDR      r0,[r0,#0]  ; g_u32WDTINTCounts
000030  1c40              ADDS     r0,r0,#1
000032  490a              LDR      r1,|L28.92|
000034  6008              STR      r0,[r1,#0]  ; g_u32WDTINTCounts
                  |L28.54|
;;;346        }
;;;347    
;;;348        if(WDT_GET_TIMEOUT_WAKEUP_FLAG() == 1)
000036  480b              LDR      r0,|L28.100|
000038  6800              LDR      r0,[r0,#0]
00003a  2120              MOVS     r1,#0x20
00003c  4008              ANDS     r0,r0,r1
00003e  0940              LSRS     r0,r0,#5
000040  2800              CMP      r0,#0
000042  d00a              BEQ      |L28.90|
;;;349        {
;;;350            /* Clear WDT time-out wake-up flag */
;;;351            WDT_CLEAR_TIMEOUT_WAKEUP_FLAG();
000044  4807              LDR      r0,|L28.100|
000046  6800              LDR      r0,[r0,#0]
000048  210c              MOVS     r1,#0xc
00004a  4388              BICS     r0,r0,r1
00004c  2120              MOVS     r1,#0x20
00004e  4308              ORRS     r0,r0,r1
000050  4904              LDR      r1,|L28.100|
000052  6008              STR      r0,[r1,#0]
;;;352    
;;;353            g_u8IsWDTWakeupINT = 1;
000054  2001              MOVS     r0,#1
000056  4904              LDR      r1,|L28.104|
000058  7008              STRB     r0,[r1,#0]
                  |L28.90|
;;;354        }
;;;355    }
00005a  4770              BX       lr
;;;356    /*---------------------------------------------------------------------------------------------------------*/
                          ENDP

                  |L28.92|
                          DCD      g_u32WDTINTCounts
                  |L28.96|
                          DCD      0x00005aa5
                  |L28.100|
                          DCD      0x40004000
                  |L28.104|
                          DCD      g_u8IsWDTWakeupINT

                          AREA ||i.WriteUserInfoToEE||, CODE, READONLY, ALIGN=1

                  WriteUserInfoToEE PROC
;;;1447   
;;;1448   void WriteUserInfoToEE(void)
000000  2200              MOVS     r2,#0
;;;1449   {
;;;1450   	uint8_t i,j,addrC;
;;;1451   	// gJd
;;;1452   	addrC=0;
;;;1453   	for(i=0;i<MEMBER_MAX_NO;i++)
000002  2000              MOVS     r0,#0
000004  e009              B        |L29.26|
                  |L29.6|
;;;1454   	{
;;;1455   		for(j=0;j<4;j++)
000006  2100              MOVS     r1,#0
000008  e003              B        |L29.18|
                  |L29.10|
;;;1456   		{
;;;1457   			//soft_i2c_eeprom_write_byte(EEPROM_ADDR, EE_ADDR_USER_UID+addrC, Members[i].UID[j] );
;;;1458   			addrC++;
00000a  1c53              ADDS     r3,r2,#1
00000c  b2da              UXTB     r2,r3
00000e  1c4b              ADDS     r3,r1,#1              ;1455
000010  b2d9              UXTB     r1,r3                 ;1455
                  |L29.18|
000012  2904              CMP      r1,#4                 ;1455
000014  dbf9              BLT      |L29.10|
000016  1c43              ADDS     r3,r0,#1              ;1453
000018  b2d8              UXTB     r0,r3                 ;1453
                  |L29.26|
00001a  2802              CMP      r0,#2                 ;1453
00001c  dbf3              BLT      |L29.6|
;;;1459   		}
;;;1460   	}
;;;1461   	// gJ
;;;1462   	addrC=0;
00001e  2200              MOVS     r2,#0
;;;1463   	for(i=0;i<MEMBER_MAX_NO;i++)
000020  2000              MOVS     r0,#0
000022  e009              B        |L29.56|
                  |L29.36|
;;;1464   	{
;;;1465   		for(j=0;j<5;j++)
000024  2100              MOVS     r1,#0
000026  e003              B        |L29.48|
                  |L29.40|
;;;1466   		{
;;;1467   			//soft_i2c_eeprom_write_byte(EEPROM_ADDR, EE_ADDR_STUDENT_ID+addrC, Members[i].SID[j] );
;;;1468   			addrC++;
000028  1c53              ADDS     r3,r2,#1
00002a  b2da              UXTB     r2,r3
00002c  1c4b              ADDS     r3,r1,#1              ;1465
00002e  b2d9              UXTB     r1,r3                 ;1465
                  |L29.48|
000030  2905              CMP      r1,#5                 ;1465
000032  dbf9              BLT      |L29.40|
000034  1c43              ADDS     r3,r0,#1              ;1463
000036  b2d8              UXTB     r0,r3                 ;1463
                  |L29.56|
000038  2802              CMP      r0,#2                 ;1463
00003a  dbf3              BLT      |L29.36|
;;;1469   		}
;;;1470   	}
;;;1471   }
00003c  4770              BX       lr
;;;1472   
                          ENDP


                          AREA ||i.main||, CODE, READONLY, ALIGN=2

                  main PROC
;;;1061   
;;;1062   int main()
000000  f7fffffe          BL       AO2022_MeterModule_1261_init
;;;1063   {
;;;1064     	uint8_t i,j;
;;;1065   
;;;1066   	AO2022_MeterModule_1261_init();
;;;1067   	
;;;1068   
;;;1069   	/* Unlock protected registers */
;;;1070   	SYS_UnlockReg();
000004  f7fffffe          BL       SYS_UnlockReg
;;;1071   
;;;1072   	SYS_Init();
000008  f7fffffe          BL       SYS_Init
;;;1073   
;;;1074   	/* Lock protected registers */
;;;1075   	SYS_LockReg();
00000c  bf00              NOP      
00000e  2000              MOVS     r0,#0
000010  497f              LDR      r1,|L30.528|
000012  6008              STR      r0,[r1,#0]
000014  bf00              NOP      
;;;1076   
;;;1077   		
;;;1078   	/* To check if system has been reset by WDT time-out reset or not */
;;;1079   	//if(WDT_GET_RESET_FLAG() == 1)
;;;1080   	//{
;;;1081   		//WDT_CLEAR_RESET_FLAG();
;;;1082   		//printf("*** System has been reset by WDT time-out event ***\n\n");
;;;1083   		//while(1);
;;;1084   	//}
;;;1085   	/* Enable WDT NVIC */
;;;1086   	//NVIC_EnableIRQ(WDT_IRQn);
;;;1087   
;;;1088   	/* Because of all bits can be written in WDT Control Register are write-protected;
;;;1089   	To program it needs to disable register protection first. */
;;;1090   	SYS_UnlockReg();
000016  f7fffffe          BL       SYS_UnlockReg
;;;1091   
;;;1092   	/* Configure WDT settings and start WDT counting */
;;;1093   	//g_u32WDTINTCounts = g_u8IsWDTWakeupINT = 0;
;;;1094   	//WDT_Open(WDT_TIMEOUT_2POW14, WDT_RESET_DELAY_1026CLK, TRUE, TRUE);
;;;1095   
;;;1096   	/* Enable WDT interrupt function */
;;;1097   	//WDT_EnableInt();
;;;1098   		
;;;1099   	GPIO_Mode_Init();
00001a  f7fffffe          BL       GPIO_Mode_Init
;;;1100   	ROOM_POWER_On();
00001e  f7fffffe          BL       ROOM_POWER_On
;;;1101   	//DIR_READER_RS485_In();
;;;1102   	//DIR_METER_RS485_In();
;;;1103   	
;;;1104   	u32_RSTScr = SYS_GetResetSrc();
000022  f7fffffe          BL       SYS_GetResetSrc
000026  497b              LDR      r1,|L30.532|
000028  6008              STR      r0,[r1,#0]  ; u32_RSTScr
;;;1105   	if ( (u32_RSTScr & (SYS_RSTSTS_WDTRF_Msk | SYS_RSTSTS_PINRF_Msk | SYS_RSTSTS_CPURF_Msk | SYS_RSTSTS_CPULKRF_Msk)) > 0 )
00002a  4608              MOV      r0,r1
00002c  6800              LDR      r0,[r0,#0]  ; u32_RSTScr
00002e  21ff              MOVS     r1,#0xff
000030  3187              ADDS     r1,r1,#0x87
000032  4008              ANDS     r0,r0,r1
000034  2800              CMP      r0,#0
000036  d003              BEQ      |L30.64|
;;;1106   	{
;;;1107   		// INIT. METER
;;;1108   		//fgWaitInitFromCenter = 1 ;
;;;1109   		
;;;1110   		SYS->RSTSTS = 0 ;
000038  2000              MOVS     r0,#0
00003a  2105              MOVS     r1,#5
00003c  0709              LSLS     r1,r1,#28
00003e  6048              STR      r0,[r1,#4]
                  |L30.64|
;;;1111   		
;;;1112   	}
;;;1113   	fgFirstStart=1;
000040  2001              MOVS     r0,#1
000042  4975              LDR      r1,|L30.536|
000044  7008              STRB     r0,[r1,#0]
;;;1114   	
;;;1115   	ROOM_POWER_On();
000046  f7fffffe          BL       ROOM_POWER_On
;;;1116   	//RELAY2_High();
;;;1117   	//RELAY1_High();		// ROOM POWER ON 
;;;1118   	LED_G_On();
00004a  2000              MOVS     r0,#0
00004c  4973              LDR      r1,|L30.540|
00004e  61c8              STR      r0,[r1,#0x1c]
;;;1119   	LED_G_Off();
000050  2001              MOVS     r0,#1
000052  61c8              STR      r0,[r1,#0x1c]
;;;1120   	LED_R_On();
000054  2000              MOVS     r0,#0
000056  4971              LDR      r1,|L30.540|
000058  3180              ADDS     r1,r1,#0x80
00005a  6088              STR      r0,[r1,#8]
;;;1121   	LED_R_Off();
00005c  2001              MOVS     r0,#1
00005e  6088              STR      r0,[r1,#8]
;;;1122   	LED_G1_On();
000060  2000              MOVS     r0,#0
000062  496e              LDR      r1,|L30.540|
000064  3140              ADDS     r1,r1,#0x40
000066  6008              STR      r0,[r1,#0]
;;;1123   	LED_G1_Off();
000068  2001              MOVS     r0,#1
00006a  6008              STR      r0,[r1,#0]
;;;1124   	LED_R1_On();
00006c  2000              MOVS     r0,#0
00006e  496b              LDR      r1,|L30.540|
000070  3940              SUBS     r1,r1,#0x40
000072  6108              STR      r0,[r1,#0x10]
;;;1125   	LED_R1_Off();
000074  2001              MOVS     r0,#1
000076  6108              STR      r0,[r1,#0x10]
;;;1126   	//READER_POWER_Off();
;;;1127   	READER_POWER_On();
000078  4968              LDR      r1,|L30.540|
00007a  60c8              STR      r0,[r1,#0xc]
;;;1128   	
;;;1129   	SysTick_Config(PLL_CLOCK/2/100);
00007c  4e68              LDR      r6,|L30.544|
00007e  1e70              SUBS     r0,r6,#1
000080  4968              LDR      r1,|L30.548|
000082  4288              CMP      r0,r1
000084  d900              BLS      |L30.136|
000086  e00c              B        |L30.162|
                  |L30.136|
000088  1e70              SUBS     r0,r6,#1
00008a  4967              LDR      r1,|L30.552|
00008c  6148              STR      r0,[r1,#0x14]
00008e  2103              MOVS     r1,#3
000090  1f08              SUBS     r0,r1,#4
000092  f7fffffe          BL       NVIC_SetPriority
000096  2000              MOVS     r0,#0
000098  4963              LDR      r1,|L30.552|
00009a  6188              STR      r0,[r1,#0x18]
00009c  2007              MOVS     r0,#7
00009e  6108              STR      r0,[r1,#0x10]
0000a0  bf00              NOP      
                  |L30.162|
;;;1130   	NVIC_EnableIRQ(SysTick_IRQn);
0000a2  2000              MOVS     r0,#0
0000a4  43c0              MVNS     r0,r0
0000a6  f7fffffe          BL       NVIC_EnableIRQ
;;;1131   	 
;;;1132   	UART0_Init();
0000aa  f7fffffe          BL       UART0_Init
;;;1133   	UART1_Init();
0000ae  f7fffffe          BL       UART1_Init
;;;1134       
;;;1135   #define B9600
;;;1136   #ifdef B9600
;;;1137   	UART2_Init(9600);
0000b2  204b              MOVS     r0,#0x4b
0000b4  01c0              LSLS     r0,r0,#7
0000b6  f7fffffe          BL       UART2_Init
;;;1138   #endif 
;;;1139   #ifdef B2400
;;;1140   	UART2_Init(2400);
;;;1141   #endif 
;;;1142     
;;;1143   	DisableHostUartTx();
0000ba  f7fffffe          BL       DisableHostUartTx
;;;1144   	NVIC_EnableIRQ(UART1_IRQn);
0000be  200d              MOVS     r0,#0xd
0000c0  f7fffffe          BL       NVIC_EnableIRQ
;;;1145   	NVIC_EnableIRQ(UART02_IRQn);
0000c4  200c              MOVS     r0,#0xc
0000c6  f7fffffe          BL       NVIC_EnableIRQ
;;;1146   /*
;;;1147   	for(i=0;i<10;i++)
;;;1148   		HostTxBuffer[i] = i +0x30 ;
;;;1149   	//EnableHostUartTx();
;;;1150   	_SendStringToHOST(HostTxBuffer,10);
;;;1151   
;;;1152   */	
;;;1153   	
;;;1154   	SoftI2cMasterInit();
0000ca  f7fffffe          BL       SoftI2cMasterInit
;;;1155   	//TestI2C_RWEEPROM();
;;;1156   	//SendReader_Alive();
;;;1157   	//while(1);
;;;1158   	
;;;1159   	//for(i=0;i<10;i++)
;;;1160   		//ReaderTxBuffer[i] = i +0x30 ;
;;;1161   	//DIR_READER_RS485_Out();
;;;1162   	//_SendStringToREADER(ReaderTxBuffer,10);
;;;1163   	
;;;1164       //MaxPowerMeter = MAX_POWER_METER ;
;;;1165       MaxPowerMeter = 1 ;
0000ce  2001              MOVS     r0,#1
0000d0  4956              LDR      r1,|L30.556|
0000d2  7008              STRB     r0,[r1,#0]
;;;1166   
;;;1167       for (i=0;i<MAX_POWER_METER;i++)
0000d4  2400              MOVS     r4,#0
0000d6  e01f              B        |L30.280|
                  |L30.216|
;;;1168       {
;;;1169           LastRoomMode[i]= RM_POWER_OFF_READY;
0000d8  2001              MOVS     r0,#1
0000da  4955              LDR      r1,|L30.560|
0000dc  5508              STRB     r0,[r1,r4]
;;;1170           RoomMode[i]= RM_POWER_OFF_READY;
0000de  4955              LDR      r1,|L30.564|
0000e0  5508              STRB     r0,[r1,r4]
;;;1171           MeterData[i].PayMode = 0x01;
0000e2  2101              MOVS     r1,#1
0000e4  2024              MOVS     r0,#0x24
0000e6  4360              MULS     r0,r4,r0
0000e8  4a53              LDR      r2,|L30.568|
0000ea  1880              ADDS     r0,r0,r2
0000ec  7041              STRB     r1,[r0,#1]
;;;1172           for ( j=0;j<12;j++)
0000ee  2500              MOVS     r5,#0
0000f0  e00e              B        |L30.272|
                  |L30.242|
;;;1173           {
;;;1174               MeterErrorRate5Min_Tx[i][j]=1;
0000f2  2101              MOVS     r1,#1
0000f4  2018              MOVS     r0,#0x18
0000f6  4360              MULS     r0,r4,r0
0000f8  4a50              LDR      r2,|L30.572|
0000fa  1880              ADDS     r0,r0,r2
0000fc  006a              LSLS     r2,r5,#1
0000fe  5281              STRH     r1,[r0,r2]
;;;1175               MeterErrorRate5Min_Rx[i][j]=1;
000100  2018              MOVS     r0,#0x18
000102  4360              MULS     r0,r4,r0
000104  4a4e              LDR      r2,|L30.576|
000106  1880              ADDS     r0,r0,r2
000108  006a              LSLS     r2,r5,#1
00010a  5281              STRH     r1,[r0,r2]
00010c  1c68              ADDS     r0,r5,#1              ;1172
00010e  b2c5              UXTB     r5,r0                 ;1172
                  |L30.272|
000110  2d0c              CMP      r5,#0xc               ;1172
000112  dbee              BLT      |L30.242|
000114  1c60              ADDS     r0,r4,#1              ;1167
000116  b2c4              UXTB     r4,r0                 ;1167
                  |L30.280|
000118  2c1f              CMP      r4,#0x1f              ;1167
00011a  dbdd              BLT      |L30.216|
;;;1176           }
;;;1177       }
;;;1178       
;;;1179       MeterErrorRate5Min_Wp = 0 ;
00011c  2000              MOVS     r0,#0
00011e  4949              LDR      r1,|L30.580|
000120  7008              STRB     r0,[r1,#0]
;;;1180       PowerMeterID = 0x01 ;	
000122  2001              MOVS     r0,#1
000124  4948              LDR      r1,|L30.584|
000126  7008              STRB     r0,[r1,#0]
;;;1181   	
;;;1182   #ifdef METER_TEST 
;;;1183   	MeterValueTest = 10000 ;
;;;1184   #endif 	 	
;;;1185   	
;;;1186   	ReadMyMeterID();
000128  f7fffffe          BL       ReadMyMeterID
;;;1187   	u32TimeTick2=0;  
00012c  2000              MOVS     r0,#0
00012e  4947              LDR      r1,|L30.588|
000130  6008              STR      r0,[r1,#0]  ; u32TimeTick2
;;;1188   	// Delay for System stable
;;;1189   	do {
000132  bf00              NOP      
                  |L30.308|
;;;1190   		SystemTick = 0 ;		
000134  2000              MOVS     r0,#0
000136  4946              LDR      r1,|L30.592|
000138  8008              STRH     r0,[r1,#0]
;;;1191   	} while( u32TimeTick2 < 75 ); 
00013a  4844              LDR      r0,|L30.588|
00013c  6800              LDR      r0,[r0,#0]  ; u32TimeTick2
00013e  284b              CMP      r0,#0x4b
000140  d3f8              BCC      |L30.308|
;;;1192   		
;;;1193   	SoftI2cMasterInit();
000142  f7fffffe          BL       SoftI2cMasterInit
;;;1194       
;;;1195       ReadMyMeterID();	
000146  f7fffffe          BL       ReadMyMeterID
;;;1196       RoomData.RoomMode = RM_FREE_MODE_READY ;	
00014a  2003              MOVS     r0,#3
00014c  4941              LDR      r1,|L30.596|
00014e  7048              STRB     r0,[r1,#1]
;;;1197       fgToReaderRSPFlag = 0xFF;
000150  20ff              MOVS     r0,#0xff
000152  4941              LDR      r1,|L30.600|
000154  7008              STRB     r0,[r1,#0]
;;;1198       fgToHostRSPFlag = 0xFF ;	        
000156  4941              LDR      r1,|L30.604|
000158  7008              STRB     r0,[r1,#0]
;;;1199       MeterActive = 0x01 ;
00015a  2001              MOVS     r0,#1
00015c  4940              LDR      r1,|L30.608|
00015e  7008              STRB     r0,[r1,#0]
;;;1200       PowerMeterError = 0x7FFFFFFF;
000160  4840              LDR      r0,|L30.612|
000162  4941              LDR      r1,|L30.616|
000164  6008              STR      r0,[r1,#0]  ; PowerMeterError
;;;1201   // Initial default 
;;;1202   #if 0
;;;1203   	SystemTick = 0 ;
;;;1204   	DefaultValueTest();
;;;1205   	MeterPowerValue_Now = 0 ;
;;;1206   	
;;;1207   	
;;;1208   #endif 	
;;;1209   
;;;1210   
;;;1211   SystemTick = 0 ;
000166  2000              MOVS     r0,#0
000168  4939              LDR      r1,|L30.592|
00016a  8008              STRH     r0,[r1,#0]
;;;1212   	
;;;1213   //#define TEST_EEPROM	1
;;;1214   
;;;1215   #ifdef TEST_EEPROM
;;;1216   #define TEST_EE_ADDR 0x0000
;;;1217   	TestEEPROM();	
;;;1218   #endif 
;;;1219   	
;;;1220   	SystemTick = 0 ;	
00016c  8008              STRH     r0,[r1,#0]
;;;1221   	
;;;1222   	ReadMyMeterID();
00016e  f7fffffe          BL       ReadMyMeterID
;;;1223   		
;;;1224           DisableHostUartTx();
000172  f7fffffe          BL       DisableHostUartTx
;;;1225   	fgDIR485_Reader=0;			
000176  2000              MOVS     r0,#0
000178  493c              LDR      r1,|L30.620|
00017a  7008              STRB     r0,[r1,#0]
;;;1226   	//DIR485_READER_In();
;;;1227   	//LastMeterPower[0] = MeterPowerValue_Now ;
;;;1228   	
;;;1229   	ReaderPollingState = PL_STATUS ;
00017c  2001              MOVS     r0,#1
00017e  493c              LDR      r1,|L30.624|
000180  7008              STRB     r0,[r1,#0]
;;;1230   	u32TimeTick2=0;   
000182  2000              MOVS     r0,#0
000184  4931              LDR      r1,|L30.588|
000186  6008              STR      r0,[r1,#0]  ; u32TimeTick2
;;;1231   	bRegister = 1 ;
000188  2001              MOVS     r0,#1
00018a  493a              LDR      r1,|L30.628|
00018c  7008              STRB     r0,[r1,#0]
;;;1232   	fgToReaderFlag = 0x40 ;
00018e  2040              MOVS     r0,#0x40
000190  4939              LDR      r1,|L30.632|
000192  7008              STRB     r0,[r1,#0]
;;;1233   	PollingMeterID = 0x01 ;
000194  2001              MOVS     r0,#1
000196  4939              LDR      r1,|L30.636|
000198  7008              STRB     r0,[r1,#0]
;;;1234   	
;;;1235   	DelayTick=0;
00019a  2000              MOVS     r0,#0
00019c  4938              LDR      r1,|L30.640|
00019e  8008              STRH     r0,[r1,#0]
;;;1236   	
;;;1237   	MeterType = CIC_BAW2A ; 	// For DongHwa , Meter is 0x01 (DAE DEM530)	
0001a0  2002              MOVS     r0,#2
0001a2  4938              LDR      r1,|L30.644|
0001a4  7008              STRB     r0,[r1,#0]
;;;1238   	ModBusCommand = MBCMD_EXIT_TEST ;
0001a6  2008              MOVS     r0,#8
0001a8  4937              LDR      r1,|L30.648|
0001aa  7008              STRB     r0,[r1,#0]
;;;1239   	TickReadPowerTime = ReadMeterTime ;	
0001ac  4837              LDR      r0,|L30.652|
0001ae  8800              LDRH     r0,[r0,#0]  ; ReadMeterTime
0001b0  4937              LDR      r1,|L30.656|
0001b2  8008              STRH     r0,[r1,#0]
;;;1240   	fgButton2High = 0 ;	
0001b4  2000              MOVS     r0,#0
0001b6  4937              LDR      r1,|L30.660|
0001b8  7008              STRB     r0,[r1,#0]
;;;1241   	MeterPollingState = MP_READY;
0001ba  4937              LDR      r1,|L30.664|
0001bc  7008              STRB     r0,[r1,#0]
;;;1242   	TickReadPowerTime = 0 ;
0001be  4934              LDR      r1,|L30.656|
0001c0  8008              STRH     r0,[r1,#0]
;;;1243   	PowerOnReadMeter = 1 ;
0001c2  2001              MOVS     r0,#1
0001c4  4935              LDR      r1,|L30.668|
0001c6  7008              STRB     r0,[r1,#0]
;;;1244   	ReadMeterTime = 5 ;	 	// Reading Power Meter per 5 x 20 mSec	
0001c8  2005              MOVS     r0,#5
0001ca  4930              LDR      r1,|L30.652|
0001cc  8008              STRH     r0,[r1,#0]
;;;1245   
;;;1246   #ifdef METER_TEST 
;;;1247   	MeterValueTest = 10000 ;
;;;1248   #endif 
;;;1249           
;;;1250            RoomData.Status = 0x07 ;
0001ce  2007              MOVS     r0,#7
0001d0  4920              LDR      r1,|L30.596|
0001d2  7008              STRB     r0,[r1,#0]
;;;1251    // } 2.5 Sec qPBCenter
;;;1252   	
;;;1253   	ReadMeterTime = 40 ;	 	// Reading Power Meter per 40 x 20 mSec
0001d4  2028              MOVS     r0,#0x28
0001d6  492d              LDR      r1,|L30.652|
0001d8  8008              STRH     r0,[r1,#0]
;;;1254   	//LastMeterPower[0] = MeterPowerValue_Now ;
;;;1255           Tick1S_DoubleCheckRoomMode = 0 ;    
0001da  2000              MOVS     r0,#0
0001dc  4930              LDR      r1,|L30.672|
0001de  7008              STRB     r0,[r1,#0]
;;;1256           
;;;1257   	// Main Loop ~ 
;;;1258       do {
0001e0  bf00              NOP      
                  |L30.482|
;;;1259           //RoomData.RoomMode = RM_POWER_OFF_READY ;
;;;1260           SystemTick = 0 ;					// Clear System S/W watchdog 		
0001e2  2000              MOVS     r0,#0
0001e4  491a              LDR      r1,|L30.592|
0001e6  8008              STRH     r0,[r1,#0]
;;;1261           MeterProcess();
0001e8  f7fffffe          BL       MeterProcess
;;;1262           MeterPolling();
0001ec  f7fffffe          BL       MeterPolling
;;;1263           ReadMyMeterID();				
0001f0  f7fffffe          BL       ReadMyMeterID
;;;1264           HostProcess();		
0001f4  f7fffffe          BL       HostProcess
;;;1265           SystemTick = 0 ;				
0001f8  2000              MOVS     r0,#0
0001fa  4915              LDR      r1,|L30.592|
0001fc  8008              STRH     r0,[r1,#0]
;;;1266           ChangeRS485Direct();		
0001fe  f7fffffe          BL       ChangeRS485Direct
;;;1267           //SaveSetting2EE();							
;;;1268           RecoverSystemMoniter();				
000202  f7fffffe          BL       RecoverSystemMoniter
;;;1269           CalErrorRate();
000206  f7fffffe          BL       CalErrorRate
;;;1270           CheckRoomMode();
00020a  f7fffffe          BL       CheckRoomMode
;;;1271       } while (1); 
00020e  e7e8              B        |L30.482|
;;;1272   }
;;;1273   void CheckRoomMode(void)
                          ENDP

                  |L30.528|
                          DCD      0x50000100
                  |L30.532|
                          DCD      u32_RSTScr
                  |L30.536|
                          DCD      fgFirstStart
                  |L30.540|
                          DCD      0x500042c0
                  |L30.544|
                          DCD      0x00057e40
                  |L30.548|
                          DCD      0x00ffffff
                  |L30.552|
                          DCD      0xe000e000
                  |L30.556|
                          DCD      MaxPowerMeter
                  |L30.560|
                          DCD      LastRoomMode
                  |L30.564|
                          DCD      RoomMode
                  |L30.568|
                          DCD      MeterData
                  |L30.572|
                          DCD      MeterErrorRate5Min_Tx
                  |L30.576|
                          DCD      MeterErrorRate5Min_Rx
                  |L30.580|
                          DCD      MeterErrorRate5Min_Wp
                  |L30.584|
                          DCD      PowerMeterID
                  |L30.588|
                          DCD      u32TimeTick2
                  |L30.592|
                          DCD      SystemTick
                  |L30.596|
                          DCD      RoomData
                  |L30.600|
                          DCD      fgToReaderRSPFlag
                  |L30.604|
                          DCD      fgToHostRSPFlag
                  |L30.608|
                          DCD      MeterActive
                  |L30.612|
                          DCD      0x7fffffff
                  |L30.616|
                          DCD      PowerMeterError
                  |L30.620|
                          DCD      fgDIR485_Reader
                  |L30.624|
                          DCD      ReaderPollingState
                  |L30.628|
                          DCD      bRegister
                  |L30.632|
                          DCD      fgToReaderFlag
                  |L30.636|
                          DCD      PollingMeterID
                  |L30.640|
                          DCD      DelayTick
                  |L30.644|
                          DCD      MeterType
                  |L30.648|
                          DCD      ModBusCommand
                  |L30.652|
                          DCD      ReadMeterTime
                  |L30.656|
                          DCD      TickReadPowerTime
                  |L30.660|
                          DCD      fgButton2High
                  |L30.664|
                          DCD      MeterPollingState
                  |L30.668|
                          DCD      PowerOnReadMeter
                  |L30.672|
                          DCD      Tick1S_DoubleCheckRoomMode

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  LastRoomMode
                          %        32
                  MeterData
                          %        1116
                  RoomMode
                          %        31
                  MeterErrorRate
                          %        31
                  MeterErrorRate_Tx
                          %        62
                  MeterErrorRate_Rx
                          %        62
                  ReaderTxBuffer
                          %        100
                  HostTxBuffer
                          %        100
                  TokenHost
                          %        100
                  TokenReader
                          %        100
                  MeterTxBuffer
                          %        25
                  TokenMeter
                          %        25
                  HOSTTxQ
                          %        100
                  HOSTRxQ
                          %        100
                  READERTxQ
                          %        100
                  READERRxQ
                          %        100
                  METERRxQ
                          %        16
                  METERTxQ
                          %        28
                  LastMeterPower
                          %        124
                  UserValue
                          %        32
                  sWriteRTC
                          %        36
                  sReadRTC
                          %        36
                  RoomModeCheckCounter
                          %        31
                  ModBusCommandList
                          %        33
                  PowerMeterRxCounter
                          %        124
                  PowerMeterTxCounter
                          %        124

                          AREA ||.constdata||, DATA, READONLY, ALIGN=2

                          DCD      0x00a8c000
                          DCD      0x00000000
                          DCD      0x00008000
                          DCD      0x01518000
                          DCD      0x00a8c000
                          DCD      0x00000000
                          DCD      0x00008000
                          DCD      0x01518000
                          DCD      0x00a8c000
                          DCD      0x00000000
                          DCD      0x00008000
                          DCD      0x01518000
                          DCD      0x00a8c000
                          DCD      0x00000000
                          DCD      0x00008000
                          DCD      0x01518000

                          AREA ||.data||, DATA, ALIGN=2

                  MaxPowerMeter
000000  00                DCB      0x00
                  RoomData
000001  0000              DCB      0x00,0x00
                  VersionString
000003  56                DCB      0x56
000004  32303230          DCB      0x32,0x30,0x32,0x30
000008  2d30342d          DCB      0x2d,0x30,0x34,0x2d
00000c  32342d30          DCB      0x32,0x34,0x2d,0x30
000010  3100              DCB      0x31,0x00
                  MyMeterID
000012  00                DCB      0x00
                  iStatus
000013  00                DCB      0x00
                  iSystemTime
000014  00000000          DCB      0x00,0x00,0x00,0x00
000018  000000            DCB      0x00,0x00,0x00
                  UID
00001b  00                DCB      0x00
00001c  000000            DCB      0x00,0x00,0x00
                  SystemPowerStatus
00001f  00                DCB      0x00
                  HOSTRxQ_wp
000020  00                DCB      0x00
                  HOSTRxQ_rp
000021  00                DCB      0x00
                  HOSTRxQ_cnt
000022  00                DCB      0x00
                  READERRxQ_wp
000023  00                DCB      0x00
                  READERRxQ_rp
000024  00                DCB      0x00
                  READERRxQ_cnt
000025  00                DCB      0x00
                  HOSTTxQ_wp
000026  00                DCB      0x00
                  HOSTTxQ_rp
000027  00                DCB      0x00
                  HOSTTxQ_cnt
000028  00                DCB      0x00
                  READERTxQ_wp
000029  00                DCB      0x00
                  READERTxQ_rp
00002a  00                DCB      0x00
                  READERTxQ_cnt
00002b  00                DCB      0x00
                  METERTxQ_wp
00002c  00                DCB      0x00
                  METERTxQ_rp
00002d  00                DCB      0x00
                  METERTxQ_cnt
00002e  00                DCB      0x00
                  METERRxQ_wp
00002f  00                DCB      0x00
                  METERRxQ_rp
000030  00                DCB      0x00
                  METERRxQ_cnt
000031  00                DCB      0x00
                  METER_RXQLen
000032  00                DCB      0x00
                  NewCardUID
000033  00                DCB      0x00
000034  000000            DCB      0x00,0x00,0x00
                  NumInChargeM
000037  00                DCB      0x00
                  NumInChargeR
000038  00                DCB      0x00
                  AckResult
000039  00                DCB      0x00
                  MemberBase
00003a  00                DCB      0x00
                  PacketIndex
00003b  00                DCB      0x00
                  LastReaderRecord_RP
00003c  00                DCB      0x00
                  fgReaderSync
00003d  00                DCB      0x00
                  ToReader_MemberIndex
00003e  00                DCB      0x00
                  HostGetRCDType
00003f  00                DCB      0x00
                  HostGetRCDIndex
000040  00                DCB      0x00
                  NewRecordCounter
000041  00                DCB      0x00
                  Record_WP
000042  00                DCB      0x00
                  Record_RP
000043  00                DCB      0x00
                  TagChargeRCD_NewCnt
000044  00                DCB      0x00
                  TagChargeRCD_WP
000045  00                DCB      0x00
                  TagChargeRCD_RP
000046  00                DCB      0x00
                  PowerRCD_NewCnt
000047  00                DCB      0x00
                  PowerRCD_WP
000048  00                DCB      0x00
                  PowerRCD_RP
000049  00                DCB      0x00
                  fgToReaderFlag
00004a  00                DCB      0x00
                  fgToReaderRSPFlag
00004b  00                DCB      0x00
                  fgToHostFlag
00004c  00                DCB      0x00
                  fgToHostRSPFlag
00004d  00                DCB      0x00
                  fgReaderFunction
00004e  00                DCB      0x00
                  fgFromHostFlag
00004f  00                DCB      0x00
                  fgFromReaderFlag
000050  00                DCB      0x00
                  DoorRecordIndex
000051  00                DCB      0x00
                  MemberIndex
000052  0000              DCB      0x00,0x00
                  MeterPower
                          DCD      0x00000000
                  ElectricityFee
                          %        8
                  ReaderHealth
000060  00                DCB      0x00
                  MeterDI_Counter
000061  00                DCB      0x00
                  MeterDI_Status
000062  00                DCB      0x00
                  ButtonDI_Counter
000063  00                DCB      0x00
                  ButtonStatus
000064  00                DCB      0x00
                  ReaderWaitTick
000065  00                DCB      0x00
                  PollRetryReader
000066  00                DCB      0x00
                  PackageIndex1
000067  00                DCB      0x00
                  GotReaderRSP
000068  00                DCB      0x00
                  TickPollingInterval
000069  00                DCB      0x00
                  ReaderDeviceError
00006a  0000              DCB      0x00,0x00
                  u32TimeTick2
                          DCD      0x00000000
                  SystemTick
000070  0000              DCB      0x00,0x00
                  Tick_10mSec
000072  00                DCB      0x00
                  Time_Sec
000073  00                DCB      0x00
                  READERTokenReady
000074  00                DCB      0x00
                  HOSTTokenReady
000075  00                DCB      0x00
                  MeterTokenReady
000076  0000              DCB      0x00,0x00
                  NowPortStatus
000078  0000              DCB      0x00,0x00
                  LastPortStatus
00007a  0000              DCB      0x00,0x00
                  HostPortStatus
00007c  0000              DCB      0x00,0x00
                  MeterError
00007e  00                DCB      0x00
                  TickPollingMeterInterval
00007f  00                DCB      0x00
                  MeterPollingState
000080  00000000          DCB      0x00,0x00,0x00,0x00
                  MeterPowerValue_Now
                          DCD      0x00000000
                  NowMeterPower
                          DCD      0x00000000
                  TickReadPowerTime
00008c  0000              DCB      0x00,0x00
                  ReadMeterTime
00008e  0000              DCB      0x00,0x00
                  DelayTick
000090  0000              DCB      0x00,0x00
                  PowerMeterID
000092  00                DCB      0x00
                  PowerMeterNewAddr
000093  00                DCB      0x00
                  NewUser
000094  00                DCB      0x00
                  NowUser
000095  00                DCB      0x00
                  LastUser
000096  0000              DCB      0x00,0x00
                  ConsumptionCounter
000098  0000              DCB      0x00,0x00
                  Tick_20mSec
00009a  00                DCB      0x00
                  TickADC
00009b  00                DCB      0x00
                  ReaderPollingState
00009c  00                DCB      0x00
                  bSaveSettingToEE
00009d  00                DCB      0x00
                  TickWaitAck
00009e  00                DCB      0x00
                  TickReader
00009f  00                DCB      0x00
                  iTickDelaySendHostCMD
0000a0  00                DCB      0x00
                  bDelaySendHostCMD
0000a1  00                DCB      0x00
                  bValueUpdated
0000a2  00                DCB      0x00
                  bRegister
0000a3  00                DCB      0x00
                  TokenMeterReady
0000a4  00                DCB      0x00
                  fgDIR485_Reader
0000a5  00                DCB      0x00
                  fgDIR485_HOST_In
0000a6  00                DCB      0x00
                  fgDIR485_METER_In
0000a7  00                DCB      0x00
                  DelaySwitchDIR1
0000a8  00                DCB      0x00
                  Tick10mSec_DIR485_Reader
0000a9  00                DCB      0x00
                  DelaySwitchDIR3
0000aa  00                DCB      0x00
                  RecordWp
0000ab  00                DCB      0x00
                  RecordRp
0000ac  00                DCB      0x00
                  RecordCounter
0000ad  00                DCB      0x00
                  TickRecord
0000ae  00                DCB      0x00
                  Tick_PowerCounter
0000af  00                DCB      0x00
                  TickHostUart
0000b0  00                DCB      0x00
                  TickMeterUart
0000b1  00                DCB      0x00
                  bRecoverSystem
0000b2  00                DCB      0x00
                  bResetUARTQ
0000b3  00                DCB      0x00
                  TickHost
0000b4  00                DCB      0x00
                  SaveStep
0000b5  00                DCB      0x00
                  MeterType
0000b6  00                DCB      0x00
                  GotMeterRsp
0000b7  00                DCB      0x00
                  DelayTime4NextCmd
0000b8  00                DCB      0x00
                  fgSwPower
0000b9  00                DCB      0x00
                  fgButton2High
0000ba  00                DCB      0x00
                  PowerOnReadMeter
0000bb  00                DCB      0x00
                  PowerOnTimeSync
0000bc  00                DCB      0x00
                  SwPowerDoubeCheck
0000bd  00                DCB      0x00
                  TickModeNRelayCheck
0000be  00                DCB      0x00
                  BalanceCheckTimes
0000bf  00                DCB      0x00
                  RoomSetting
0000c0  00                DCB      0x00
                  AutoLockTime
0000c1  00                DCB      0x00
                  RoomModeCounter
0000c2  00                DCB      0x00
                  tmpMemberMode
0000c3  00                DCB      0x00
0000c4  0000              DCB      0x00,0x00
                  g_u8DeviceAddr
0000c6  50                DCB      0x50
                  g_au8TxData
0000c7  00                DCB      0x00
0000c8  0000              DCB      0x00,0x00
                  g_u8RxData
0000ca  00                DCB      0x00
                  g_u8DataLen
0000cb  00                DCB      0x00
                  g_u8EndFlag
0000cc  00000000          DCB      0x00,0x00,0x00,0x00
                  g_u32WDTINTCounts
                          DCD      0x00000000
                  g_u8IsWDTWakeupINT
0000d4  00000000          DCB      0x00,0x00,0x00,0x00
                  g_u32RTCTickINT
                          DCD      0x00000000
                  ErrorCode
0000dc  00                DCB      0x00
                  fgDirReaderRS485Out2In
0000dd  00                DCB      0x00
                  fgDirMeterRS485Out2In
0000de  00                DCB      0x00
                  fgDisableRS485Tx
0000df  00                DCB      0x00
                  TickDirReaderRS485Delay
0000e0  0000              DCB      0x00,0x00
                  TickDirMeterRS485Delay
0000e2  0000              DCB      0x00,0x00
                  TickDisableRS485TxDelay
0000e4  0000              DCB      0x00,0x00
                  tick_MeterSetting
0000e6  0000              DCB      0x00,0x00
                  Tick1S_ResetReaderPower
0000e8  00                DCB      0x00
                  fgFirstStart
0000e9  00                DCB      0x00
                  Tick_LED_G
0000ea  00                DCB      0x00
                  Tick_LED_G1
0000eb  00                DCB      0x00
                  Tick_LED_R
0000ec  00                DCB      0x00
                  Tick_LED_R1
0000ed  00                DCB      0x00
                  StepFineTuneUR2
0000ee  00                DCB      0x00
                  UR2_FregOK
0000ef  00                DCB      0x00
                  Tick10mS_FTUR2
0000f0  0000              DCB      0x00,0x00
                  Tick5mS_CheckRoomMode
0000f2  0000              DCB      0x00,0x00
                  FreqMixValue
0000f4  0000              DCB      0x00,0x00
                  RelayOffCnt
0000f6  00                DCB      0x00
                  Tick1S_DoubleCheckRoomMode
0000f7  00                DCB      0x00
                  u32_RSTScr
                          DCD      0x00000000
                  fErrorRate
                          DCD      0x00000000
                  tmpTx
                          DCD      0x00000000
                  tmpRx
                          DCD      0x00000000
                  Flag_ItemUpdated
000108  00                DCB      0x00
                  LastPowerRCD_WP
000109  00                DCB      0x00

;*** Start embedded assembler ***

#line 1 "..\\main.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___6_main_c_a788c4f3____REV16|
#line 388 "..\\..\\..\\NUC126_Series_BSP_CMSIS_V3.00.005\\Library\\CMSIS\\Include\\cmsis_armcc.h"
|__asm___6_main_c_a788c4f3____REV16| PROC
#line 389

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___6_main_c_a788c4f3____REVSH|
#line 402
|__asm___6_main_c_a788c4f3____REVSH| PROC
#line 403

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***

                  __ARM_use_no_argv EQU 0
